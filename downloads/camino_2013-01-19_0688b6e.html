<!DOCTYPE html>
<html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta name="generator" content="AsciiDoc 8.6.7">
<title>El camino a un mejor programador</title>
<style type="text/css">
/* Shared CSS for AsciiDoc xhtml11 and html5 backends */

/* Default font. */
body {
  font-family: Georgia,serif;
}

/* Title font. */
h1, h2, h3, h4, h5, h6,
div.title, caption.title,
thead, p.table.header,
#toctitle,
#author, #revnumber, #revdate, #revremark,
#footer {
  font-family: Arial,Helvetica,sans-serif;
}

body {
  margin: 1em 5% 1em 5%;
}

a {
  color: blue;
  text-decoration: underline;
}
a:visited {
  color: fuchsia;
}

em {
  font-style: italic;
}

strong {
  font-weight: bold;
  color: #083194;
}

h1, h2, h3, h4, h5, h6 {
  color: #527bbd;
  margin-top: 1.2em;
  margin-bottom: 0.5em;
  line-height: 1.3;
}

h1, h2, h3 {
  border-bottom: 2px solid silver;
}
h2 {
  padding-top: 0.5em;
}
h3 {
  float: left;
}
h3 + * {
  clear: left;
}
h5 {
  font-size: 1.0em;
}

div.sectionbody {
  margin-left: 0;
}

hr {
  border: 1px solid silver;
}

p {
  margin-top: 0.5em;
  margin-bottom: 0.5em;
}

ul, ol, li > p {
  margin-top: 0;
}
ul > li     { color: #aaa; }
ul > li > * { color: black; }

pre {
  padding: 0;
  margin: 0;
}

#author {
  color: #527bbd;
  font-weight: bold;
  font-size: 1.1em;
}
#email {
}
#revnumber, #revdate, #revremark {
}

#footer {
  font-size: small;
  border-top: 2px solid silver;
  padding-top: 0.5em;
  margin-top: 4.0em;
}
#footer-text {
  float: left;
  padding-bottom: 0.5em;
}
#footer-badges {
  float: right;
  padding-bottom: 0.5em;
}

#preamble {
  margin-top: 1.5em;
  margin-bottom: 1.5em;
}
div.imageblock, div.exampleblock, div.verseblock,
div.quoteblock, div.literalblock, div.listingblock, div.sidebarblock,
div.admonitionblock {
  margin-top: 1.0em;
}
div.admonitionblock {
  margin-top: 2.0em;
  margin-bottom: 2.0em;
  margin-right: 10%;
  color: #606060;
}

div.content { /* Block element content. */
  padding: 0;
}

/* Block element titles. */
div.title, caption.title {
  color: #888888;
  font-size: 90%;
  font-style: italic;
  text-align: left;
  margin-top: 0.5ex;
  margin-bottom: 1em;
}
div.title + * {
  margin-top: 0;
}

td div.title:first-child {
  margin-top: 0.0em;
}
div.content div.title:first-child {
  margin-top: 0.0em;
}
div.content + div.title {
  margin-top: 0.0em;
}

div.sidebarblock > div.content {
  background: #ffffee;
  border: 1px solid #dddddd;
  border-left: 4px solid #f0f0f0;
  padding: 0.5em;
}

div.listingblock > div.content {
  border: 1px solid #dddddd;
  border-left: 5px solid #f0f0f0;
  background: #f8f8f8;
  padding: 0.5em;
}

div.quoteblock, div.verseblock {
  padding-left: 1.0em;
  margin-left: 1.0em;
  margin-right: 10%;
  border-left: 5px solid #f0f0f0;
  color: #888;
}

div.quoteblock > div.attribution {
  padding-top: 0.5em;
  text-align: right;
}

div.verseblock > pre.content {
  font-family: inherit;
  font-size: inherit;
}
div.verseblock > div.attribution {
  padding-top: 0.75em;
  text-align: left;
}
/* DEPRECATED: Pre version 8.2.7 verse style literal block. */
div.verseblock + div.attribution {
  text-align: left;
}

div.admonitionblock .icon {
  vertical-align: top;
  font-size: 1.1em;
  font-weight: bold;
  text-decoration: underline;
  color: #527bbd;
  padding-right: 0.5em;
}
div.admonitionblock td.content {
  padding-left: 0.5em;
  border-left: 3px solid #dddddd;
}

div.exampleblock > div.content {
  border-left: 3px solid #dddddd;
  padding-left: 0.5em;
}

div.imageblock div.content { padding-left: 0; }
span.image img { border-style: none; }
a.image:visited { color: white; }

dl {
  margin-top: 0.8em;
  margin-bottom: 0.8em;
}
dt {
  margin-top: 0.5em;
  margin-bottom: 0;
  font-style: normal;
  color: navy;
}
dd > *:first-child {
  margin-top: 0.1em;
}

ul, ol {
    list-style-position: outside;
}
ol.arabic {
  list-style-type: decimal;
}
ol.loweralpha {
  list-style-type: lower-alpha;
}
ol.upperalpha {
  list-style-type: upper-alpha;
}
ol.lowerroman {
  list-style-type: lower-roman;
}
ol.upperroman {
  list-style-type: upper-roman;
}

div.compact ul, div.compact ol,
div.compact p, div.compact p,
div.compact div, div.compact div {
  margin-top: 0.1em;
  margin-bottom: 0.1em;
}

tfoot {
  font-weight: bold;
}
td > div.verse {
  white-space: pre;
}

div.hdlist {
  margin-top: 0.8em;
  margin-bottom: 0.8em;
}
div.hdlist tr {
  padding-bottom: 15px;
}
dt.hdlist1.strong, td.hdlist1.strong {
  font-weight: bold;
}
td.hdlist1 {
  vertical-align: top;
  font-style: normal;
  padding-right: 0.8em;
  color: navy;
}
td.hdlist2 {
  vertical-align: top;
}
div.hdlist.compact tr {
  margin: 0;
  padding-bottom: 0;
}

.comment {
  background: yellow;
}

.footnote, .footnoteref {
  font-size: 0.8em;
}

span.footnote, span.footnoteref {
  vertical-align: super;
}

#footnotes {
  margin: 20px 0 20px 0;
  padding: 7px 0 0 0;
}

#footnotes div.footnote {
  margin: 0 0 5px 0;
}

#footnotes hr {
  border: none;
  border-top: 1px solid silver;
  height: 1px;
  text-align: left;
  margin-left: 0;
  width: 20%;
  min-width: 100px;
}

div.colist td {
  padding-right: 0.5em;
  padding-bottom: 0.3em;
  vertical-align: top;
}
div.colist td img {
  margin-top: 0.3em;
}

@media print {
  #footer-badges { display: none; }
}

#toc {
  margin-bottom: 2.5em;
}

#toctitle {
  color: #527bbd;
  font-size: 1.1em;
  font-weight: bold;
  margin-top: 1.0em;
  margin-bottom: 0.1em;
}

div.toclevel0, div.toclevel1, div.toclevel2, div.toclevel3, div.toclevel4 {
  margin-top: 0;
  margin-bottom: 0;
}
div.toclevel2 {
  margin-left: 2em;
  font-size: 0.9em;
}
div.toclevel3 {
  margin-left: 4em;
  font-size: 0.9em;
}
div.toclevel4 {
  margin-left: 6em;
  font-size: 0.9em;
}

span.aqua { color: aqua; }
span.black { color: black; }
span.blue { color: blue; }
span.fuchsia { color: fuchsia; }
span.gray { color: gray; }
span.green { color: green; }
span.lime { color: lime; }
span.maroon { color: maroon; }
span.navy { color: navy; }
span.olive { color: olive; }
span.purple { color: purple; }
span.red { color: red; }
span.silver { color: silver; }
span.teal { color: teal; }
span.white { color: white; }
span.yellow { color: yellow; }

span.aqua-background { background: aqua; }
span.black-background { background: black; }
span.blue-background { background: blue; }
span.fuchsia-background { background: fuchsia; }
span.gray-background { background: gray; }
span.green-background { background: green; }
span.lime-background { background: lime; }
span.maroon-background { background: maroon; }
span.navy-background { background: navy; }
span.olive-background { background: olive; }
span.purple-background { background: purple; }
span.red-background { background: red; }
span.silver-background { background: silver; }
span.teal-background { background: teal; }
span.white-background { background: white; }
span.yellow-background { background: yellow; }

span.big { font-size: 2em; }
span.small { font-size: 0.6em; }

span.underline { text-decoration: underline; }
span.overline { text-decoration: overline; }
span.line-through { text-decoration: line-through; }

div.unbreakable { page-break-inside: avoid; }


/*
 * xhtml11 specific
 *
 * */

tt {
  line-height: 1.2;
  font-size: inherit;
  color: navy;
}

div.tableblock {
  margin-top: 1.0em;
  margin-bottom: 1.5em;
}
div.tableblock > table {
  border: 3px solid #527bbd;
}
thead, p.table.header {
  font-weight: bold;
  color: #527bbd;
}
p.table {
  margin-top: 0;
}
/* Because the table frame attribute is overriden by CSS in most browsers. */
div.tableblock > table[frame="void"] {
  border-style: none;
}
div.tableblock > table[frame="hsides"] {
  border-left-style: none;
  border-right-style: none;
}
div.tableblock > table[frame="vsides"] {
  border-top-style: none;
  border-bottom-style: none;
}


/*
 * html5 specific
 *
 * */

.monospaced {
  font-family: "Courier New", Courier, monospace;
  font-size: inherit;
  color: navy;
}

table.tableblock {
  margin-top: 1.0em;
  margin-bottom: 1.5em;
}
thead, p.tableblock.header {
  font-weight: bold;
  color: #527bbd;
}
p.tableblock {
  margin-top: 0;
}
table.tableblock {
  border-width: 3px;
  border-spacing: 0px;
  border-style: solid;
  border-color: #527bbd;
  border-collapse: collapse;
}
th.tableblock, td.tableblock {
  border-width: 1px;
  padding: 4px;
  border-style: solid;
  border-color: #527bbd;
}

table.tableblock.frame-topbot {
  border-left-style: hidden;
  border-right-style: hidden;
}
table.tableblock.frame-sides {
  border-top-style: hidden;
  border-bottom-style: hidden;
}
table.tableblock.frame-none {
  border-style: hidden;
}

th.tableblock.halign-left, td.tableblock.halign-left {
  text-align: left;
}
th.tableblock.halign-center, td.tableblock.halign-center {
  text-align: center;
}
th.tableblock.halign-right, td.tableblock.halign-right {
  text-align: right;
}

th.tableblock.valign-top, td.tableblock.valign-top {
  vertical-align: top;
}
th.tableblock.valign-middle, td.tableblock.valign-middle {
  vertical-align: middle;
}
th.tableblock.valign-bottom, td.tableblock.valign-bottom {
  vertical-align: bottom;
}


/*
 * manpage specific
 *
 * */

body.manpage h1 {
  padding-top: 0.5em;
  padding-bottom: 0.5em;
  border-top: 2px solid silver;
  border-bottom: 2px solid silver;
}
body.manpage h2 {
  border-style: none;
}
body.manpage div.sectionbody {
  margin-left: 3em;
}

@media print {
  body.manpage div#toc { display: none; }
}
</style>
<script type="text/javascript">
/*<![CDATA[*/
var asciidoc = {  // Namespace.

/////////////////////////////////////////////////////////////////////
// Table Of Contents generator
/////////////////////////////////////////////////////////////////////

/* Author: Mihai Bazon, September 2002
 * http://students.infoiasi.ro/~mishoo
 *
 * Table Of Content generator
 * Version: 0.4
 *
 * Feel free to use this script under the terms of the GNU General Public
 * License, as long as you do not remove or alter this notice.
 */

 /* modified by Troy D. Hanson, September 2006. License: GPL */
 /* modified by Stuart Rackham, 2006, 2009. License: GPL */

// toclevels = 1..4.
toc: function (toclevels) {

  function getText(el) {
    var text = "";
    for (var i = el.firstChild; i != null; i = i.nextSibling) {
      if (i.nodeType == 3 /* Node.TEXT_NODE */) // IE doesn't speak constants.
        text += i.data;
      else if (i.firstChild != null)
        text += getText(i);
    }
    return text;
  }

  function TocEntry(el, text, toclevel) {
    this.element = el;
    this.text = text;
    this.toclevel = toclevel;
  }

  function tocEntries(el, toclevels) {
    var result = new Array;
    var re = new RegExp('[hH]([1-'+(toclevels+1)+'])');
    // Function that scans the DOM tree for header elements (the DOM2
    // nodeIterator API would be a better technique but not supported by all
    // browsers).
    var iterate = function (el) {
      for (var i = el.firstChild; i != null; i = i.nextSibling) {
        if (i.nodeType == 1 /* Node.ELEMENT_NODE */) {
          var mo = re.exec(i.tagName);
          if (mo && (i.getAttribute("class") || i.getAttribute("className")) != "float") {
            result[result.length] = new TocEntry(i, getText(i), mo[1]-1);
          }
          iterate(i);
        }
      }
    }
    iterate(el);
    return result;
  }

  var toc = document.getElementById("toc");
  if (!toc) {
    return;
  }

  // Delete existing TOC entries in case we're reloading the TOC.
  var tocEntriesToRemove = [];
  var i;
  for (i = 0; i < toc.childNodes.length; i++) {
    var entry = toc.childNodes[i];
    if (entry.nodeName.toLowerCase() == 'div'
     && entry.getAttribute("class")
     && entry.getAttribute("class").match(/^toclevel/))
      tocEntriesToRemove.push(entry);
  }
  for (i = 0; i < tocEntriesToRemove.length; i++) {
    toc.removeChild(tocEntriesToRemove[i]);
  }

  // Rebuild TOC entries.
  var entries = tocEntries(document.getElementById("content"), toclevels);
  for (var i = 0; i < entries.length; ++i) {
    var entry = entries[i];
    if (entry.element.id == "")
      entry.element.id = "_toc_" + i;
    var a = document.createElement("a");
    a.href = "#" + entry.element.id;
    a.appendChild(document.createTextNode(entry.text));
    var div = document.createElement("div");
    div.appendChild(a);
    div.className = "toclevel" + entry.toclevel;
    toc.appendChild(div);
  }
  if (entries.length == 0)
    toc.parentNode.removeChild(toc);
},


/////////////////////////////////////////////////////////////////////
// Footnotes generator
/////////////////////////////////////////////////////////////////////

/* Based on footnote generation code from:
 * http://www.brandspankingnew.net/archive/2005/07/format_footnote.html
 */

footnotes: function () {
  // Delete existing footnote entries in case we're reloading the footnodes.
  var i;
  var noteholder = document.getElementById("footnotes");
  if (!noteholder) {
    return;
  }
  var entriesToRemove = [];
  for (i = 0; i < noteholder.childNodes.length; i++) {
    var entry = noteholder.childNodes[i];
    if (entry.nodeName.toLowerCase() == 'div' && entry.getAttribute("class") == "footnote")
      entriesToRemove.push(entry);
  }
  for (i = 0; i < entriesToRemove.length; i++) {
    noteholder.removeChild(entriesToRemove[i]);
  }

  // Rebuild footnote entries.
  var cont = document.getElementById("content");
  var spans = cont.getElementsByTagName("span");
  var refs = {};
  var n = 0;
  for (i=0; i<spans.length; i++) {
    if (spans[i].className == "footnote") {
      n++;
      var note = spans[i].getAttribute("data-note");
      if (!note) {
        // Use [\s\S] in place of . so multi-line matches work.
        // Because JavaScript has no s (dotall) regex flag.
        note = spans[i].innerHTML.match(/\s*\[([\s\S]*)]\s*/)[1];
        spans[i].innerHTML =
          "[<a id='_footnoteref_" + n + "' href='#_footnote_" + n +
          "' title='View footnote' class='footnote'>" + n + "</a>]";
        spans[i].setAttribute("data-note", note);
      }
      noteholder.innerHTML +=
        "<div class='footnote' id='_footnote_" + n + "'>" +
        "<a href='#_footnoteref_" + n + "' title='Return to text'>" +
        n + "</a>. " + note + "</div>";
      var id =spans[i].getAttribute("id");
      if (id != null) refs["#"+id] = n;
    }
  }
  if (n == 0)
    noteholder.parentNode.removeChild(noteholder);
  else {
    // Process footnoterefs.
    for (i=0; i<spans.length; i++) {
      if (spans[i].className == "footnoteref") {
        var href = spans[i].getElementsByTagName("a")[0].getAttribute("href");
        href = href.match(/#.*/)[0];  // Because IE return full URL.
        n = refs[href];
        spans[i].innerHTML =
          "[<a href='#_footnote_" + n +
          "' title='View footnote' class='footnote'>" + n + "</a>]";
      }
    }
  }
},

install: function(toclevels) {
  var timerId;

  function reinstall() {
    asciidoc.footnotes();
    if (toclevels) {
      asciidoc.toc(toclevels);
    }
  }

  function reinstallAndRemoveTimer() {
    clearInterval(timerId);
    reinstall();
  }

  timerId = setInterval(reinstall, 500);
  if (document.addEventListener)
    document.addEventListener("DOMContentLoaded", reinstallAndRemoveTimer, false);
  else
    window.onload = reinstallAndRemoveTimer;
}

}
asciidoc.install(1);
/*]]>*/
</script>
</head>
<body class="book">
<div id="header">
<h1>El camino a un mejor programador</h1>
<span id="author">Esteban Manchado Velázquez, Joaquín Caraballo Moreno, Yeray Darias Camacho</span><br>
<div id="toc">
  <div id="toctitle">Índice general</div>
  <noscript><p><b>JavaScript must be enabled in your browser to display the table of contents.</b></p></noscript>
</div>
</div>
<div id="content">
<div class="sect1">
<h2 id="_licencia">Licencia</h2>
<div class="sectionbody">
<div class="paragraph"><p>Esta obra se distribuye bajo la <a href="http://creativecommons.org/licenses/by-sa/3.0/deed.es_ES">licencia Creative Commons Reconocimiento-CompartirIgual 3.0</a>. Esto significa que usted puede:</p></div>
<div class="ulist"><ul>
<li>
<p>
copiar, distribuir y comunicar públicamente la obra
</p>
</li>
<li>
<p>
remezclar: transformar la obra
</p>
</li>
<li>
<p>
hacer un uso comercial de esta obra
</p>
</li>
</ul></div>
<div class="paragraph"><p>Bajo las condiciones siguientes:</p></div>
<div class="ulist"><ul>
<li>
<p>
Reconocimiento: debe reconocer los créditos de la obra de la manera especificada por el autor o el licenciador (pero no de una manera que sugiera que tiene su apoyo o apoyan el uso que hace de su obra).
</p>
</li>
<li>
<p>
Compartir bajo la misma licencia: si altera o transforma esta obra, o genera una obra derivada, sólo puede distribuir la obra generada bajo una licencia idéntica a ésta.
</p>
</li>
</ul></div>
<div class="paragraph"><p>Entendiendo que:</p></div>
<div class="ulist"><ul>
<li>
<p>
Renuncia: alguna de estas condiciones puede no aplicarse si se obtiene el permiso del titular de los derechos de autor
</p>
</li>
<li>
<p>
Dominio público: cuando la obra o alguno de sus elementos se halle en el dominio público según la ley vigente aplicable, esta situación no quedará afectada por la licencia.
</p>
</li>
<li>
<p>
Otros derechos: los derechos siguientes no quedan afectados por la licencia de ninguna manera:
</p>
<div class="ulist"><ul>
<li>
<p>
Los derechos derivados de usos legítimos u otras limitaciones reconocidas por ley no se ven afectados por lo anterior.
</p>
</li>
<li>
<p>
Los derechos morales del autor;
</p>
</li>
<li>
<p>
Derechos que pueden ostentar otras personas sobre la propia obra o su uso, como por ejemplo derechos de imagen o de privacidad.
</p>
</li>
</ul></div>
</li>
<li>
<p>
Aviso: al reutilizar o distribuir la obra, tiene que dejar bien claro los términos de la licencia de esta obra.
</p>
</li>
</ul></div>
<div class="paragraph"><p><span class="image">
<img src="cc-by-sa.png" alt="Creative Common Reconocimiento-CompartirIgual 3.0">
</span></p></div>
</div>
</div>
<div class="sect1">
<h2 id="_agradecimientos">Agradecimientos</h2>
<div class="sectionbody">
<div class="paragraph"><p>A todos aquellos que ayudaron de una manera u otra en la creación de
este libro, con consejos, apoyo o ideas. Las siguientes personas se
merecen una mención especial:</p></div>
<div class="ulist"><ul>
<li>
<p>
Sara Pettersson, por la portada
</p>
</li>
<li>
<p>
Mario Hernández, por el prólogo
</p>
</li>
<li>
<p>
Carlos Ble, por ayudar con la revisión de varios artículos y por sus
  ideas y consejos
</p>
</li>
<li>
<p>
Juanje Ojeda, por sus ideas y empuje iniciales
</p>
</li>
</ul></div>
</div>
</div>
<div class="sect1">
<h2 id="_prólogo">Prólogo</h2>
<div class="sectionbody">
<div class="paragraph"><p>Se cuenta que una vez le preguntaron a Miguel Ángel cómo había procedido para esculpir el David. Su respuesta fue que lo que había hecho era, simplemente, eliminar del bloque de piedra original todo lo que sobraba. Independientemente de la verosimilitud de esta anécdota, podemos encontrar en ella la enseñanza de una actitud a tomar para abordar problemas prácticos de desarrollo en ingeniería.</p></div>
<div class="paragraph"><p>Si la pregunta se le hiciese a un escultor que modelase en barro la respuesta equivalente sería, posiblemente, que lo que había hecho era rellenar el espacio disponiendo el barro estrictamente necesario en las zonas adecuadas. Estas dos respuestas se refieren a dos aproximaciones para abordar procesos constructivos: la sustractiva, natural en la escultura en piedra, en la que se eliminan elementos de una solución primigenia hasta que se cumple con las restricciones de la solución definitiva, y la aditiva en la que se aborda el problema partiendo de una solución inicial vacía, añadiendo elementos según ciertos criterios con el fin de conseguir que la solución final cumpla los objetivos de diseño. Estas dos son aproximaciones extrapolables a otras disciplinas y en general, en muchos otros casos, la solución se alcanza con aproximaciones mixtas, en las que se opera con acciones aditivas y sustractivas combinadas.</p></div>
<div class="paragraph"><p>El desarrollo de software es una disciplina práctica relativamente nueva que tiene poco más de medio siglo de existencia, pero que conceptualmente es hija de las disciplinas clásicas constructivas englobadas bajo el paraguas de las ingenierías y la arquitectura. De ellas hereda una de las habilidades que necesita un buen informático; la de resolver problemas. Por ella me refiero a la capacidad, en palabras de Allen Downey, el autor de «Think Python. How to Think Like a Computer Scientist», para formular problemas, pensar en soluciones de manera creativa, y expresarlas de forma clara y precisa. A esto se debe probablemente mucha de la genialidad de Miguel Ángel.</p></div>
<div class="paragraph"><p>Volviendo a las disciplinas clásicas de la ingeniería y la arquitectura, el objetivo de estas no es el de las ciencias clásicas de carácter analítico, es decir, no intenta entender, explicar y describir algo ya existente como lo hacen la física, la química o la biología, sino más bien sintético, es decir, orientado a desarrollar y construir cosas nuevas que satisfagan un objetivo expresado normalmente por la función definida a priori que debe cumplir el resultado. En este ámbito, el conocimiento acerca de cómo realizar bien las tareas de desarrollo de nuevas soluciones es un trabajo de destilación que se produce en ciclos de vida resumibles en «observación-análisis-propuestas de solución-realización práctica-evaluación de resultados-refinamiento, para alcanzar el nivel de aceptación-corrección para iniciar de nuevo el ciclo o descarte de la propuesta» según corresponda. Estos procesos se realizan iterativamente en el tiempo, constituyendo la fuente del conocimiento práctico del saber hacer de la disciplina y que se terminan expresando como recetas metodológicas y conjuntos de buenas prácticas para ejecutar los proyectos y tareas futuros. Su fin es llevar esos proyectos a buen término en forma de una solución que sea eficiente y efectiva y cumpla las restricciones impuestas al mínimo coste de realización posible medido en horas-hombre. Este proceso es análogo, de nuevo, a los desarrollos de la ingeniería y la arquitectura primigenia, donde los constructores y albañiles desarrollaban su conocimiento y metodologías de forma práctica enfrentándose a retos y problemas nuevos. Ello permitió, por ejemplo, construir las grandes obras de ingeniería civil durante la época de esplendor de Roma, como es el caso de los acueductos, palacios o coliseos, o la gran arquitectura revolucionaria de las catedrales de estilo gótico. Esas construcciones fueron productos pero también retos, que permitieron desarrollar conocimiento y metodologías que se explotaron y depuraron durante siglos.</p></div>
<div class="paragraph"><p>La realización de proyectos en disciplinas sintéticas es pues una combinación virtuosa de la concepción y uso de las herramientas adecuadas para el desarrollo, con el conocimiento, las habilidades con esas herramientas y procesos y la experiencia disponible en la mente de quienes los ejecutan, que se manifiesta en la capacidad de resolución de problemas y se expresa como recetas metodológicas y conjuntos de buenas prácticas para llevar a buen fin los proyectos por parte de equipos de personas cualificadas.  Una buena ingeniería o una buena arquitectura podrían entenderse en el sentido de Miguel Ángel como las disciplinas que tienen por objetivo el uso adecuado del conjunto de herramientas, conocimiento y habilidades combinados con una metodología que permite construir lo nuevo que se propone cumpliendo los objetivos de diseño, buscando quedarnos con lo estrictamente necesario en sentido constructivo y eliminando lo superfluo.</p></div>
<div class="paragraph"><p>¿Cuál es la diferencia entre el desarrollo de proyectos de programación y el desarrollo de proyectos de ingeniería o arquitectura más o menos convencionales? Pues, conceptualmente el único conjunto de diferencias surge, básicamente, de la naturaleza del objeto de trabajo. En el caso de los últimos, el objeto lo constituyen tangibles físicos, mientras que en el caso del primero, el objeto es fundamentalmente un intangible: todo lo relacionado con la información y sus transformaciones. Además, por la naturaleza de su resultado y al contrario que en otras disciplinas constructivas, el objeto de la ejecución de proyectos software no está sometido a ley física alguna, excepto la que regula la entropía. De hecho, una gran parte de la actividad metodológica en el desarrollo de proyectos está dirigida a luchar contra la degradación y el desorden. Esta situación es la que establece la particularidad de la ejecución de proyectos software como cuerpo disciplinar, y es la que delimita el territorio sobre el que se tienen que desarrollar herramientas, conocimiento y metodologías.</p></div>
<div class="paragraph"><p>Este libro pretende ser una aportación a la recopilación y la transmisión del conocimiento y la experiencia de un grupo de buenos y experimentados programadores profesionales en el desarrollo de proyectos de programación.  Constituye pues un documento valioso para aquellas personas interesados en el mundo profesional del software.</p></div>
<div class="paragraph"><p>Un valor interesante del libro reside en que se dedica a temas que no suelen formar parte del flujo de conocimientos que se manejan usualmente en los procesos de formación básica de los desarrolladores e ingenieros de software, como son los que aparecen en el índice de este documento: el desarrollo de software bajo el paradigma de programación funcional, la documentación activa, la prueba de programas, la calidad del software o los procesos de integración continua. Más bien podemos entenderlo como un texto que intenta servir como transmisor de conocimiento experto desde quienes tienen años de experiencia profesional en el campo y se dirige hacia un amplio espectro de informáticos, tanto experimentados en otros saberes, como noveles en estos temas. En este sentido constituye una obra de valor en los ámbitos que le compete.</p></div>
<div class="paragraph"><p>Espero y confío en que esta contribución sirva para los fines que se propusieron sus autores y resulte de utilidad para sus lectores.</p></div>
<div class="paragraph"><p>Mario Hernández<br>
Catedrático de Universidad en Ciencias de la Computación e Inteligencia Artificial<br>
Las Palmas de Gran Canaria, octubre de 2012</p></div>
</div>
</div>
<div class="sect1">
<h2 id="_lecciones_de_aprender_un_lenguaje_funcional">Lecciones de aprender un lenguaje funcional</h2>
<div class="sectionbody">
<div class="paragraph"><p><em>Esteban Manchado Velázquez</em></p></div>
<div class="paragraph"><p>Los lenguajes funcionales son una familia de lenguajes que la mayoría de los
programadores conoce de oídas, pero desgraciadamente no muchos conocen
suficientemente bien. Y digo «desgraciadamente» porque, independientemente de
que por una razón u otra los lenguajes funcionales son muy poco demandados en
el mercado laboral, aprenderlos nos puede brindar muchas ideas interesantes,
patrones, buenas costumbres y lecciones que podemos aplicar a muchos otros
lenguajes.</p></div>
<div class="paragraph"><p>Es difícil trazar una línea clara entre los lenguajes funcionales y los
lenguajes no funcionales, pero podemos citar Lisp, Haskell, Erlang, Scala y
Clojure como los lenguajes funcionales más populares actualmente. Muchos
lenguajes de programación populares tienen algunos rasgos funcionales, como
Javascript, Ruby y Python. Los lenguajes funcionales, o en general, de
cualquier paradigma al que no estemos acostumbrados, nos pueden dar ideas que
podemos aplicar no solamente en estos lenguajes que tienen rasgos funcionales,
sino en casi cualquier lenguaje.</p></div>
<div class="paragraph"><p>Aprender un lenguaje funcional lo suficiente como para tener unas nociones e
inspirarse, no tiene por qué llevar mucho tiempo. Además, no sólo disponemos de
Internet, sino también de excelentes libros que están pensados precisamente
para programadores que vienen de otros lenguajes. El resto de este artículo
explora algunas técnicas, buenas costumbres e ideas comunes en lenguajes
funcionales, que podemos aplicar fácilmente en otros lenguajes. Por supuesto,
algunas de estas lecciones se pueden aprender simplemente por experiencia, y no
son necesariamente exclusivas de los lenguajes funcionales.</p></div>
<div class="sect2">
<h3 id="_los_lenguajes_son_diferentes">Los lenguajes son diferentes</h3>
<div class="paragraph"><p>Los lenguajes de programación son como los idiomas humanos en muchos sentidos:
tienen sintaxis, expresiones comunes, son mejores o peores que otros para
expresar ciertas ideas, se pueden «hablar» con mayor o menor fluidez e incluso
se puede decir que sus «hablantes» tienen una cierta «cultura» diferente de los
«hablantes» de otros lenguajes.</p></div>
<div class="paragraph"><p>Así, cuando aprendemos un lenguaje nuevo es un error verlo como «una nueva
sintaxis»: aprender un lenguaje bien, nos hace cambiar cómo pensamos y cómo
resolvemos los problemas. Por ejemplo, digamos que empezamos a aprender Lisp y
que sólo conocemos lenguajes imperativos «clásicos» como C o Java. Como parte
de un programa que estamos escribiendo, tenemos una función que calcula el
valor total a pagar por unos artículos. Los parámetros de entrada son el
importe de cada artículo, el número de artículos, el porcentaje de impuesto, y
el límite pasado el cual hay que aplicar el impuesto (p.ej.: tenemos 2
artículos a 5 euros cada uno, un impuesto del 10% y un límite de 8 euros; el
precio final será 11. Si el límite fuese 15 euros, el precio final sería 10
porque no se aplicaría el impuesto). Una forma de escribirla en Lisp sería la
siguiente:</p></div>
<div class="listingblock">
<div class="content"><!-- Generator: GNU source-highlight 3.1.6
by Lorenzo Bettini
http://www.lorenzobettini.it
http://www.gnu.org/software/src-highlite -->
<pre><tt><span style="color: #FF0000">(</span><span style="font-weight: bold"><span style="color: #0000FF">defun</span></span> calculate-price-BAD <span style="color: #FF0000">(</span>cost nitems limit percent-tax<span style="color: #FF0000">)</span>
  <span style="color: #FF0000">(</span>setq total-price <span style="color: #FF0000">(</span><span style="font-weight: bold"><span style="color: #0000FF">*</span></span> cost nitems<span style="color: #FF0000">))</span>
  <span style="color: #FF0000">(</span><span style="font-weight: bold"><span style="color: #0000FF">if</span></span> <span style="color: #FF0000">(</span>&gt; total-price limit<span style="color: #FF0000">)</span>
      <span style="color: #FF0000">(</span><span style="font-weight: bold"><span style="color: #0000FF">progn</span></span>
        <span style="color: #FF0000">(</span>setq tax <span style="color: #FF0000">(</span><span style="font-weight: bold"><span style="color: #0000FF">*</span></span> total-price <span style="color: #FF0000">(</span>/ percent-tax <span style="color: #993399">100</span><span style="color: #FF0000">)))</span>
        <span style="color: #FF0000">(</span>setq total-price <span style="color: #FF0000">(</span><span style="font-weight: bold"><span style="color: #0000FF">+</span></span> total-price tax<span style="color: #FF0000">))))</span>
  total-price<span style="color: #FF0000">)</span></tt></pre></div><div class="title"><em>Mal</em> ejemplo de cómo resolverlo en Lisp (<a href="https://github.com/emanchado/camino-mejor-programador-codigo/blob/master/functional-languages/calculate-prices-bad.lisp">calculate-prices-bad.lisp</a>)</div>
</div>
<div class="paragraph"><p>Sin embargo, si escribimos la función así no aprendemos nada nuevo y mostramos
nuestro «acento extranjero» al escribir Lisp. Este código no es legible ni para
programadores de Java ni para programadores de Lisp, y además no aprovechamos
las ventajas del lenguaje, mientras que sufrimos sus desventajas.
Simplemente usamos Lisp como «un mal Java». Compárese el anterior código con el
siguiente:</p></div>
<div class="listingblock">
<div class="content"><!-- Generator: GNU source-highlight 3.1.6
by Lorenzo Bettini
http://www.lorenzobettini.it
http://www.gnu.org/software/src-highlite -->
<pre><tt><span style="color: #FF0000">(</span><span style="font-weight: bold"><span style="color: #0000FF">defun</span></span> calculate-price <span style="color: #FF0000">(</span>cost nitems limit percent-tax<span style="color: #FF0000">)</span>
  <span style="color: #FF0000">(</span><span style="font-weight: bold"><span style="color: #0000FF">let*</span></span> <span style="color: #FF0000">((</span>total-price <span style="color: #FF0000">(</span><span style="font-weight: bold"><span style="color: #0000FF">*</span></span> cost nitems<span style="color: #FF0000">))</span>
         <span style="color: #FF0000">(</span>tax         <span style="color: #FF0000">(</span><span style="font-weight: bold"><span style="color: #0000FF">*</span></span> total-price <span style="color: #FF0000">(</span>/ percent-tax <span style="color: #993399">100</span><span style="color: #FF0000">))))</span>
    <span style="color: #FF0000">(</span><span style="font-weight: bold"><span style="color: #0000FF">if</span></span> <span style="color: #FF0000">(</span>&gt; total-price limit<span style="color: #FF0000">)</span>
      <span style="color: #FF0000">(</span><span style="font-weight: bold"><span style="color: #0000FF">+</span></span> total-price tax<span style="color: #FF0000">)</span>
      total-price<span style="color: #FF0000">)))</span></tt></pre></div><div class="title">Solución usando Lisp de una forma más convencional (<a href="https://github.com/emanchado/camino-mejor-programador-codigo/blob/master/functional-languages/calculate-prices.lisp">calculate-prices.lisp</a>)</div>
</div>
<div class="paragraph"><p>Este código se parece más a lo que muchos programadores de Lisp esperarían o
escribirían ellos mismos, y a la mayoría de las personas que sepan un poco de
Lisp les parecerá más legible y fácil de mantener. La razón es que estamos
jugando con las fortalezas de Lisp, en vez de intentar adaptar el lenguaje a
nuestros conocimientos previos.</p></div>
<div class="paragraph"><p>Concretamente, el segundo ejemplo se aprovecha de dos detalles muy comunes en
Lisp que no son tan comunes en lenguajes no funcionales:</p></div>
<div class="olist arabic"><ol class="arabic">
<li>
<p>
No usar variables, sino «valores con nombre». O, dicho de otra manera,
evitar asignar más de una vez a cada variable. Esto se puede ver en el bloque
<span class="monospaced">let*</span>: las dos «variables» del bloque, <span class="monospaced">total-price</span> y <span class="monospaced">tax</span>, nunca
reciben otros valores. Así, el bloque <span class="monospaced">let*</span> contiene una lista de valores con
nombres simbólicos, lo que hace el código más claro y mantenible.
</p>
</li>
<li>
<p>
La construcción <span class="monospaced">if</span> sigue el patrón funcional de ser una <em>expresión</em> que
devuelve un valor. En este caso, recibe una condición y dos expresiones: la
primera se devuelve si la condición es verdadera, y la segunda si la condición
resulta ser falsa. Funciona de una forma parecida al operador ternario de C y
Java (<span class="monospaced">valor = condicion ? valorsiverdadero : valorsifalso</span>).
</p>
</li>
</ol></div>
<div class="paragraph"><p>Sabiendo esto, y que la última expresión de una función Lisp es el valor
devuelto por ésta, se puede entender el segundo ejemplo mucho mejor.</p></div>
</div>
<div class="sect2">
<h3 id="_pensar_en_el_objetivo_no_en_el_proceso">Pensar en el objetivo, no en el proceso</h3>
<div class="paragraph"><p>Aunque el ejemplo de arriba es bastante simplista, también ilustra que los
lenguajes funcionales tienden a hacerte pensar más en el objetivo que en el
proceso. Para algoritmos, generalmente una solución en un lenguaje funcional se
parece más a la definición matemática. En el primer ejemplo, la implementación
de la función está basada en el proceso de calcular. En el segundo, en el
significado de las operaciones.</p></div>
<div class="paragraph"><p>Si lo pensamos en castellano, el primer ejemplo sería algo así:</p></div>
<div class="quoteblock">
<div class="content">Primero multiplicamos <span class="monospaced">cost</span> por <span class="monospaced">nitems</span> para calcular el precio base, y lo
guardamos en <span class="monospaced">total-price</span>. Si éste está por encima de <span class="monospaced">limit</span>, entonces
primero calculamos <span class="monospaced">tax</span> a base de multiplicar <span class="monospaced">total-price</span> por <span class="monospaced">percent-tax</span>
dividido por 100, y luego guardamos en <span class="monospaced">total-price</span> la suma del antiguo
<span class="monospaced">total-price</span> más <span class="monospaced">tax</span>. El resultado es el valor guardado en <span class="monospaced">total-price</span> al
final del proceso.</div>
<div class="attribution">
</div></div>
<div class="paragraph"><p>El segundo ejemplo, en cambio, sería algo así:</p></div>
<div class="quoteblock">
<div class="content">El resultado es la suma de <span class="monospaced">total-price</span> y <span class="monospaced">tax</span> si <span class="monospaced">total-price</span> está por
encima de <span class="monospaced">limit</span>, o <span class="monospaced">total-price</span> en caso contrario. Definimos
<span class="monospaced">total-price</span> como la multiplicación de <span class="monospaced">cost</span> por <span class="monospaced">nitems</span>, y <span class="monospaced">tax</span>
como la multiplicación de <span class="monospaced">total-price</span> por <span class="monospaced">percent-tax</span> dividido por 100.</div>
<div class="attribution">
</div></div>
<div class="paragraph"><p>Nótese cómo en la segunda explicación podemos dejar para el final la
explicación de los valores declarados en el bloque <span class="monospaced">let*</span>. En muchos casos, y
siempre que hayamos escogido buenos nombres para esos valores, no hará falta
leer el bloque <span class="monospaced">let*</span> para entender la función.</p></div>
<div class="paragraph"><p>Usar variables que no cambian una vez les hemos asignado un valor, es una
buena costumbre porque hace más fácil entender de dónde sale cada valor. Por
esa razón, el lenguaje Scala distingue entre dos tipos de variables: <span class="monospaced">var</span> y
<span class="monospaced">val</span>. El segundo tipo, que es el más usado con diferencia, declara una
variable <em>inmutable</em>, por lo que el compilador nos asegura que no podemos
asignar ningún otro valor una vez declarada.</p></div>
<div class="paragraph"><p>Esto está relacionado con el siguiente apartado, «Diseño de abajo a arriba,
funciones pequeñas»: para poder pensar en el significado, muchas de las
operaciones tienen que abstraerse en pequeñas funciones.</p></div>
</div>
<div class="sect2">
<h3 id="_diseño_de_abajo_a_arriba_funciones_pequeñas">Diseño de abajo a arriba, funciones pequeñas</h3>
<div class="paragraph"><p>Otra característica común de la programación en Lisp es intentar acercar el
lenguaje a la tarea que se intenta resolver. Una de las maneras de hacerlo es
escribir funciones que, aunque sean pequeñas y simples, escondan detalles de
implementación que no nos interesen y que suban el nivel de abstracción. La
lección aquí es que escribir funciones y métodos de una o dos líneas es útil
<em>si</em> suben el nivel de abstracción. No se trata de «esconder código» para no
tenerlo a la vista, se trata de hacer olvidar a uno mismo parte de la
complejidad de la tarea que está realizando.</p></div>
<div class="paragraph"><p>Como ejemplo, sigamos con el caso anterior de los precios y los artículos. Una
de las operaciones que hacemos es calcular un tanto por ciento. Si suponemos
que es una operación que usaremos más de una vez, podría tener sentido abstraer
ese cálculo. No nos vamos a ahorrar líneas de código, pero esta versión puede
requerir menos esfuerzo mental y ser más fácil de leer (imagínese el siguiente
ejemplo en castellano, tal y como hicimos en el anterior apartado):</p></div>
<div class="listingblock">
<div class="content"><!-- Generator: GNU source-highlight 3.1.6
by Lorenzo Bettini
http://www.lorenzobettini.it
http://www.gnu.org/software/src-highlite -->
<pre><tt><span style="font-style: italic"><span style="color: #9A1900">; En el caso de Lisp, podríamos haber llamado a esta función '%', de modo que</span></span>
<span style="font-style: italic"><span style="color: #9A1900">; la llamada de abajo quedaría '(% percent-tax total-price)'</span></span>
<span style="color: #FF0000">(</span><span style="font-weight: bold"><span style="color: #0000FF">defun</span></span> percentage <span style="color: #FF0000">(</span>percent amount<span style="color: #FF0000">)</span>
  <span style="color: #FF0000">(</span><span style="font-weight: bold"><span style="color: #0000FF">*</span></span> amount <span style="color: #FF0000">(</span>/ percent <span style="color: #993399">100</span><span style="color: #FF0000">)))</span>

<span style="color: #FF0000">(</span><span style="font-weight: bold"><span style="color: #0000FF">defun</span></span> calculate-price <span style="color: #FF0000">(</span>cost nitems limit percent-tax<span style="color: #FF0000">)</span>
  <span style="color: #FF0000">(</span><span style="font-weight: bold"><span style="color: #0000FF">let*</span></span> <span style="color: #FF0000">((</span>total-price <span style="color: #FF0000">(</span><span style="font-weight: bold"><span style="color: #0000FF">*</span></span> cost nitems<span style="color: #FF0000">))</span>
         <span style="color: #FF0000">(</span>tax         <span style="color: #FF0000">(</span>percentage percent-tax total-price<span style="color: #FF0000">)))</span>
    <span style="color: #FF0000">(</span><span style="font-weight: bold"><span style="color: #0000FF">if</span></span> <span style="color: #FF0000">(</span>&gt; total-price limit<span style="color: #FF0000">)</span>
      <span style="color: #FF0000">(</span><span style="font-weight: bold"><span style="color: #0000FF">+</span></span> total-price tax<span style="color: #FF0000">)</span>
      total-price<span style="color: #FF0000">)))</span></tt></pre></div><div class="title">Solución abstrayendo el cálculo de porcentajes (<a href="https://github.com/emanchado/camino-mejor-programador-codigo/blob/master/functional-languages/calculate-prices.lisp">calculate-prices.lisp</a>)</div>
</div>
<div class="paragraph"><p>Calcular un tanto por ciento es trivial, y por escribir la función <span class="monospaced">percentage</span>
no estamos ahorrando líneas de código, pero cada segundo que ahorramos en
entender trivialidades al leer la fuente es un segundo más que podemos dedicar
a asuntos más importantes. Y el tiempo que necesitamos para entender código sin
las abstracciones apropiadas, con frecuencia crece exponencialmente, no
linealmente, al añadir nuevas faltas de abstracción.</p></div>
<div class="paragraph"><p>Otra ventaja de abstraer funciones de esta manera es que estas funciones
normalmente son bastante fáciles de probar, porque tienden a tener interfaces
sencillas y responsabilidades claras. En el caso de lenguajes que tienen una
consola interactiva (como Lisp, Python, Ruby y otros) es fácil experimentar con
la función y ver lo que hace, facilitando la escritura de pruebas unitarias en
cualquier lenguaje. Especialmente si evitamos los efectos colaterales, como
veremos en el siguiente apartado.</p></div>
</div>
<div class="sect2">
<h3 id="_efectos_colaterales">Efectos colaterales</h3>
<div class="paragraph"><p>Los llamados <em>efectos colaterales</em> son uno de los conceptos más importantes de
la programación funcional, por no decir que el más importante. Es lo que
diferencia los lenguajes puramente funcionales de los lenguajes funcionales no
puros. Incluso los programadores de los lenguajes que no son puramente
funcionales (como Lisp) generalmente intentan evitar efectos colaterales.</p></div>
<div class="paragraph"><p>Un efecto colateral es cualquier cambio que una función produce fuera del
ámbito de la función en sí. Por ejemplo, una función que modifique una variable
que ha recibido como parámetro (es decir, «parámetros de entrada/salida») o que
modifique variables globales o cualquier otra cosa que no sean variables
locales a la función está produciendo efectos colaterales. Esto incluye
cualquier tipo de entrada/salida, como leer o escribir ficheros o interactuar
con la pantalla, el teclado o el ratón.</p></div>
<div class="paragraph"><p>¿Por qué es tan importante evitar efectos colaterales? De nuevo, como en el
caso de las pequeñas funciones que suban el nivel de abstracción, evitar un
solo efecto colateral no es una ventaja muy grande. Sin embargo, evitar efectos
colaterales como regla general hace que los programas sean más fáciles de
entender y mantener, y que haya menos sorpresas. La razón es que evitar efectos
colaterales <em>garantiza</em> que ningún error en la función pueda afectar a nada
más. Si además no hacemos referencia a nada externo a la función, como
variables globales, tenemos una garantía extra importantísima: la función es
independiente del resto del código, lo que significa que ningún fallo del resto
del programa puede afectar a nuestra función, y que podemos probar la función
independientemente del resto del código, lo cual no sólo es práctico, sino que
hace más fácil asegurarse de que cubrimos todos los casos posibles de la
función con baterías de pruebas.</p></div>
<div class="paragraph"><p>Veamos un ejemplo de efectos colaterales en Python. El método <span class="monospaced">sort</span>,
desgraciadamente, modifica la lista sobre la que se llama. Esto puede
producir sorpresas desagradables, como veremos en el primer ejemplo. Digamos
que estamos escribiendo un programa para gestionar competiciones de carreras y
escribimos una función <span class="monospaced">best_time</span> que recibe una lista de números y devuelve
el menor (obviamos la existencia de la función <span class="monospaced">min</span> para hacer el ejemplo más
ilustrativo):</p></div>
<div class="listingblock">
<div class="content"><!-- Generator: GNU source-highlight 3.1.6
by Lorenzo Bettini
http://www.lorenzobettini.it
http://www.gnu.org/software/src-highlite -->
<pre><tt><span style="font-weight: bold"><span style="color: #0000FF">def</span></span> <span style="font-weight: bold"><span style="color: #000000">best_time_BAD</span></span><span style="color: #990000">(</span>list<span style="color: #990000">):</span>
  <span style="font-weight: bold"><span style="color: #0000FF">if</span></span> <span style="font-weight: bold"><span style="color: #000000">len</span></span><span style="color: #990000">(</span>list<span style="color: #990000">)</span> <span style="color: #990000">==</span> <span style="color: #993399">0</span><span style="color: #990000">:</span>
    <span style="font-weight: bold"><span style="color: #0000FF">return</span></span> None
  list<span style="color: #990000">.</span><span style="font-weight: bold"><span style="color: #000000">sort</span></span><span style="color: #990000">()</span>
  <span style="font-weight: bold"><span style="color: #0000FF">return</span></span> list<span style="color: #990000">[</span><span style="color: #993399">0</span><span style="color: #990000">]</span>

times <span style="color: #990000">=</span> <span style="color: #990000">[</span><span style="color: #993399">5</span><span style="color: #990000">,</span> <span style="color: #993399">9</span><span style="color: #990000">,</span> <span style="color: #993399">4</span><span style="color: #990000">,</span> <span style="color: #993399">6</span><span style="color: #990000">,</span> <span style="color: #993399">10</span><span style="color: #990000">,</span> <span style="color: #993399">8</span><span style="color: #990000">]</span>
<span style="font-weight: bold"><span style="color: #000000">best_time_BAD</span></span><span style="color: #990000">(</span>times<span style="color: #990000">)</span>  <span style="font-style: italic"><span style="color: #9A1900"># Devuelve 4</span></span>
<span style="font-weight: bold"><span style="color: #0000FF">print</span></span> times           <span style="font-style: italic"><span style="color: #9A1900"># ¡Esto imprime «[4, 5, 6, 8, 9, 10]»!</span></span></tt></pre></div><div class="title">Sorpresa desagradable debida a un efecto colateral (<a href="https://github.com/emanchado/camino-mejor-programador-codigo/blob/master/functional-languages/best-time-bad.py">best-time-bad.py</a>)</div>
</div>
<div class="paragraph"><p>Una forma de resolver este problema es usar la función <span class="monospaced">sorted</span> en vez del
método <span class="monospaced">sort</span>:</p></div>
<div class="listingblock">
<div class="content"><!-- Generator: GNU source-highlight 3.1.6
by Lorenzo Bettini
http://www.lorenzobettini.it
http://www.gnu.org/software/src-highlite -->
<pre><tt><span style="font-weight: bold"><span style="color: #0000FF">def</span></span> <span style="font-weight: bold"><span style="color: #000000">best_time</span></span><span style="color: #990000">(</span>list<span style="color: #990000">):</span>
  <span style="font-weight: bold"><span style="color: #0000FF">if</span></span> <span style="font-weight: bold"><span style="color: #000000">len</span></span><span style="color: #990000">(</span>list<span style="color: #990000">)</span> <span style="color: #990000">==</span> <span style="color: #993399">0</span><span style="color: #990000">:</span>
    <span style="font-weight: bold"><span style="color: #0000FF">return</span></span> None
  <span style="font-weight: bold"><span style="color: #0000FF">return</span></span> <span style="font-weight: bold"><span style="color: #000000">sorted</span></span><span style="color: #990000">(</span>list<span style="color: #990000">)[</span><span style="color: #993399">0</span><span style="color: #990000">]</span>

times <span style="color: #990000">=</span> <span style="color: #990000">[</span><span style="color: #993399">5</span><span style="color: #990000">,</span> <span style="color: #993399">9</span><span style="color: #990000">,</span> <span style="color: #993399">4</span><span style="color: #990000">,</span> <span style="color: #993399">6</span><span style="color: #990000">,</span> <span style="color: #993399">10</span><span style="color: #990000">,</span> <span style="color: #993399">8</span><span style="color: #990000">]</span>
<span style="font-weight: bold"><span style="color: #000000">best_time</span></span><span style="color: #990000">(</span>times<span style="color: #990000">)</span>  <span style="font-style: italic"><span style="color: #9A1900"># Devuelve 4</span></span>
<span style="font-weight: bold"><span style="color: #0000FF">print</span></span> times       <span style="font-style: italic"><span style="color: #9A1900"># Imprime «[5, 9, 4, 6, 10, 8]»</span></span></tt></pre></div><div class="title">Mejor implementación, sin efectos colaterales (<a href="https://github.com/emanchado/camino-mejor-programador-codigo/blob/master/functional-languages/best-time-bad.py">best-time-bad.py</a>)</div>
</div>
<div class="paragraph"><p>En Ruby normalmente se usa la convención de añadir un «!» al final del nombre
del método si éste produce efectos colaterales (otra convención que se puede
apreciar en el ejemplo es cómo los métodos que devuelven verdadero/falso
terminan en «?»). El ejemplo de arriba se podría traducir a Ruby de la
siguiente manera:</p></div>
<div class="listingblock">
<div class="content"><!-- Generator: GNU source-highlight 3.1.6
by Lorenzo Bettini
http://www.lorenzobettini.it
http://www.gnu.org/software/src-highlite -->
<pre><tt><span style="font-weight: bold"><span style="color: #000080">require</span></span> <span style="color: #FF0000">'pp'</span>             <span style="font-style: italic"><span style="color: #9A1900"># Pretty printer</span></span>

<span style="font-weight: bold"><span style="color: #0000FF">def</span></span> best_time_BAD<span style="color: #990000">(</span>list<span style="color: #990000">)</span>
  <span style="font-weight: bold"><span style="color: #0000FF">if</span></span> list<span style="color: #990000">.</span>empty?
    <span style="font-weight: bold"><span style="color: #0000FF">nil</span></span>
  <span style="font-weight: bold"><span style="color: #0000FF">else</span></span>
    list<span style="color: #990000">.</span>sort!          <span style="font-style: italic"><span style="color: #9A1900"># «sort!», ¡con efectos colaterales!</span></span>
    list<span style="color: #990000">[</span><span style="color: #993399">0</span><span style="color: #990000">]</span>
  <span style="font-weight: bold"><span style="color: #0000FF">end</span></span>
<span style="font-weight: bold"><span style="color: #0000FF">end</span></span>

times <span style="color: #990000">=</span> <span style="color: #990000">[</span><span style="color: #993399">5</span><span style="color: #990000">,</span> <span style="color: #993399">9</span><span style="color: #990000">,</span> <span style="color: #993399">4</span><span style="color: #990000">,</span> <span style="color: #993399">6</span><span style="color: #990000">,</span> <span style="color: #993399">10</span><span style="color: #990000">,</span> <span style="color: #993399">8</span><span style="color: #990000">]</span>
best_time_BAD<span style="color: #990000">(</span>times<span style="color: #990000">)</span>  <span style="font-style: italic"><span style="color: #9A1900"># Devuelve 4</span></span>
pp times              <span style="font-style: italic"><span style="color: #9A1900"># Imprime «[4, 5, 6, 8, 9, 10]»</span></span>

<span style="font-weight: bold"><span style="color: #0000FF">def</span></span> best_time<span style="color: #990000">(</span>list<span style="color: #990000">)</span>
  <span style="font-weight: bold"><span style="color: #0000FF">if</span></span> list<span style="color: #990000">.</span>empty?
    <span style="font-weight: bold"><span style="color: #0000FF">nil</span></span>
  <span style="font-weight: bold"><span style="color: #0000FF">else</span></span>
    list<span style="color: #990000">.</span>sort<span style="color: #990000">[</span><span style="color: #993399">0</span><span style="color: #990000">]</span>       <span style="font-style: italic"><span style="color: #9A1900"># «sort», sin «!»</span></span>
  <span style="font-weight: bold"><span style="color: #0000FF">end</span></span>
<span style="font-weight: bold"><span style="color: #0000FF">end</span></span>

times2 <span style="color: #990000">=</span> <span style="color: #990000">[</span><span style="color: #993399">5</span><span style="color: #990000">,</span> <span style="color: #993399">9</span><span style="color: #990000">,</span> <span style="color: #993399">4</span><span style="color: #990000">,</span> <span style="color: #993399">6</span><span style="color: #990000">,</span> <span style="color: #993399">10</span><span style="color: #990000">,</span> <span style="color: #993399">8</span><span style="color: #990000">]</span>
best_time<span style="color: #990000">(</span>times2<span style="color: #990000">)</span>  <span style="font-style: italic"><span style="color: #9A1900"># Devuelve 4</span></span>
pp times2          <span style="font-style: italic"><span style="color: #9A1900"># Imprime «[5, 9, 4, 6, 10, 8]»</span></span></tt></pre></div><div class="title">Efectos colaterales en Ruby (<a href="https://github.com/emanchado/camino-mejor-programador-codigo/blob/master/functional-languages/best-time.rb">best-time.rb</a>)</div>
</div>
<div class="paragraph"><p>Por último, evitar efectos colaterales permite a las funciones usar una técnica
de optimización llamada «memorización» (<em>memoization</em> en inglés). Esta
técnica consiste en recordar el valor retornado por la función la primera vez
que se llama.  Cuando se vuelve a llamar a la función con los mismos
parámetros, en vez de ejecutar el cuerpo de la función, se devuelve el valor
recordado. Si la función no produce ningún efecto colateral, esta técnica es
perfectamente segura porque está garantizado que los mismos parámetros de
entrada siempre producen el mismo resultado. Un ejemplo muy sencillo de
memorización en Javascript es la siguiente implementación de la serie de
Fibonacci:</p></div>
<div class="listingblock">
<div class="content"><!-- Generator: GNU source-highlight 3.1.6
by Lorenzo Bettini
http://www.lorenzobettini.it
http://www.gnu.org/software/src-highlite -->
<pre><tt><span style="font-weight: bold"><span style="color: #0000FF">var</span></span> fibonacciCache <span style="color: #990000">=</span> <span style="color: #FF0000">{</span><span style="color: #993399">0</span><span style="color: #990000">:</span> <span style="color: #993399">1</span><span style="color: #990000">,</span> <span style="color: #993399">1</span><span style="color: #990000">:</span> <span style="color: #993399">1</span><span style="color: #FF0000">}</span><span style="color: #990000">;</span>

<span style="font-weight: bold"><span style="color: #0000FF">function</span></span> <span style="font-weight: bold"><span style="color: #000000">fibonacci</span></span><span style="color: #990000">(</span>pos<span style="color: #990000">)</span> <span style="color: #FF0000">{</span>
  <span style="font-weight: bold"><span style="color: #0000FF">if</span></span> <span style="color: #990000">(</span>pos <span style="color: #990000">&lt;</span> <span style="color: #993399">0</span><span style="color: #990000">)</span> <span style="color: #FF0000">{</span>
    <span style="font-weight: bold"><span style="color: #0000FF">throw</span></span> <span style="color: #FF0000">"La serie de Fibonacci sólo está definida para números naturales"</span><span style="color: #990000">;</span>
  <span style="color: #FF0000">}</span>

  <span style="font-weight: bold"><span style="color: #0000FF">if</span></span> <span style="color: #990000">(!</span> fibonacciCache<span style="color: #990000">.</span><span style="font-weight: bold"><span style="color: #000000">hasOwnProperty</span></span><span style="color: #990000">(</span>pos<span style="color: #990000">))</span> <span style="color: #FF0000">{</span>
    console<span style="color: #990000">.</span><span style="font-weight: bold"><span style="color: #000000">log</span></span><span style="color: #990000">(</span><span style="color: #FF0000">"Calculo el resultado para la posición "</span> <span style="color: #990000">+</span> pos<span style="color: #990000">);</span>
    fibonacciCache<span style="color: #990000">[</span>pos<span style="color: #990000">]</span> <span style="color: #990000">=</span> <span style="font-weight: bold"><span style="color: #000000">fibonacci</span></span><span style="color: #990000">(</span>pos <span style="color: #990000">-</span> <span style="color: #993399">1</span><span style="color: #990000">)</span> <span style="color: #990000">+</span> <span style="font-weight: bold"><span style="color: #000000">fibonacci</span></span><span style="color: #990000">(</span>pos <span style="color: #990000">-</span> <span style="color: #993399">2</span><span style="color: #990000">);</span>
  <span style="color: #FF0000">}</span>

  <span style="font-weight: bold"><span style="color: #0000FF">return</span></span> fibonacciCache<span style="color: #990000">[</span>pos<span style="color: #990000">];</span>
<span style="color: #FF0000">}</span></tt></pre></div><div class="title">Implementación de la serie de Fibonacci con memorización (<a href="https://github.com/emanchado/camino-mejor-programador-codigo/blob/master/functional-languages/fibonacci.js">fibonacci.js</a>)</div>
</div>
<div class="paragraph"><p>Si se copia este código en una consola Javascript (digamos, Node) y se hacen
distintas llamadas a la función <span class="monospaced">fibonacci</span>, se podrá comprobar (gracias a los
mensajes impresos por <span class="monospaced">console.log</span>) que cada posición de la serie sólo se
calcula una vez.</p></div>
<div class="paragraph"><p>En lenguajes dinámicos como Python, Ruby o Javascript, es relativamente
sencillo escribir una función que reciba otra función como parámetro y le
aplique la técnica de «memorización». El siguiente apartado explora la técnica
de manipular funciones como datos.</p></div>
</div>
<div class="sect2">
<h3 id="_funciones_de_orden_superior">Funciones de orden superior</h3>
<div class="paragraph"><p>Otra de las características comunes de los lenguajes funcionales es tratar a
las funciones como «ciudadanos de primera clase». Es decir, las funciones son
valores más o menos normales que se pueden pasar como parámetros, asignar a
variables y devolver como resultado de la llamada a una función. Las funciones
que utilizan esta característica, es decir, que manipulan o devuelven
funciones, reciben el nombre de <em>funciones de orden superior</em>.
Afortunadamente, muchos lenguajes populares tienen este tipo de funciones.</p></div>
<div class="paragraph"><p>La primera vez que uno se encuentra funciones de orden superior puede pensar
que sus usos son limitados, pero realmente tienen muchas aplicaciones. Por un
lado, tenemos las funciones y métodos que traiga el lenguaje de serie, por lo
general de manejo de listas. Por otro, tenemos la posibilidad de escribir
nuestras propias funciones y métodos de orden superior, para separar o
reutilizar código de manera más efectiva.</p></div>
<div class="paragraph"><p>Veamos un ejemplo de lo primero en Ruby. Algunos de los métodos de la clase
<span class="monospaced">Array</span> reciben una función como parámetro (en Ruby se los llama <em>bloques</em>), lo
que permite escribir código bastante compacto y expresivo:</p></div>
<div class="listingblock">
<div class="content"><!-- Generator: GNU source-highlight 3.1.6
by Lorenzo Bettini
http://www.lorenzobettini.it
http://www.gnu.org/software/src-highlite -->
<pre><tt><span style="font-style: italic"><span style="color: #9A1900"># Comprobar si todas las palabras tienen menos de 5 letras</span></span>
<span style="font-weight: bold"><span style="color: #0000FF">if</span></span> words<span style="color: #990000">.</span>all? <span style="color: #FF0000">{</span><span style="color: #990000">|</span>w<span style="color: #990000">|</span> w<span style="color: #990000">.</span>length <span style="color: #990000">&lt;</span> <span style="color: #993399">5</span> <span style="color: #FF0000">}</span>
   <span style="font-style: italic"><span style="color: #9A1900"># ...</span></span>
<span style="font-weight: bold"><span style="color: #0000FF">end</span></span>

<span style="font-style: italic"><span style="color: #9A1900"># Comprobar si el cliente tiene algún envío pendiente</span></span>
<span style="font-weight: bold"><span style="color: #0000FF">if</span></span> customer<span style="color: #990000">.</span>orders<span style="color: #990000">.</span>any? <span style="color: #FF0000">{</span><span style="color: #990000">|</span>o<span style="color: #990000">|</span> <span style="font-weight: bold"><span style="color: #0000FF">not</span></span> o<span style="color: #990000">.</span>sent? <span style="color: #FF0000">}</span>
   <span style="font-style: italic"><span style="color: #9A1900"># ...</span></span>
<span style="font-weight: bold"><span style="color: #0000FF">end</span></span>

<span style="font-style: italic"><span style="color: #9A1900"># Obtener las asignaturas suspendidas por un alumno</span></span>
failed_subjects <span style="color: #990000">=</span> student<span style="color: #990000">.</span>subjects<span style="color: #990000">.</span>find_all <span style="color: #FF0000">{</span><span style="color: #990000">|</span>s<span style="color: #990000">|</span> s<span style="color: #990000">.</span>mark <span style="color: #990000">&lt;</span> <span style="color: #993399">5</span> <span style="color: #FF0000">}</span>

<span style="font-style: italic"><span style="color: #9A1900"># Dividir los candidatos entre los que saben más de</span></span>
<span style="font-style: italic"><span style="color: #9A1900"># dos idiomas y los demás</span></span>
polyglots<span style="color: #990000">,</span> rest <span style="color: #990000">=</span> cands<span style="color: #990000">.</span>partition <span style="color: #FF0000">{</span><span style="color: #990000">|</span>c<span style="color: #990000">|</span> c<span style="color: #990000">.</span>languages<span style="color: #990000">.</span>length <span style="color: #990000">&gt;</span> <span style="color: #993399">2</span> <span style="color: #FF0000">}</span>

<span style="font-style: italic"><span style="color: #9A1900"># Obtener una versión en mayúsculas de las palabras</span></span>
<span style="font-style: italic"><span style="color: #9A1900"># de la lista</span></span>
words <span style="color: #990000">=</span> <span style="color: #990000">[</span><span style="color: #FF0000">"hoygan"</span><span style="color: #990000">,</span> <span style="color: #FF0000">"kiero"</span><span style="color: #990000">,</span> <span style="color: #FF0000">"hanime"</span><span style="color: #990000">,</span> <span style="color: #FF0000">"gratix"</span><span style="color: #990000">]</span>
shouts <span style="color: #990000">=</span> words<span style="color: #990000">.</span>map <span style="color: #FF0000">{</span><span style="color: #990000">|</span>w<span style="color: #990000">|</span> w<span style="color: #990000">.</span>upcase<span style="color: #FF0000">}</span></tt></pre></div><div class="title">Métodos de orden superior en Ruby</div>
</div>
<div class="paragraph"><p>El código equivalente que habría que escribir para conseguir el mismo resultado
sin funciones de orden superior es bastante más largo y difícil de leer.
Además, si quisiéramos hacer operaciones parecidas variando la condición
(digamos, en una parte del código queremos comprobar si todas las palabras
tienen menos de cinco letras, y en otra queremos comprobar si todas las
palabras se componen exclusivamente de letras, sin números u otros caracteres)
el código empeoraría rápidamente.</p></div>
<div class="paragraph"><p>Escribir nuestras propias funciones tampoco tiene que ser difícil, ni usarse en
casos muy especiales. Pueden ser usos tan comunes y sencillos como el siguiente
ejemplo en Javascript:</p></div>
<div class="listingblock">
<div class="content"><!-- Generator: GNU source-highlight 3.1.6
by Lorenzo Bettini
http://www.lorenzobettini.it
http://www.gnu.org/software/src-highlite -->
<pre><tt><span style="font-style: italic"><span style="color: #9A1900">// Queremos poder escribir el siguiente código</span></span>
<span style="font-weight: bold"><span style="color: #0000FF">var</span></span> comicCollection <span style="color: #990000">=</span> <span style="font-weight: bold"><span style="color: #0000FF">new</span></span> <span style="font-weight: bold"><span style="color: #000000">Database</span></span><span style="color: #990000">(</span><span style="color: #FF0000">'comics'</span><span style="color: #990000">);</span>
comicCollection<span style="color: #990000">.</span><span style="font-weight: bold"><span style="color: #000000">onAdd</span></span><span style="color: #990000">(</span><span style="font-weight: bold"><span style="color: #0000FF">function</span></span><span style="color: #990000">(</span>comic<span style="color: #990000">)</span> <span style="color: #FF0000">{</span>
    console<span style="color: #990000">.</span><span style="font-weight: bold"><span style="color: #000000">log</span></span><span style="color: #990000">(</span><span style="color: #FF0000">"Nuevo cómic añadido: "</span> <span style="color: #990000">+</span> comic<span style="color: #990000">.</span>title<span style="color: #990000">);</span>
<span style="color: #FF0000">}</span><span style="color: #990000">);</span>
<span style="font-style: italic"><span style="color: #9A1900">// La siguiente línea debería imprimir «Nuevo cómic...» en la consola</span></span>
comicCollection<span style="color: #990000">.</span><span style="font-weight: bold"><span style="color: #000000">add</span></span><span style="color: #990000">(</span><span style="color: #FF0000">{</span>title<span style="color: #990000">:</span>  <span style="color: #FF0000">"Batman: The Dark Knight Returns"</span><span style="color: #990000">,</span>
                     author<span style="color: #990000">:</span> <span style="color: #FF0000">"Frank Miller"</span><span style="color: #FF0000">}</span><span style="color: #990000">);</span>

<span style="font-style: italic"><span style="color: #9A1900">// La implementación de onAdd puede ser muy sencilla</span></span>
Database<span style="color: #990000">.</span><span style="font-weight: bold"><span style="color: #0000FF">prototype</span></span><span style="color: #990000">.</span>onAdd <span style="color: #990000">=</span> <span style="font-weight: bold"><span style="color: #0000FF">function</span></span><span style="color: #990000">(</span>f<span style="color: #990000">)</span> <span style="color: #FF0000">{</span>
    <span style="font-weight: bold"><span style="color: #0000FF">this</span></span><span style="color: #990000">.</span>onAddFunction <span style="color: #990000">=</span> f<span style="color: #990000">;</span>
<span style="color: #FF0000">}</span>
<span style="font-style: italic"><span style="color: #9A1900">// La implementación de add también</span></span>
Database<span style="color: #990000">.</span><span style="font-weight: bold"><span style="color: #0000FF">prototype</span></span><span style="color: #990000">.</span>add <span style="color: #990000">=</span> <span style="font-weight: bold"><span style="color: #0000FF">function</span></span><span style="color: #990000">(</span>obj<span style="color: #990000">)</span> <span style="color: #FF0000">{</span>
    <span style="font-weight: bold"><span style="color: #0000FF">this</span></span><span style="color: #990000">.</span>data<span style="color: #990000">.</span><span style="font-weight: bold"><span style="color: #000000">push</span></span><span style="color: #990000">(</span>obj<span style="color: #990000">);</span>
    <span style="font-weight: bold"><span style="color: #0000FF">if</span></span> <span style="color: #990000">(</span><span style="font-weight: bold"><span style="color: #0000FF">typeof</span></span><span style="color: #990000">(</span><span style="font-weight: bold"><span style="color: #0000FF">this</span></span><span style="color: #990000">.</span>onAddFunction<span style="color: #990000">)</span> <span style="color: #990000">===</span> <span style="color: #FF0000">'function'</span><span style="color: #990000">)</span> <span style="color: #FF0000">{</span>
        <span style="font-weight: bold"><span style="color: #0000FF">this</span></span><span style="color: #990000">.</span><span style="font-weight: bold"><span style="color: #000000">onAddFunction</span></span><span style="color: #990000">(</span>obj<span style="color: #990000">);</span>
    <span style="color: #FF0000">}</span>
<span style="color: #FF0000">}</span></tt></pre></div><div class="title">Funciones de orden superior en Javascript</div>
</div>
<div class="paragraph"><p>A partir de Ecmascript 5, la clase <span class="monospaced">Array</span> añade varios métodos de orden
superior que son comunes en la programación funcional.</p></div>
</div>
<div class="sect2">
<h3 id="_evaluación_perezosa">Evaluación perezosa</h3>
<div class="paragraph"><p>La última característica de lenguajes funcionales que exploraremos es la
<em>evaluación perezosa</em>. No hay muchos lenguajes que incluyan evaluación
perezosa, pero se puede imitar hasta cierto punto, y saber cómo funciona puede
darnos ideas e inspirarnos a la hora de diseñar nuestros propios sistemas. Uno
de los relativamente pocos lenguajes que incluye evaluación perezosa es
Haskell.</p></div>
<div class="paragraph"><p>La evaluación perezosa consiste en no hacer cálculos que no sean necesarios.
Por ejemplo, digamos que escribimos una función que genere recursivamente una
lista de 10 elementos, y otra función que llame a la primera, pero que sólo use
el valor del cuarto elemento. Cuando se ejecute la segunda función, Haskell
ejecutará la primera hasta que el cuarto elemento sea calculado.  Es decir:
Haskell no ejecutará, como la mayoría de los lenguajes, la primera función
hasta que <em>devuelva</em> su valor (una lista de 10 elementos); sólo ejecutará la
función hasta que se <em>genere</em> el cuarto elemento de la lista, que es lo único
que necesita para continuar la ejecución del programa principal. En este
sentido, la primera función es como una expresión matemática: inicialmente
Haskell no conoce el valor de la expresión, y sólo calculará la parte de ésta
que necesite. En este caso, los cuatro primeros elementos.</p></div>
<div class="paragraph"><p>¿Cuál es la ventaja de la evaluación perezosa? En la mayoría de los casos,
eficiencia. En otros casos, legibilidad. Cuando no tenemos que preocuparnos por
la memoria o ciclos de CPU usados por nuestra función, podemos hacer que
devuelvan (teóricamente) listas o estructuras infinitas, las cuales pueden ser
más fáciles de leer o implementar en algunos casos.  Aunque no es el ejemplo
más claro de legibilidad de evaluación perezosa, entender la siguiente
implementación de la serie de Fibonacci, aclarará la diferencia con la
evaluación estricta. Nótese que la función calcula la serie <em>entera</em>, es decir,
una lista <em>infinita</em>:</p></div>
<div class="listingblock">
<div class="content"><!-- Generator: GNU source-highlight 3.1.6
by Lorenzo Bettini
http://www.lorenzobettini.it
http://www.gnu.org/software/src-highlite -->
<pre><tt>fibs <span style="color: #990000">=</span> <span style="color: #993399">0</span> <span style="color: #990000">:</span> <span style="color: #993399">1</span> <span style="color: #990000">:</span> zipWith <span style="color: #990000">(+)</span> fibs <span style="color: #990000">(</span>tail fibs<span style="color: #990000">)</span></tt></pre></div><div class="title">Implementación de la serie de Fibonacci, en Haskell</div>
</div>
<div class="paragraph"><p>Normalmente la función es imposible de entender de un primer vistazo si no
estamos familiarizados con la programación funcional y la evaluación perezosa,
pero hay varios puntos que nos ayudarán:</p></div>
<div class="olist arabic"><ol class="arabic">
<li>
<p>
<span class="monospaced">tail lista</span> devuelve la lista dada, saltándose el primer elemento. Es
decir, si <span class="monospaced">lista</span> es <span class="monospaced">(1 2 3)</span>, <span class="monospaced">tail lista</span> es <span class="monospaced">(2 3)</span>.
</p>
</li>
<li>
<p>
<span class="monospaced">zipWith</span> calcula, dada una operación y dos listas, una lista que tiene:
como primer elemento, el resultado de aplicar la operación dada al primer
elemento de las dos listas; como segundo el resultado de aplicar la operación
al segundo elemento de las dos listas; etc. Así, <span class="monospaced">zipWith</span> llamado con la
función suma y las listas <span class="monospaced">(1 2 3)</span> y <span class="monospaced">(0 1 5)</span> resultaría en <span class="monospaced">(1 3 8)</span>.
</p>
</li>
<li>
<p>
Cada elemento de la lista devuelta por <span class="monospaced">fibs</span> se calculará individualmente,
y estará disponible en memoria sin necesidad de volver a ejecutar el código de
la función.
</p>
</li>
</ol></div>
<div class="paragraph"><p>Así, lo que ocurre es:</p></div>
<div class="olist arabic"><ol class="arabic">
<li>
<p>
Haskell empieza a construir una lista con los elementos <span class="monospaced">0</span> y <span class="monospaced">1</span>. En este
punto, <span class="monospaced">fibs = (0 1)</span>.
</p>
</li>
<li>
<p>
El tercer elemento será el primer elemento de la subexpresión <span class="monospaced">zipWith &#8230;</span>.
Para calcularlo, necesitamos la lista <span class="monospaced">fibs</span> (por ahora <span class="monospaced">(0 1)</span>, ya que sólo
conocemos dos elementos) y <span class="monospaced">tail fibs</span> (por ahora <span class="monospaced">(1)</span>). Al sumar el primer
elemento de cada una de esas listas (<span class="monospaced">0</span> y <span class="monospaced">1</span>), el resultado es <span class="monospaced">1</span>. En este
punto, <span class="monospaced">fibs = (0 1 1)</span> y la subexpresión <span class="monospaced">zipWith &#8230; = (1)</span>.
</p>
</li>
<li>
<p>
El cuarto elemento de <span class="monospaced">fibs</span> es el segundo elemento de <span class="monospaced">zipWidth &#8230;</span>. Para
calcularlo necesitaremos el segundo elemento de <span class="monospaced">fibs</span> y el segundo elemento de
<span class="monospaced">tail fibs</span>. El segundo elemento de <span class="monospaced">tail fibs</span> es el tercer elemento de
<span class="monospaced">fibs</span>, que ya conocemos porque lo calculamos en el paso anterior. Nótese que
<em>no</em> hace falta ninguna llamada recursiva porque los valores que necesitamos ya
están calculados. La evaluación perezosa funciona como una función matemática:
no hace falta que volvamos a calcular un valor si ya sabemos el resultado. En
este punto, <span class="monospaced">fibs = (0 1 1 2)</span> y la subexpresión <span class="monospaced">zipWith &#8230; = (1 2)</span>.
</p>
</li>
<li>
<p>
Para el quinto elemento (el tercero de <span class="monospaced">zipWidth</span>), necesitaremos el tercer
y cuarto elementos de <span class="monospaced">fibs</span>, que llegados a este punto ya conocemos porque
los hemos calculado en los pasos anteriores. Y así sucesivamente.
</p>
</li>
</ol></div>
<div class="paragraph"><p>Estos pasos no se ejecutan indefinidamente: se irán ejecutando hasta que se
obtenga el elemento de <span class="monospaced">fibs</span> que se necesite. Es decir, si asignamos <span class="monospaced">fibs</span> a
una variable pero nunca la usamos, el código no se ejecutará en absoluto; si
usamos el valor del tercer elemento de la serie en algún cálculo, sólo se
ejecutarán los dos primeros pasos descritos arriba; etc. En ningún caso se
intenta ejecutar <span class="monospaced">fibs</span> hasta que devuelva «el valor completo».</p></div>
<div class="paragraph"><p>La evaluación perezosa se puede ver como aplicar la técnica de «memorización»
automáticamente a todo el lenguaje. Un posible uso es calcular tablas de
valores que son lentos de calcular: en algunos casos podríamos cargar una tabla
precalculada en memoria, pero el coste puede ser prohibitivo si la tabla es
grande o potencialmente infinita.</p></div>
</div>
<div class="sect2">
<h3 id="_conclusión">Conclusión</h3>
<div class="paragraph"><p>Aprender lenguajes nuevos, especialmente de paradigmas con los que estamos
menos familiarizados, nos puede enseñar muchas cosas sobre programación en
general. Este proceso de aprendizaje nos hará mejores programadores, y muchas
de esas lecciones serán aplicables a todos los lenguajes que conozcamos, no
sólo a los lenguajes similares al que acabemos de aprender. En particular, los
lenguajes funcionales son suficientemente accessibles y similares a los
lenguajes más populares como para enseñarnos muchas lecciones útiles.</p></div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_documentación_activa">Documentación activa</h2>
<div class="sectionbody">
<div class="paragraph"><p><em>Joaquín Caraballo</em></p></div>
<div class="paragraph"><p>Si en un extremo están los que definen el problema a resolver y en el otro los que lo resuelven, ¿cómo podemos asegurarnos de que todos estamos intentando resolver el mismo problema? Y, si aceptamos que la definición va a necesitar ser enriquecida, corregida, matizada, e incluso que el problema a resolver va a cambiar radicalmente durante la vida del proyecto, ¿cómo mantenemos una misma definición para todos los interesados, y más importante, cómo aseguramos que nuestro programa resuelve el problema?</p></div>
<div class="sect2">
<h3 id="_las_pruebas_funcionales">Las pruebas funcionales</h3>
<div class="paragraph"><p>Para tener una cierta confianza en que la aplicación resuelve un cierto problema se llevan a cabo pruebas funcionales; estas resuelven un ejemplo concreto y representativo simulando las acciones del usuario y verificando que la reacción de la aplicación es la esperada.</p></div>
<div class="paragraph"><p>Las pruebas funcionales han de mantenerse al día y evolucionar con los cambios de la aplicación y sus requisitos. Otro de los retos es que sean correctas, es decir, que el comportamiento que estén verificando sea realmente el que se requiere de la aplicación.</p></div>
<div class="paragraph"><p>Es crucial que las pruebas funcionales estén automatizadas; lo típico es escribirlas en el mismo lenguaje de programación de la aplicación. Esto nos permite ejecutar un gran número de ellas de forma sistemática y tras cada cambio, con lo que también nos protegerán de que algo que funcionaba deje de hacerlo, es decir, de posibles <em>regresiones</em>.</p></div>
<div class="sect3">
<h4 id="_neverread">neverread</h4>
<div class="paragraph"><p>Supongamos que tenemos un cliente con falta de tiempo para leer artículos de Internet.</p></div>
<div class="quoteblock">
<div class="content">
<div class="paragraph"><p>-Tantos artículos interesantes, no tengo tiempo para leerlos, pero tampoco puedo ignorarlos. Me gustaría tener una aplicación en la que copiar la dirección del artículo que me interese.</p></div>
<div class="paragraph"><p>-¡Ah!, ¿quieres una aplicación que te permita almacenar enlaces a artículos? La aplicación mantendría una lista con los artículos almacenados, a la que luego podrías acceder cuando tengas tiempo y leer los artículos&#8230;</p></div>
<div class="paragraph"><p>-No, no, si yo lo que quiero es que los enlaces a artículos desaparezcan, si tuviera tiempo para leerlos después usaría instapaper, hombre. Estaría bien que tuviese una lista de artículos por leer siempre vacía, me daría una sensación genial de tenerlo todo bajo control.</p></div>
<div class="paragraph"><p>-Er&#8230; vale.</p></div>
</div>
<div class="attribution">
</div></div>
<div class="paragraph"><p>De la conversación hemos conseguido extraer un criterio de aceptación:</p></div>
<div class="quoteblock">
<div class="content">
<div class="paragraph"><p>Por mucho que añadamos artículos, estos no se añadirán a una lista de artículos por leer.</p></div>
</div>
<div class="attribution">
</div></div>
<div class="paragraph"><p>La prueba funcional correspondiente, verificará que la aplicación cumple el criterio para un ejemplo concreto:</p></div>
<div class="quoteblock">
<div class="content">
<div class="paragraph"><p>Cuando añadimos el artículo <span class="monospaced">art.culo/interesante.html</span>, la lista de artículos por leer permanece vacía.</p></div>
</div>
<div class="attribution">
</div></div>
<div class="paragraph"><p>Las pruebas funcionales, si bien no tienen necesariamente que serlo, se llevan a cabo con frecuencia como pruebas de punta a punta <em>(end to end)</em> (<a href="#goos">[goos]</a> pág 10), es decir, pruebas en las que se ejercita la aplicación en su conjunto y desde afuera, simulando las acciones del usuario y de los sistemas colaboradores, y evaluando la corrección según la perciben usuario y colaboradores.</p></div>
<div class="paragraph"><p>Hemos decidido resolver el problema propuesto con una aplicación web, <em>neverread</em>. Implementaremos en Java una prueba funcional de punta a punta que verifique el criterio de aceptación con una prueba <em>junit</em> que va a iniciar la aplicación y a continuación ejercitarla y evaluarla. Para simular la interacción de un usuario a través de un navegador web utilizaremos Selenium/WebDriver/HtmlUnit:</p></div>
<div class="listingblock">
<div class="content"><!-- Generator: GNU source-highlight 3.1.6
by Lorenzo Bettini
http://www.lorenzobettini.it
http://www.gnu.org/software/src-highlite -->
<pre><tt><span style="font-weight: bold"><span style="color: #0000FF">public</span></span> <span style="font-weight: bold"><span style="color: #0000FF">class</span></span> <span style="color: #008080">ListStaysEmptyTest</span> <span style="color: #FF0000">{</span>
    <span style="font-weight: bold"><span style="color: #0000FF">private</span></span> <span style="color: #008080">WebDriver</span> webDriver<span style="color: #990000">;</span>
    <span style="font-weight: bold"><span style="color: #0000FF">private</span></span> <span style="color: #008080">NeverReadServer</span> neverread<span style="color: #990000">;</span>

    @Test
    <span style="font-weight: bold"><span style="color: #0000FF">public</span></span> <span style="color: #009900">void</span> <span style="font-weight: bold"><span style="color: #000000">articleListStaysEmptyWhenAddingNewArticle</span></span><span style="color: #990000">()</span> <span style="color: #FF0000">{</span>
        webDriver<span style="color: #990000">.</span><span style="font-weight: bold"><span style="color: #000000">findElement</span></span><span style="color: #990000">(</span>By<span style="color: #990000">.</span><span style="font-weight: bold"><span style="color: #000000">name</span></span><span style="color: #990000">(</span><span style="color: #FF0000">"url"</span><span style="color: #990000">)).</span><span style="font-weight: bold"><span style="color: #000000">sendKeys</span></span><span style="color: #990000">(</span><span style="color: #FF0000">"interesting/article.html"</span><span style="color: #990000">,</span> Keys<span style="color: #990000">.</span>ENTER<span style="color: #990000">);</span>
        <span style="font-weight: bold"><span style="color: #000000">assertThat</span></span><span style="color: #990000">(</span>webDriver<span style="color: #990000">.</span><span style="font-weight: bold"><span style="color: #000000">findElements</span></span><span style="color: #990000">(</span>By<span style="color: #990000">.</span><span style="font-weight: bold"><span style="color: #000000">cssSelector</span></span><span style="color: #990000">(</span><span style="color: #FF0000">"li"</span><span style="color: #990000">)).</span><span style="font-weight: bold"><span style="color: #000000">size</span></span><span style="color: #990000">(),</span> <span style="font-weight: bold"><span style="color: #000000">is</span></span><span style="color: #990000">(</span><span style="color: #993399">0</span><span style="color: #990000">));</span>
    <span style="color: #FF0000">}</span>

    @Before
    <span style="font-weight: bold"><span style="color: #0000FF">public</span></span> <span style="color: #009900">void</span> <span style="font-weight: bold"><span style="color: #000000">setUp</span></span><span style="color: #990000">()</span> <span style="font-weight: bold"><span style="color: #0000FF">throws</span></span> Exception <span style="color: #FF0000">{</span>
        neverread <span style="color: #990000">=</span> <span style="font-weight: bold"><span style="color: #0000FF">new</span></span> <span style="font-weight: bold"><span style="color: #000000">NeverReadServer</span></span><span style="color: #990000">();</span>
        neverread<span style="color: #990000">.</span><span style="font-weight: bold"><span style="color: #000000">start</span></span><span style="color: #990000">(</span><span style="color: #993399">8081</span><span style="color: #990000">);</span>

        <span style="color: #008080">WebDriver</span> driver <span style="color: #990000">=</span> <span style="font-weight: bold"><span style="color: #0000FF">new</span></span> <span style="font-weight: bold"><span style="color: #000000">HtmlUnitDriver</span></span><span style="color: #990000">();</span>
        driver<span style="color: #990000">.</span><span style="font-weight: bold"><span style="color: #000000">get</span></span><span style="color: #990000">(</span><span style="color: #FF0000">"http://localhost:8081"</span><span style="color: #990000">);</span>
        webDriver <span style="color: #990000">=</span> driver<span style="color: #990000">;</span>
    <span style="color: #FF0000">}</span>

    @After
    <span style="font-weight: bold"><span style="color: #0000FF">public</span></span> <span style="color: #009900">void</span> <span style="font-weight: bold"><span style="color: #000000">tearDown</span></span><span style="color: #990000">()</span> <span style="font-weight: bold"><span style="color: #0000FF">throws</span></span> Exception <span style="color: #FF0000">{</span>
        webDriver<span style="color: #990000">.</span><span style="font-weight: bold"><span style="color: #000000">close</span></span><span style="color: #990000">();</span>
        neverread<span style="color: #990000">.</span><span style="font-weight: bold"><span style="color: #000000">stop</span></span><span style="color: #990000">();</span>
    <span style="color: #FF0000">}</span>
<span style="color: #FF0000">}</span></tt></pre></div><div class="title">Prueba punta a punta en Java (<a href="https://github.com/emanchado/camino-mejor-programador-codigo/blob/master/active-documentation/src/test-acceptance/purejava/ListStaysEmptyTest.java">purejava/ListStaysEmptyTest.java</a>)</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_documentación_activa_2">Documentación activa</h3>
<div class="paragraph"><p>Si bien podríamos considerar que nuestra prueba funcional en Java es la documentación principal donde se registran los criterios de aceptación; dependiendo de quién vaya a consumirla, esto puede o no ser una opción. Además, conseguir reemplazar la legibilidad de un párrafo en español con una prueba en el lenguaje de programación es todo un reto, particularmente si el lenguaje de programación es tan prolijo como Java.</p></div>
<div class="paragraph"><p>En consecuencia, en la mayoría de los proyectos es necesario documentar los requisitos de manera más textual.</p></div>
<div class="paragraph"><p>Una forma de intentar obtener lo mejor de las dos alternativas es conectar la documentación a la aplicación de tal forma que en todo momento sea automático y evidente verificar el cumplimiento de cada uno de los requisitos expresados, lo que nos ayudará a mantener la documentación sincronizada con la aplicación y con el cliente.</p></div>
<div class="paragraph"><p>La documentación, junto con la capacidad de procesarla para su verificación, servirá así de batería de pruebas funcionales; si ejecutamos esta batería con frecuencia (idealmente con cada cambio) y la mantenemos veraz, estaremos garantizando el correcto funcionamiento de la aplicación&#8230; para la definición especificada.</p></div>
</div>
<div class="sect2">
<h3 id="_concordion">Concordion</h3>
<div class="paragraph"><p>Concordion es una de las herramientas que nos pueden ayudar a conectar la documentación con la aplicación; en Concordion los criterios se escriben en HTML al que se añaden algunas marcas que comienzan con <span class="monospaced">concordion:</span></p></div>
<div class="listingblock">
<div class="content"><!-- Generator: GNU source-highlight 3.1.6
by Lorenzo Bettini
http://www.lorenzobettini.it
http://www.gnu.org/software/src-highlite -->
<pre><tt><span style="font-weight: bold"><span style="color: #0000FF">&lt;p&gt;</span></span>
  When an article is added, the list of unread articles stays empty
<span style="font-weight: bold"><span style="color: #0000FF">&lt;/p&gt;</span></span>

<span style="font-weight: bold"><span style="color: #0000FF">&lt;div</span></span> <span style="color: #009900">class</span><span style="color: #990000">=</span><span style="color: #FF0000">"example"</span><span style="font-weight: bold"><span style="color: #0000FF">&gt;</span></span>
<span style="font-weight: bold"><span style="color: #0000FF">&lt;h3&gt;</span></span>Example<span style="font-weight: bold"><span style="color: #0000FF">&lt;/h3&gt;</span></span>

<span style="font-weight: bold"><span style="color: #0000FF">&lt;p&gt;</span></span>
  When the article
  <span style="font-weight: bold"><span style="color: #0000FF">&lt;b</span></span> <span style="color: #009900">concordion:set</span><span style="color: #990000">=</span><span style="color: #FF0000">"#url"</span><span style="font-weight: bold"><span style="color: #0000FF">&gt;</span></span>interesting/article.html<span style="font-weight: bold"><span style="color: #0000FF">&lt;/b&gt;</span></span>
  is added, the list of unread articles stays
  <span style="font-weight: bold"><span style="color: #0000FF">&lt;b</span></span> <span style="color: #009900">concordion:assertEquals</span><span style="color: #990000">=</span><span style="color: #FF0000">"articleListAfterAdding(#url)"</span><span style="font-weight: bold"><span style="color: #0000FF">&gt;</span></span>empty<span style="font-weight: bold"><span style="color: #0000FF">&lt;/b&gt;</span></span>
<span style="font-weight: bold"><span style="color: #0000FF">&lt;/p&gt;</span></span>
<span style="font-weight: bold"><span style="color: #0000FF">&lt;/div&gt;</span></span></tt></pre></div><div class="title">Primera prueba usando Concordion (<a href="https://github.com/emanchado/camino-mejor-programador-codigo/blob/master/active-documentation/src/test-acceptance/concordion/v1/ListStaysEmpty.html">concordion/v1/ListStaysEmpty.html</a>)</div>
</div>
<div class="paragraph"><p>Vemos que hemos expresado el ejemplo en forma de condición y consecuencia que se debe verificar. Los atributos <span class="monospaced">concordion:set</span> y <span class="monospaced">concordion:assertEquals</span> conectan el documento al método de la clase de respaldo, escrita en Java, <span class="monospaced">String articleListAfterAdding(String url)</span>, que se encargará de hacer lo que dice el texto.</p></div>
<div class="listingblock">
<div class="content"><!-- Generator: GNU source-highlight 3.1.6
by Lorenzo Bettini
http://www.lorenzobettini.it
http://www.gnu.org/software/src-highlite -->
<pre><tt><span style="font-weight: bold"><span style="color: #0000FF">public</span></span> <span style="font-weight: bold"><span style="color: #0000FF">class</span></span> <span style="color: #008080">ListStaysEmptyTest</span> <span style="font-weight: bold"><span style="color: #0000FF">extends</span></span> ConcordionTestCase <span style="color: #FF0000">{</span>
    <span style="font-weight: bold"><span style="color: #0000FF">private</span></span> <span style="color: #008080">WebDriver</span> webDriver<span style="color: #990000">;</span>
    <span style="font-weight: bold"><span style="color: #0000FF">private</span></span> <span style="color: #008080">NeverReadServer</span> neverread<span style="color: #990000">;</span>

    @<span style="font-weight: bold"><span style="color: #000000">SuppressWarnings</span></span><span style="color: #990000">(</span>value <span style="color: #990000">=</span> <span style="color: #FF0000">"unused"</span><span style="color: #990000">)</span>
    <span style="font-weight: bold"><span style="color: #0000FF">public</span></span> <span style="color: #008080">String</span> <span style="font-weight: bold"><span style="color: #000000">articleListAfterAdding</span></span><span style="color: #990000">(</span><span style="color: #008080">String</span> url<span style="color: #990000">)</span> <span style="font-weight: bold"><span style="color: #0000FF">throws</span></span> InterruptedException <span style="color: #FF0000">{</span>
        webDriver<span style="color: #990000">.</span><span style="font-weight: bold"><span style="color: #000000">findElement</span></span><span style="color: #990000">(</span>By<span style="color: #990000">.</span><span style="font-weight: bold"><span style="color: #000000">name</span></span><span style="color: #990000">(</span><span style="color: #FF0000">"url"</span><span style="color: #990000">)).</span><span style="font-weight: bold"><span style="color: #000000">sendKeys</span></span><span style="color: #990000">(</span>url<span style="color: #990000">,</span> Keys<span style="color: #990000">.</span>ENTER<span style="color: #990000">);</span>
        <span style="color: #008080">List&lt;WebElement&gt;</span> pendingArticles <span style="color: #990000">=</span> webDriver<span style="color: #990000">.</span><span style="font-weight: bold"><span style="color: #000000">findElements</span></span><span style="color: #990000">(</span>By<span style="color: #990000">.</span><span style="font-weight: bold"><span style="color: #000000">cssSelector</span></span><span style="color: #990000">(</span><span style="color: #FF0000">"li"</span><span style="color: #990000">));</span>

        <span style="font-weight: bold"><span style="color: #0000FF">return</span></span> <span style="font-weight: bold"><span style="color: #000000">convertListOfArticlesToString</span></span><span style="color: #990000">(</span>pendingArticles<span style="color: #990000">);</span>
    <span style="color: #FF0000">}</span>

    <span style="font-weight: bold"><span style="color: #0000FF">private</span></span> <span style="font-weight: bold"><span style="color: #0000FF">static</span></span> <span style="color: #008080">String</span> <span style="font-weight: bold"><span style="color: #000000">convertListOfArticlesToString</span></span><span style="color: #990000">(</span><span style="color: #008080">List&lt;WebElement&gt;</span> pendingArticles<span style="color: #990000">)</span> <span style="color: #FF0000">{</span>
        <span style="font-weight: bold"><span style="color: #0000FF">if</span></span> <span style="color: #990000">(</span>pendingArticles<span style="color: #990000">.</span><span style="font-weight: bold"><span style="color: #000000">isEmpty</span></span><span style="color: #990000">())</span> <span style="font-weight: bold"><span style="color: #0000FF">return</span></span> <span style="color: #FF0000">"empty"</span><span style="color: #990000">;</span>
        <span style="font-weight: bold"><span style="color: #0000FF">else</span></span> <span style="color: #FF0000">{</span>
            <span style="color: #008080">StringBuilder</span> stringBuilder <span style="color: #990000">=</span> <span style="font-weight: bold"><span style="color: #0000FF">new</span></span> <span style="font-weight: bold"><span style="color: #000000">StringBuilder</span></span><span style="color: #990000">();</span>
            stringBuilder<span style="color: #990000">.</span><span style="font-weight: bold"><span style="color: #000000">append</span></span><span style="color: #990000">(</span>pendingArticles<span style="color: #990000">.</span><span style="font-weight: bold"><span style="color: #000000">get</span></span><span style="color: #990000">(</span><span style="color: #993399">0</span><span style="color: #990000">).</span><span style="font-weight: bold"><span style="color: #000000">getText</span></span><span style="color: #990000">());</span>

            <span style="font-weight: bold"><span style="color: #0000FF">for</span></span> <span style="color: #990000">(</span><span style="color: #009900">int</span> i <span style="color: #990000">=</span> <span style="color: #993399">1</span><span style="color: #990000">;</span> i <span style="color: #990000">&lt;</span> pendingArticles<span style="color: #990000">.</span><span style="font-weight: bold"><span style="color: #000000">size</span></span><span style="color: #990000">();</span> i<span style="color: #990000">++)</span>
                stringBuilder<span style="color: #990000">.</span><span style="font-weight: bold"><span style="color: #000000">append</span></span><span style="color: #990000">(</span><span style="color: #FF0000">", "</span><span style="color: #990000">).</span><span style="font-weight: bold"><span style="color: #000000">append</span></span><span style="color: #990000">(</span>pendingArticles<span style="color: #990000">.</span><span style="font-weight: bold"><span style="color: #000000">get</span></span><span style="color: #990000">(</span>i<span style="color: #990000">).</span><span style="font-weight: bold"><span style="color: #000000">getText</span></span><span style="color: #990000">());</span>

            <span style="font-weight: bold"><span style="color: #0000FF">return</span></span> stringBuilder<span style="color: #990000">.</span><span style="font-weight: bold"><span style="color: #000000">toString</span></span><span style="color: #990000">();</span>
        <span style="color: #FF0000">}</span>
    <span style="color: #FF0000">}</span></tt></pre></div><div class="title">Clase de respaldo de la prueba en Concordion (<a href="https://github.com/emanchado/camino-mejor-programador-codigo/blob/master/active-documentation/src/test-acceptance/concordion/v1/ListStaysEmptyTest.java">purejava/ListStaysEmptyTest.java</a>)</div>
</div>
<div class="paragraph"><p>Al ejecutar <span class="monospaced">ListaPermaneceVaciaTest</span>, Concordion generará un documento HTML con el texto anterior en el que se indicará si se cumple la aserción resaltándola en verde o rojo.</p></div>
<div class="sect3">
<h4 id="_paso_a_paso">Paso a paso</h4>
<div class="paragraph"><p>Veamos qué es lo que está pasando aquí. Hemos escrito el criterio de aceptación en <span class="monospaced">ListaPermaneceVacia.html</span>.  Acompañando al HTML hemos escrito una clase en Java que extiende una clase de infrastructura de Concordion: <span class="monospaced">class ListaPermaneceVaciaTest extends ConcordionTestCase</span>.</p></div>
<div class="paragraph"><p>Cuando ejecutamos <span class="monospaced">ListaPermaneceVaciaTest</span>:</p></div>
<div class="olist arabic"><ol class="arabic">
<li>
<p>
Concordion procesa el HTML.
</p>
</li>
<li>
<p>
Concordion detecta la marca <span class="monospaced">concordion:set="#url"</span> y guarda el contenido de esa marca HTML (en este caso, «art.culo/interesante.html») en la variable de Concordion <span class="monospaced">#url</span>.
</p>
</li>
<li>
<p>
Concordion detecta la marca <span class="monospaced">concordion:assertEquals="articleListAfterAdding(#url)"</span>, por lo que busca en la clase de acompañamiento un método denominado <span class="monospaced">articleListAfterAdding</span> y lo ejecuta, pasándole el contenido de <span class="monospaced">#url</span> como parámetro.
</p>
</li>
<li>
<p>
El método <span class="monospaced">articleListAfterAdding</span> simula la acción de un usuario que introduce <span class="monospaced">url</span> y obtiene la lista de artículos resultante.
</p>
</li>
<li>
<p>
Mediante <span class="monospaced">convertListOfArticlesToString</span>, transformamos la lista producida por WebDriver en una representación textual que pueda ser comparada con el texto del HTML. Hemos decidido que la representación textual de una lista vacía sea «vacía».
</p>
</li>
<li>
<p>
El método <span class="monospaced">articleListAfterAdding</span> retorna, devolviendo una cadena (en este caso «vacía») que es comparada con el contenido de la marca HTML en el que se encontró <span class="monospaced">concordion:assertEquals</span>.
</p>
</li>
<li>
<p>
Concordion termina de procesar el documento HTML y genera otro HTML en el que el texto que tiene la marca <span class="monospaced">concordion:assertEquals</span> está resaltado en verde, para indicar que la aserción se cumple.
</p>
</li>
</ol></div>
</div>
<div class="sect3">
<h4 id="_manteniendo_el_nivel_de_abstracción_apropiado">Manteniendo el nivel de abstracción apropiado</h4>
<div class="paragraph"><p>Es importante esforzarse en describir el funcionamiento de la aplicación en términos del dominio. Por ejemplo, podríamos haber caído en la tentación de escribir el ejemplo como <em>Cuando el usuario entra una cadena en la caja de texto y pulsa enter, la lista de artículos está vacía</em>. Sin embargo, eso sería perjudicial porque nos alejaría de la persona que define lo que debe hacer la aplicación y resultaría más <em>frágil</em>, es decir, en cuanto decidiéramos cambiar la implementación, por ejemplo, supongamos que las direcciones se introducen arrastrándolas a una zona de la aplicación, tendríamos que reescribir el documento.</p></div>
<div class="paragraph"><p>A poco que la documentación activa crezca, las clases de respaldo van a necesitar una cantidad importante de código. Algunas abstracciones pueden ayudarnos reducir la repetición y la fragilidad de las clases de respaldo.</p></div>
<div class="paragraph"><p>Podemos hacer que la clase de respaldo sólo <em>hable</em> en el lenguaje del dominio, para lo cual hemos de desarrollar un lenguaje dedicado, con lo que el método quedaría algo así:</p></div>
<div class="listingblock">
<div class="content"><!-- Generator: GNU source-highlight 3.1.6
by Lorenzo Bettini
http://www.lorenzobettini.it
http://www.gnu.org/software/src-highlite -->
<pre><tt><span style="font-weight: bold"><span style="color: #0000FF">public</span></span> <span style="color: #008080">String</span> <span style="font-weight: bold"><span style="color: #000000">articleListAfterAdding</span></span><span style="color: #990000">(</span><span style="color: #008080">String</span> article<span style="color: #990000">)</span> <span style="font-weight: bold"><span style="color: #0000FF">throws</span></span> InterruptedException <span style="color: #FF0000">{</span>
    driver<span style="color: #990000">.</span><span style="font-weight: bold"><span style="color: #000000">addArticle</span></span><span style="color: #990000">(</span>article<span style="color: #990000">);</span>
    <span style="font-weight: bold"><span style="color: #0000FF">return</span></span> <span style="font-weight: bold"><span style="color: #000000">convertListOfArticlesToString</span></span><span style="color: #990000">(</span>driver<span style="color: #990000">.</span><span style="font-weight: bold"><span style="color: #000000">getListOfArticles</span></span><span style="color: #990000">());</span>
<span style="color: #FF0000">}</span></tt></pre></div><div class="title">Método de respaldo usando lenguaje del dominio (<a href="https://github.com/emanchado/camino-mejor-programador-codigo/blob/master/active-documentation/src/test-acceptance/concordion/v2_appdriver/ListStaysEmptyTest.java">concordion/v2_appdriver/ListStaysEmptyTest.java</a>)</div>
</div>
<div class="paragraph"><p>Otra posibilidad es abstraer la página web en términos de los elementos del entorno gráfico, es decir, que hable de elementos visuales de la página.</p></div>
<div class="listingblock">
<div class="content"><!-- Generator: GNU source-highlight 3.1.6
by Lorenzo Bettini
http://www.lorenzobettini.it
http://www.gnu.org/software/src-highlite -->
<pre><tt><span style="font-weight: bold"><span style="color: #0000FF">public</span></span> <span style="color: #008080">String</span> <span style="font-weight: bold"><span style="color: #000000">articleListAfterAdding</span></span><span style="color: #990000">(</span><span style="color: #008080">String</span> url<span style="color: #990000">)</span> <span style="font-weight: bold"><span style="color: #0000FF">throws</span></span> InterruptedException <span style="color: #FF0000">{</span>
    page<span style="color: #990000">.</span><span style="font-weight: bold"><span style="color: #000000">enterIntoNewArticlesTextBox</span></span><span style="color: #990000">(</span>url<span style="color: #990000">);</span>
    <span style="color: #008080">List&lt;String&gt;</span> pendingArticles <span style="color: #990000">=</span> page<span style="color: #990000">.</span><span style="font-weight: bold"><span style="color: #000000">getArticlesInListOfArticles</span></span><span style="color: #990000">();</span>

    <span style="font-weight: bold"><span style="color: #0000FF">return</span></span> <span style="font-weight: bold"><span style="color: #000000">convertListOfArticlesToString</span></span><span style="color: #990000">(</span>pendingArticles<span style="color: #990000">);</span>
<span style="color: #FF0000">}</span></tt></pre></div><div class="title">Método de respaldo usando lenguaje del entorno gráfico (<a href="https://github.com/emanchado/camino-mejor-programador-codigo/blob/master/active-documentation/src/test-acceptance/concordion/v3_pagedriver/ListStaysEmptyTest.java">concordion/v3_pagedriver/ListaStaysEmptyTest.java</a>)</div>
</div>
<div class="paragraph"><p>La capa de abstracción en términos de lenguaje del dominio es la opción más <em>pura</em>, pero dependiendo del proyecto podremos preferir una capa que se exprese en términos gráficos o ambas, dependiendo de la complejidad del proyecto y de cuán involucrado esté el cliente en los detalles gráficos.</p></div>
</div>
</div>
<div class="sect2">
<h3 id="_pruebas_asíncronas">Pruebas asíncronas</h3>
<div class="paragraph"><p>En las secciones anteriores nos hemos permitido hacer un poco <em>trampas</em> que deberíamos descubrir antes de cerrar el artículo. Supongamos que el desarrollador, al escribir el código de la aplicación comete una equivocación por no entender debidamente lo que necesita el cliente; decide hacer una aplicación que <em>añade</em> los artículos a una lista de artículos a leer.  Nuestras pruebas funcionales deberían detectar este error marcando la aserción en rojo. Sin embargo, nos encontramos con que la pruebas pasan.</p></div>
<div class="paragraph"><p>Evidentemente, nuestras pruebas funcionales no son correctas, esto se debe a que estamos verificando que el estado de la lista de artículos es el mismo después de entrar el nuevo artículo que antes de entrarlo, y la prueba verifica la condición antes de que la aplicación tenga tiempo de añadir erróneamente artículos a la lista.</p></div>
<div class="paragraph"><p>Probar sistemas asíncronos es lo suficientemente complejo como para justificar un artículo en sí mismo, pero si enumeramos algunas de las opciones, de más rápidas y sencillas de implementar a menos, tenemos:</p></div>
<div class="olist arabic"><ol class="arabic">
<li>
<p>
Probamos sólo la parte síncrona del sistema. Esto hace las pruebas más sencillas y rápidas a costa de reducir el alcance.
</p>
</li>
<li>
<p>
Introducimos puntos de sincronización. Volveremos a este en un segundo.
</p>
</li>
<li>
<p>
Verificamos periódicamente la aserción hasta que se cumpla o se agote el tiempo de espera. En esta opción es crucial ajustar la duración, si esperamos demasiado las pruebas tardarán demasiado innecesariamente, si esperamos demasiado poco tendremos falsos negativos.
</p>
</li>
</ol></div>
<div class="paragraph"><p>En nuestro ejemplo sabemos que, cada vez que la aplicación responde a la entrada de un nuevo artículo, lo último que hace es borrar la caja de texto. Por lo tanto, podemos utilizar este evento como punto de sincronización, es decir, antes de verificar que la lista permanece vacía esperaremos a que la caja se haya borrado.</p></div>
<div class="listingblock">
<div class="content"><!-- Generator: GNU source-highlight 3.1.6
by Lorenzo Bettini
http://www.lorenzobettini.it
http://www.gnu.org/software/src-highlite -->
<pre><tt><span style="font-weight: bold"><span style="color: #0000FF">public</span></span> <span style="color: #009900">void</span> <span style="font-weight: bold"><span style="color: #000000">addArticle</span></span><span style="color: #990000">(</span><span style="color: #008080">String</span> url<span style="color: #990000">)</span> <span style="color: #FF0000">{</span>
    webDriver<span style="color: #990000">.</span><span style="font-weight: bold"><span style="color: #000000">findElement</span></span><span style="color: #990000">(</span>By<span style="color: #990000">.</span><span style="font-weight: bold"><span style="color: #000000">name</span></span><span style="color: #990000">(</span><span style="color: #FF0000">"url"</span><span style="color: #990000">)).</span><span style="font-weight: bold"><span style="color: #000000">sendKeys</span></span><span style="color: #990000">(</span>url<span style="color: #990000">,</span> Keys<span style="color: #990000">.</span>ENTER<span style="color: #990000">);</span>

    <span style="font-weight: bold"><span style="color: #0000FF">new</span></span> <span style="font-weight: bold"><span style="color: #000000">WebDriverWait</span></span><span style="color: #990000">(</span>webDriver<span style="color: #990000">,</span> <span style="color: #993399">2</span><span style="color: #990000">).</span><span style="font-weight: bold"><span style="color: #000000">until</span></span><span style="color: #990000">(</span><span style="font-weight: bold"><span style="color: #0000FF">new</span></span> ExpectedCondition<span style="color: #990000">&lt;</span>Object<span style="color: #990000">&gt;()</span> <span style="color: #FF0000">{</span>
        @Override
        <span style="font-weight: bold"><span style="color: #0000FF">public</span></span> <span style="color: #008080">Object</span> <span style="font-weight: bold"><span style="color: #000000">apply</span></span><span style="color: #990000">(</span><span style="color: #008080">WebDriver</span> webDriver<span style="color: #990000">)</span> <span style="color: #FF0000">{</span>
            <span style="font-weight: bold"><span style="color: #0000FF">return</span></span> <span style="color: #FF0000">""</span><span style="color: #990000">.</span><span style="font-weight: bold"><span style="color: #000000">equals</span></span><span style="color: #990000">(</span>webDriver<span style="color: #990000">.</span><span style="font-weight: bold"><span style="color: #000000">findElement</span></span><span style="color: #990000">(</span>By<span style="color: #990000">.</span><span style="font-weight: bold"><span style="color: #000000">name</span></span><span style="color: #990000">(</span><span style="color: #FF0000">"url"</span><span style="color: #990000">)).</span><span style="font-weight: bold"><span style="color: #000000">getAttribute</span></span><span style="color: #990000">(</span><span style="color: #FF0000">"value"</span><span style="color: #990000">));</span>
        <span style="color: #FF0000">}</span>
    <span style="color: #FF0000">}</span><span style="color: #990000">);</span>
<span style="color: #FF0000">}</span>

<span style="font-weight: bold"><span style="color: #0000FF">public</span></span> <span style="color: #008080">List&lt;String&gt;</span> <span style="font-weight: bold"><span style="color: #000000">getListOfArticles</span></span><span style="color: #990000">()</span> <span style="color: #FF0000">{</span>
    <span style="font-weight: bold"><span style="color: #0000FF">return</span></span> <span style="font-weight: bold"><span style="color: #000000">webElementsToTheirTexts</span></span><span style="color: #990000">(</span>webDriver<span style="color: #990000">.</span><span style="font-weight: bold"><span style="color: #000000">findElements</span></span><span style="color: #990000">(</span>By<span style="color: #990000">.</span><span style="font-weight: bold"><span style="color: #000000">cssSelector</span></span><span style="color: #990000">(</span><span style="color: #FF0000">"li"</span><span style="color: #990000">)));</span>
<span style="color: #FF0000">}</span></tt></pre></div><div class="title">Ejemplo de punto de sincronización (<a href="https://github.com/emanchado/camino-mejor-programador-codigo/blob/master/active-documentation/src/test-acceptance/concordion/v5_with_synchronisation/tools/NeverReadDriver.java">concordion/v5_with_synchronisation/tools/NeverReadDriver.java</a>)</div>
</div>
</div>
<div class="sect2">
<h3 id="_conclusión_2">Conclusión</h3>
<div class="paragraph"><p>La <em>documentación activa</em> es una forma de probar funcionalmente un programa en el que cada criterio de aceptación se enuncia con un texto que se enlaza a la ejecución de código que verifica el criterio. Al ejecutarla, se produce un resultado que indica, de forma legible para los expertos del dominio, qué criterios de aceptación cumple el programa y qué criterios no cumple. Como casi todo, su uso debería adaptarse a la composición del equipo y la complejidad del proyecto.</p></div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_siete_problemas_al_probar_programas">Siete problemas al probar programas</h2>
<div class="sectionbody">
<div class="paragraph"><p><em>Esteban Manchado Velázquez</em></p></div>
<div class="paragraph"><p>La mayoría de los profesionales de la informática coincidirán en que probar es
una de las tareas fundamentales del desarrollo, pero si ya es difícil aprender
técnicas de programación, mucho más difícil es aprender técnicas de pruebas,
tanto manuales como automáticas. Primero, porque desgraciadamente es un
conocimiento menos extendido. Segundo, porque es aún más abstracto que la
programación.</p></div>
<div class="paragraph"><p>Por ello, todos los consejos y la experiencia compartida de los que nos podamos
aprovechar son especialmente importantes. Los siguientes problemas están
centrados en las pruebas automáticas, pero muchos de ellos ocurren también al
hacer pruebas manuales. Están ordenados por experiencia: el primer problema
aparece principalmente en equipos que nunca han escrito pruebas, y el último lo
tienen incluso desarrolladores con años de experiencia.</p></div>
<div class="paragraph"><p>Como todo, hay que aplicar las soluciones propuestas entendiendo por qué, cómo
y cuándo son aplicables y útiles, nunca siguiéndolas ciegamente en todas las
situaciones.</p></div>
<div class="sect2">
<h3 id="_dejar_las_pruebas_para_el_final">Dejar las pruebas para el final</h3>
<div class="paragraph"><p>Aunque es normal que al acercarse el final de cada ciclo de desarrollo se
intensifique el esfuerzo de pruebas (especialmente las manuales), es un error
mayúsculo no haber probado desde el principio del desarrollo. Esto no es un
tópico o una consideración teórica o académica: no probar desde el principio
del ciclo de desarrollo tiene muchas desventajas. Por ejemplo:</p></div>
<div class="olist arabic"><ol class="arabic">
<li>
<p>
El esfuerzo mental de probar un programa grande es mucho mayor que el
esfuerzo de probar un programa pequeño. No se sabe por dónde empezar, es
difícil saber cuándo terminar, y es fácil quedarse con la sensación de que no
todo está probado correctamente. Si probamos los componentes que vamos creando
desde el principio, es mucho más fácil saber cómo atacar el problema y hacer
pruebas más completas.
</p>
</li>
<li>
<p>
Si probamos mientras escribimos código y sabemos el nivel de calidad de
éste, será más fácil hacer estimaciones sobre los recursos necesarios para
terminar el resto del trabajo. Esto nos dará mucha más flexibilidad para
renegociar fechas o las características que se tendrán que quedar fuera, en vez
de pasar al estado de alarma cuando nos demos cuenta, demasiado tarde, de que
no tenemos tiempo de arreglar los fallos que encontremos los últimos días.
</p>
</li>
<li>
<p>
Cuando hemos «terminado» un proyecto y sólo queda probar, es normal tener la
tendencia a «no querer ver fallos» o restarles importancia, a que nos inunde
un falso optimismo que confirme que de verdad hemos terminado y no queda nada
por hacer. Sobre todo si quedan pocos días hasta la entrega y sentimos que no
podemos hacer gran cosa, y sólo queremos entregar el resultado y olvidarnos del
proyecto. Esto ocurre mucho menos si tenemos a profesionales exclusivamente
dedicados a las pruebas, claro.
</p>
</li>
<li>
<p>
Probar desde el principio significa que estaremos probando durante más
tiempo, por lo que habremos encontrado más casos que puedan ser problemáticos,
y por tanto más fallos (y las soluciones a éstos), antes de que sea demasiado
tarde.
</p>
</li>
<li>
<p>
Todas las pruebas que hagamos pronto ayudarán a aumentar la calidad del
código, lo que no sólo afecta a la calidad final del producto, sino a lo fácil
que es escribir y depurar cualquier otro código que dependa del primero. Los
fallos de interacción entre las dos bases de código serán más fáciles de
encontrar y, en particular, la fuente de los errores.
</p>
</li>
<li>
<p>
Si desde el principio escribimos pruebas automáticas, nos obligaremos a
nosotros mismos a escribir APIs más limpias. Generalmente, código más fácil de
probar es código más desacoplado, más limpio y más estable. Indudablemente, una
de las ventajas de escribir pruebas automáticas es que ayudan a mantener un
diseño de mayor calidad. Pero si no probamos desde el principio, perdemos esta
ventaja.
</p>
</li>
<li>
<p>
Al no probar desde el principio, desarrollaremos código que no es
especialmente fácil de probar, y cuanto más tarde empecemos a adaptar el código
para que lo sea, más esfuerzo costará. Una vez hayamos escrito una gran
cantidad de código sin tener en cuenta si es fácil de probar o no, la tentación
de dejar muchas partes sin pruebas será irresistible. Y, por supuesto, si no
hacemos el esfuerzo de adaptar el código en ese momento, entraremos en un
círculo vicioso.
</p>
</li>
</ol></div>
<div class="paragraph"><p>Como tarde o temprano se tendrá que probar el resultado del trabajo, mejor
empezar temprano porque es menos costoso (en tiempo y esfuerzo mental) y los
resultados son mejores. Escribir código sin probar es simplemente irresponsable
y una falta de respeto con respecto a los usuarios del producto <em>y</em> al resto de
los miembros del equipo, especialmente los que tengan que mantener el código
después y cualquier miembro del equipo que use directa o indirectamente el
código sin probar.</p></div>
</div>
<div class="sect2">
<h3 id="_ser_demasiado_específico_en_las_comprobaciones">Ser demasiado específico en las comprobaciones</h3>
<div class="paragraph"><p>Esto es un problema bastante común, sobre todo cuando se empiezan a hacer
pruebas. Las pruebas automáticas son, de alguna manera, una descripción de lo
que se espera que el programa haga. Una especificación en código, por así
decirlo. Como tal, sólo debe describir el comportamiento que esperamos que no
cambie. Si somos demasiado específicos o exigentes en las comprobaciones de
nuestras pruebas, éstas no sólo evitarán que introduzcamos fallos en el código,
sino también que podamos hacer otro tipo de cambios.</p></div>
<div class="paragraph"><p>Por ejemplo, digamos que estamos escribiendo una aplicación de tareas
pendientes muy sencilla. La clase que representa una lista de tareas se llama
BrownList, y podría tener una pinta así en Ruby:</p></div>
<div class="listingblock">
<div class="content"><!-- Generator: GNU source-highlight 3.1.6
by Lorenzo Bettini
http://www.lorenzobettini.it
http://www.gnu.org/software/src-highlite -->
<pre><tt><span style="font-weight: bold"><span style="color: #0000FF">class</span></span> BrownList
  <span style="font-weight: bold"><span style="color: #0000FF">def</span></span> initialize<span style="color: #990000">(</span>db<span style="color: #990000">)</span>
    <span style="font-style: italic"><span style="color: #9A1900"># ...</span></span>
  <span style="font-weight: bold"><span style="color: #0000FF">end</span></span>

  <span style="font-weight: bold"><span style="color: #0000FF">def</span></span> add_brown<span style="color: #990000">(</span>title<span style="color: #990000">)</span>
    <span style="font-style: italic"><span style="color: #9A1900"># Insertamos en una base de datos, devolvemos un id</span></span>
  <span style="font-weight: bold"><span style="color: #0000FF">end</span></span>

  <span style="font-weight: bold"><span style="color: #0000FF">def</span></span> mark_brown_done<span style="color: #990000">(</span>id<span style="color: #990000">)</span>
    <span style="font-style: italic"><span style="color: #9A1900"># Marcamos el id dado como hecho</span></span>
  <span style="font-weight: bold"><span style="color: #0000FF">end</span></span>

  <span style="font-weight: bold"><span style="color: #0000FF">def</span></span> pending_browns
    <span style="font-style: italic"><span style="color: #9A1900"># Devolvemos una lista de las tareas pendientes</span></span>
  <span style="font-weight: bold"><span style="color: #0000FF">end</span></span>
<span style="font-weight: bold"><span style="color: #0000FF">end</span></span>

<span style="font-style: italic"><span style="color: #9A1900"># Se usa así</span></span>
bl <span style="color: #990000">=</span> BrownList<span style="color: #990000">.</span>new<span style="color: #990000">(</span>db_handle<span style="color: #990000">)</span>
id <span style="color: #990000">=</span> bl<span style="color: #990000">.</span>add_brown<span style="color: #990000">(</span><span style="color: #FF0000">"Tarea pendiente"</span><span style="color: #990000">)</span>
bl<span style="color: #990000">.</span>mark_brown_done<span style="color: #990000">(</span>id<span style="color: #990000">)</span>
lista_tareas_pendientes <span style="color: #990000">=</span> bl<span style="color: #990000">.</span>pending_browns</tt></pre></div><div class="title">Ejemplo de implementación de la clase <span class="monospaced">BrownList</span></div>
</div>
<div class="paragraph"><p>Ahora, para probar que el método <span class="monospaced">add_brown</span> funciona, puede que se nos ocurra
conectarnos a la base de datos y comprobar si tiene la fila correcta. En la
gran mayoría de los casos esto es un error. Para entender por qué, hay que
darse cuenta de que las pruebas definen <em>qué</em> significa que el código funcione.
Así, si las pruebas usan detalles de la implementación, se estará definiendo de
manera implícita que el programa sólo «funciona bien» si mantiene los mismos
detalles de implementación. Lo cual es, naturalmente, un error, porque no
permite que el código evolucione.</p></div>
<div class="listingblock">
<div class="content"><!-- Generator: GNU source-highlight 3.1.6
by Lorenzo Bettini
http://www.lorenzobettini.it
http://www.gnu.org/software/src-highlite -->
<pre><tt><span style="font-weight: bold"><span style="color: #0000FF">class</span></span> TestBrownList <span style="color: #990000">&lt;</span> Test<span style="color: #990000">::</span>Unit<span style="color: #990000">::</span>TestCase
  <span style="font-weight: bold"><span style="color: #0000FF">def</span></span> setup
    <span style="font-style: italic"><span style="color: #9A1900"># Recreamos la base de datos de pruebas para que esté vacía</span></span>
  <span style="font-weight: bold"><span style="color: #0000FF">end</span></span>

  <span style="font-weight: bold"><span style="color: #0000FF">def</span></span> test_add_brown_simple_____MAL
    db_handle <span style="color: #990000">=</span> <span style="color: #990000">...</span>
    bl <span style="color: #990000">=</span> BrownList<span style="color: #990000">.</span>new<span style="color: #990000">(</span>db_handle<span style="color: #990000">)</span>
    bl<span style="color: #990000">.</span>add_brown<span style="color: #990000">(</span><span style="color: #FF0000">"Tarea de prueba"</span><span style="color: #990000">)</span>

    count <span style="color: #990000">=</span> db_handle<span style="color: #990000">.</span>execute<span style="color: #990000">(</span><span style="color: #FF0000">"SELECT COUNT(*) FROM browns"</span><span style="color: #990000">)</span>
    assert_equal <span style="color: #993399">1</span><span style="color: #990000">,</span> count
  <span style="font-weight: bold"><span style="color: #0000FF">end</span></span>
<span style="font-weight: bold"><span style="color: #0000FF">end</span></span></tt></pre></div><div class="title"><em>Mal</em> ejemplo de prueba del método <span class="monospaced">add_brown</span> de <span class="monospaced">BrownList</span></div>
</div>
<div class="paragraph"><p>En este ejemplo concreto, hay muchos casos en los que esta prueba fallaría, a
pesar de que el código podría estar funcionando perfectamente:</p></div>
<div class="ulist"><ul>
<li>
<p>
El nombre de la tabla donde guardamos las tareas cambia
</p>
</li>
<li>
<p>
Añadimos la característica multiusuario, por lo que podría haber más tareas
  en esa tabla de las que queremos contar
</p>
</li>
<li>
<p>
Decidimos que vamos a usar una base de datos no-SQL, por lo que la manera de
  contar cambiaría
</p>
</li>
<li>
<p>
Añadimos un paso intermedio de algún tipo, de tal manera que las tareas no se
  crearían inicialmente en la base de datos, sino en algo como <em>memcached</em>, y
  unos segundos después irían a la base de datos
</p>
</li>
</ul></div>
<div class="paragraph"><p>Las pruebas no deben limitarnos cuando reorganizamos código o cambiamos
detalles de implementación. De hecho, una de las ventajas de tener pruebas
automáticas es que cuando reorganicemos código, sabremos si estamos haciendo
algo mal porque las pruebas fallarán. Si no estamos seguros de que cuando una
prueba falla es porque hay un problema en el código, nuestras pruebas no nos
están ayudando. Al menos, no todo lo que deberían.</p></div>
<div class="paragraph"><p>Lo que queremos comprobar en la prueba es, realmente, si hay una nueva tarea
añadida. Una manera de probarlo es usar el método <span class="monospaced">pending_browns</span>.  Uno podría
pensar que no es una buena idea porque, si hay un error en <span class="monospaced">add_brown</span> y otro
en <span class="monospaced">pending_browns</span> que se cancelen mutuamente, las pruebas pasarán igualmente.
Eso es verdad, pero en la mayoría de los casos <em>no importa</em>, porque desde el
punto de vista del usuario de la clase, ésta se comporta como debería. Cuando
descubramos el fallo, lo podremos arreglar no sólo sin tener que cambiar las
pruebas o el código que llama a <span class="monospaced">BrownList</span>, sino sin que haya habido ningún
cambio en el comportamiento de <span class="monospaced">BrownList</span> desde el punto de vista de los
usuarios.</p></div>
<div class="listingblock">
<div class="content"><!-- Generator: GNU source-highlight 3.1.6
by Lorenzo Bettini
http://www.lorenzobettini.it
http://www.gnu.org/software/src-highlite -->
<pre><tt><span style="font-weight: bold"><span style="color: #0000FF">class</span></span> TestBrownList <span style="color: #990000">&lt;</span> Test<span style="color: #990000">::</span>Unit<span style="color: #990000">::</span>TestCase
  <span style="font-weight: bold"><span style="color: #0000FF">def</span></span> setup
    <span style="font-style: italic"><span style="color: #9A1900"># Recreamos la base de datos de pruebas para que esté vacía</span></span>
  <span style="font-weight: bold"><span style="color: #0000FF">end</span></span>

  <span style="font-weight: bold"><span style="color: #0000FF">def</span></span> test_add_brown_simple
    db_handle <span style="color: #990000">=</span> <span style="color: #990000">...</span>
    bl <span style="color: #990000">=</span> BrownList<span style="color: #990000">.</span>new<span style="color: #990000">(</span>db_handle<span style="color: #990000">)</span>
    bl<span style="color: #990000">.</span>add_brown<span style="color: #990000">(</span><span style="color: #FF0000">"Tarea de prueba"</span><span style="color: #990000">)</span>

    assert_equal <span style="color: #993399">1</span><span style="color: #990000">,</span> bl<span style="color: #990000">.</span>pending_browns<span style="color: #990000">.</span>length
  <span style="font-weight: bold"><span style="color: #0000FF">end</span></span>
<span style="font-weight: bold"><span style="color: #0000FF">end</span></span></tt></pre></div><div class="title">Mejor ejemplo de prueba del método <span class="monospaced">add_brown</span> de <span class="monospaced">BrownList</span></div>
</div>
<div class="paragraph"><p>Para terminar de ilustrar este consejo, imaginemos ahora que escribimos una
interfaz web para nuestra aplicación de tareas pendientes. Si queremos
comprobar que la interfaz web funciona correctamente, una (mala) idea que puede
pasarnos por la cabeza es comparar el HTML de la página con el HTML que
esperamos.  Si comparamos el HTML completo (o una captura de pantalla),
nuestras pruebas serán muy, muy frágiles. Por ejemplo, nuestras pruebas
fallarán cuando hagamos cualquiera de estos cambios:</p></div>
<div class="ulist"><ul>
<li>
<p>
Cambiar el id de algún elemento o el nombre de alguna clase CSS
</p>
</li>
<li>
<p>
Cambiar un elemento de sitio o intercambiar la posición de dos opciones en un
  menú
</p>
</li>
<li>
<p>
Añadir una nueva opción o información extra
</p>
</li>
<li>
<p>
Corregir una falta de ortografía o redactar un texto de forma diferente
</p>
</li>
</ul></div>
<div class="paragraph"><p>Si nuestras pruebas comparan la salida HTML exacta, implícitamente estamos
definiendo nuestra aplicación no como una aplicación web con ciertas
características, sino como una aplicación que genera ciertas cadenas de HTML.
Ya que al usuario no le importa el HTML generado, sino que la aplicación
funcione, podemos ver que este enfoque no es el más apropiado.</p></div>
<div class="paragraph"><p>Una forma mucho mejor de probar una aplicación web es <em>buscar</em> las partes
interesantes. Por ejemplo, comprobar que el título de la nueva tarea aparece en
el contenido de la página justo después de crearla. O comprobar que ya no está
ahí después de borrarla. O comprobar que, al renombrar una tarea, el título
antiguo ya no aparece, pero sí el nuevo. Sin embargo, hacer esas comprobaciones
directamente puede ser tedioso y puede añadir algo de fragilidad a nuestras
pruebas, por lo que lo mejor es desacoplar los detalles del HTML generado de
las comprobaciones que queremos hacer. Una de las técnicas para conseguir esto
se conoce como <em>PageObjects</em>, pero explorar <em>PageObjects</em> va mucho más allá del
objetivo de este artículo.</p></div>
<div class="paragraph"><p>Como resumen de este consejo, podemos decir que las <em>pruebas no sólo deben
fallar cuando hay algún problema, sino que también deben pasar mientras no haya
ninguno</em>.</p></div>
</div>
<div class="sect2">
<h3 id="_no_ejecutarlas_con_frecuencia">No ejecutarlas con frecuencia</h3>
<div class="paragraph"><p>Las pruebas no son un añadido al código, son parte integrante de éste.
Asimismo, ejecutarlas es parte del ciclo normal de desarrollo. Si no las
ejecutamos con frecuencia, no van a ser tan efectivas. Primero, porque cuando
haya fallos, es probable que sea más de uno. En ese caso, será más difícil
encontrar el origen de éstos. ¿Es un solo error el que provoca todos los fallos
en las pruebas, uno por cada prueba? Segundo, porque si hemos hecho muchos
cambios desde la última vez que ejecutamos las pruebas, tendremos más código
que revisar en busca del problema.</p></div>
<div class="paragraph"><p>Ejecutar las pruebas con frecuencia (idealmente, después de cada cambio que
hacemos) hace que sea muy fácil encontrar la causa del error, porque lo único
que puede haber sido la causa de los fallos son los cambios desde la última vez
que las ejecutamos. Si ejecutamos las pruebas antes de mandar nuestros cambios
al control de versiones, y vemos que una de las pruebas falla, será suficiente
ejecutar <span class="monospaced">git diff</span> (o <span class="monospaced">svn diff</span> o similar) para ver qué cambios deben de
haber producido el problema. Además, cuanto más alta sea la frecuencia con la
que ejecutemos las pruebas, más seguros estaremos de que el código funciona
correctamente. En la medida de lo posible, en el mundo de la programación es
mejor evitar la fé: trabajaremos más tranquilos y con más confianza si podemos
demostrar que el código funciona en los casos cubiertos por las pruebas.</p></div>
<div class="paragraph"><p>El último punto importante de este consejo es tener una máquina «neutral» que
ejecute las pruebas automáticas que tengamos, <em>cada vez que alguien manda un
cambio al control de versiones</em>. Las ventajas son muchas:</p></div>
<div class="ulist"><ul>
<li>
<p>
Incluso si alguien se olvida de ejecutar las pruebas antes de enviar los
  cambios, tenemos garantizado que las pruebas se ejecutarán.
</p>
</li>
<li>
<p>
Si alguien se olvida de añadir un fichero al control de versiones, ese
  fichero no aparecerá en la máquina de integración continua, por lo que las
  pruebas fallarán y nos daremos cuenta del error.
</p>
</li>
<li>
<p>
Los resultados de las pruebas en la máquina de integración continua son más
  fiables, porque tiene la misma configuración que las máquinas de producción.
  Por ejemplo, si un programador escribe una nueva prueba que depende de un
  nuevo módulo o de un cambio de configuración que sólo existe en la máquina de
  ese programador, la prueba pasará en su máquina, pero fallará en integración
  continua. Este fallo nos avisará del problema antes de que el proyecto pase a
  producción.
</p>
</li>
<li>
<p>
Como tenemos los resultados de las pruebas para cada cambio que se haya
  hecho, y ejecutados en la misma máquina, podemos saber qué cambio exacto
  produjo el problema, lo que hace mucho más fácil arreglarlo.
</p>
</li>
</ul></div>
<div class="paragraph"><p>Véase el artículo de Martin Fowler <a href="#fowlerci">[fowlerci]</a> sobre integración continua para
más información.</p></div>
</div>
<div class="sect2">
<h3 id="_no_controlar_el_entorno">No controlar el entorno</h3>
<div class="paragraph"><p>Otro problema bastante común es escribir pruebas sin controlar el entorno en el
que se ejecutan. En parte esta (mala) costumbre viene de la creencia de que las
pruebas tienen que adaptarse a diferentes circunstancias y ser robustas como
los programas que escribimos. Esto es un malentendido.</p></div>
<div class="paragraph"><p>Volvamos al ejemplo anterior de la aplicación de tareas pendientes. Cuando
escribimos las pruebas, los pasos <em>no</em> fueron:</p></div>
<div class="olist arabic"><ol class="arabic">
<li>
<p>
Obtener el número de tareas actuales, llamarlo <em>n</em>
</p>
</li>
<li>
<p>
Añadir una tarea
</p>
</li>
<li>
<p>
Comprobar que el número de tareas actuales es <em>n</em> + 1
</p>
</li>
</ol></div>
<div class="paragraph"><p>Los pasos fueron:</p></div>
<div class="olist arabic"><ol class="arabic">
<li>
<p>
Dejar la base de datos en un estado conocido (en este caso, vacía)
</p>
</li>
<li>
<p>
Añadir una tarea
</p>
</li>
<li>
<p>
Comprobar que el número de tareas es <em>exactamente</em> 1
</p>
</li>
</ol></div>
<div class="paragraph"><p>Esta diferencia es fundamental. Uno podría pensar que la primera prueba es
mejor porque «funciona en más casos». Sin embargo, esto es un error por las
siguientes razones:</p></div>
<div class="ulist"><ul>
<li>
<p>
Escribir código robusto requiere mucho más esfuerzo mental, especialmente a
  medida que crecen las posibilidades. Como no necesitamos esa robustez, mejor
  dejarla de lado.
</p>
</li>
<li>
<p>
Las pruebas serán menos flexibles, porque no podremos probar qué ocurre en
  casos específicos (p.ej. cuando hay exactamente 20 tareas, cuando hay más de
  100 tareas, etc.).
</p>
</li>
<li>
<p>
Si no controlamos y rehacemos el entorno de ejecución de las pruebas, unas
  pruebas dependerán, potencialmente, de otras. Lo que significa que el
  comportamiento de unas pruebas puede cambiar el resultado de otras. En el
  caso ideal, que es el caso común, las pruebas se pueden ejecutar una a una
  independientemente y tienen exactamente el mismo resultado.
</p>
</li>
<li>
<p>
No siempre darán el mismo resultado, incluso cuando las ejecutemos por sí
  solas. Por ejemplo, digamos que hay un fallo en <span class="monospaced">add_brown</span> que sólo aparece
  cuando hay más de 20 tareas. En ese caso, si nunca borramos la base de datos,
  nuestras pruebas fallarán&#8230; cuando las hayamos ejecutado suficientes veces.
  Y si las dejamos así, y hay otro fallo que sólo aparece cuando no haya
  ninguna tarea, las pruebas nunca nos avisarán del segundo fallo.
</p>
</li>
</ul></div>
<div class="paragraph"><p>Si queremos probar ciertos casos de datos iniciales, es más claro y más fiable
probar esos casos expresamente y por separado. Tendremos la ventaja de que
estará claro al leer las pruebas qué casos cubrimos, y ejecutar las pruebas
<em>una sola vez</em> nos hará estar seguros de que <em>todos</em> los casos que nos
interesan funcionan perfectamente. Como regla general, cualquier incertidumbre
o indeterminismo sobre la ejecución o resultados de las pruebas que podamos
eliminar, debe ser eliminado.</p></div>
<div class="paragraph"><p>Podemos terminar este consejo con una reflexión: <em>las pruebas no son mejores
porque pasen con más frecuencia, sino porque demuestren que un mayor
número de casos interesantes funcionan exactamente como queremos</em>.</p></div>
</div>
<div class="sect2">
<h3 id="_reusar_datos_de_prueba">Reusar datos de prueba</h3>
<div class="paragraph"><p>Cuando empezamos a escribir pruebas, algo que necesitamos con frecuencia son
datos iniciales o de prueba (en inglés, <em>fixtures</em>). Si no tenemos una forma
fácil de crear esos bancos de datos para cada prueba, tendremos la tentación de
tener un solo conjunto de datos iniciales que usaremos en <em>todas</em> las pruebas
de nuestro proyecto. Aunque en algunos casos pueda resultar práctico compartir
datos de prueba entre <em>algunas</em> pruebas, esta costumbre puede traer un problema
añadido.</p></div>
<div class="paragraph"><p>A medida que escribimos nuevas pruebas, éstas necesitarán más datos de
contraste. Si añadimos estos datos a nuestro único conjunto de datos iniciales,
cabe la posibilidad de que algunas de las pruebas antiguas empiece a fallar
(p.ej. una prueba que cuente el número de tareas en el sistema). Si ante este
problema reescribimos la prueba antigua para que pase con el nuevo conjunto de
datos, estaremos haciendo más complejas nuestras pruebas, y además corremos el
riesgo de cometer un fallo al reescribir la prueba antigua. Por no mencionar
que si seguimos por este camino, puede que en la siguiente ocasión tengamos que
reescribir dos pruebas. O cinco. O veinte.</p></div>
<div class="paragraph"><p>Todo esto está relacionado, en cierta manera, con el problema descrito en el
anterior apartado: pensar en las pruebas como pensamos en el resto del código.
En este caso, pensar que tener más datos de prueba es mejor, porque se parecerá
más al caso real en el que se ejecutará el programa. Sin embargo, en la mayoría
de los casos esto no representa ninguna ventaja, pero sí que tiene al menos una
desventaja: cuando alguna prueba falle y tengamos que investigar por qué,
será más difícil encontrar el problema real cuantos más datos haya. Si podemos
escribir nuestras pruebas teniendo un solo objeto de prueba, o incluso ninguno,
mejor que mejor.</p></div>
</div>
<div class="sect2">
<h3 id="_no_facilitar_el_proceso_de_pruebas">No facilitar el proceso de pruebas</h3>
<div class="paragraph"><p>El apartado sobre ejecutar las pruebas con frecuencia ya mencionaba que las
pruebas son parte integrante del código. Aunque no funciona exactamente de la
misma manera ni tienen las mismas propiedades, sí que se tienen que mantener
con el mismo cuidado y esfuerzo con el que mantenemos el resto del código.</p></div>
<div class="paragraph"><p>Este apartado hace hincapié en que tenemos que hacer lo posible para facilitar
la escritura de pruebas. Éstas no son una necesidad molesta a la que tenemos
que dedicar el menor tiempo posible: como parte integrante de nuestro código se
merece la misma dedicación que el resto. Así, nuestro código de prueba debe ser
legible, conciso y fácil de escribir. Si cuesta escribir pruebas, ya sea en
tiempo, esfuerzo mental o líneas de código, tenemos un problema que debemos
resolver, ya sea reorganizando código, escribiendo métodos de conveniencia o
usando cualquier otra técnica que nos ayude. Desgraciadamente, muchos
desarrolladores piensan que es normal que sea costoso escribir pruebas y no
hacen nada por mejorar la situación. En última instancia, esto hace que el
equipo escriba menos pruebas, y de peor calidad.</p></div>
<div class="paragraph"><p>Veamos un caso concreto. Digamos que queremos probar la interfaz web de nuestra
aplicación de tareas pendientes. Una de las primeras pruebas que escribiríamos
aseguraría que crear una tarea simple funciona. Una primera implementación
podría quedar así:</p></div>
<div class="listingblock">
<div class="content"><!-- Generator: GNU source-highlight 3.1.6
by Lorenzo Bettini
http://www.lorenzobettini.it
http://www.gnu.org/software/src-highlite -->
<pre><tt><span style="font-weight: bold"><span style="color: #0000FF">class</span></span> <span style="font-weight: bold"><span style="color: #000000">TestBrownListDashboard_______MAL</span></span><span style="color: #990000">(</span>unittest<span style="color: #990000">.</span>TestCase<span style="color: #990000">):</span>

    <span style="font-weight: bold"><span style="color: #0000FF">def</span></span> <span style="font-weight: bold"><span style="color: #000000">setUp</span></span><span style="color: #990000">(</span>self<span style="color: #990000">):</span>
        <span style="font-style: italic"><span style="color: #9A1900"># Rehacemos la base de datos y creamos el navegador en self.driver</span></span>

    <span style="font-weight: bold"><span style="color: #0000FF">def</span></span> <span style="font-weight: bold"><span style="color: #000000">testAddBrownSimple______MAL</span></span><span style="color: #990000">(</span>self<span style="color: #990000">):</span>
        self<span style="color: #990000">.</span>driver<span style="color: #990000">.</span><span style="font-weight: bold"><span style="color: #000000">get</span></span><span style="color: #990000">(</span><span style="color: #FF0000">"/"</span><span style="color: #990000">)</span>
        self<span style="color: #990000">.</span>driver<span style="color: #990000">.</span><span style="font-weight: bold"><span style="color: #000000">findElementById</span></span><span style="color: #990000">(</span><span style="color: #FF0000">"username"</span><span style="color: #990000">).</span><span style="font-weight: bold"><span style="color: #000000">send_keys</span></span><span style="color: #990000">(</span><span style="color: #FF0000">"usuario"</span><span style="color: #990000">)</span>
        self<span style="color: #990000">.</span>driver<span style="color: #990000">.</span><span style="font-weight: bold"><span style="color: #000000">findElementById</span></span><span style="color: #990000">(</span><span style="color: #FF0000">"password"</span><span style="color: #990000">).</span><span style="font-weight: bold"><span style="color: #000000">send_keys</span></span><span style="color: #990000">(</span><span style="color: #FF0000">"contraseña"</span><span style="color: #990000">)</span>
        self<span style="color: #990000">.</span>driver<span style="color: #990000">.</span><span style="font-weight: bold"><span style="color: #000000">findElementById</span></span><span style="color: #990000">(</span><span style="color: #FF0000">"login"</span><span style="color: #990000">).</span><span style="font-weight: bold"><span style="color: #000000">click</span></span><span style="color: #990000">()</span>

        new_brown_title <span style="color: #990000">=</span> <span style="color: #FF0000">"My title"</span>
        self<span style="color: #990000">.</span>driver<span style="color: #990000">.</span><span style="font-weight: bold"><span style="color: #000000">findElementById</span></span><span style="color: #990000">(</span><span style="color: #FF0000">"new_brown"</span><span style="color: #990000">).</span><span style="font-weight: bold"><span style="color: #000000">send_keys</span></span><span style="color: #990000">(</span>new_brown_title<span style="color: #990000">)</span>
        self<span style="color: #990000">.</span>driver<span style="color: #990000">.</span><span style="font-weight: bold"><span style="color: #000000">findElementById</span></span><span style="color: #990000">(</span><span style="color: #FF0000">"create_brown"</span><span style="color: #990000">).</span><span style="font-weight: bold"><span style="color: #000000">click</span></span><span style="color: #990000">()</span>
        title_tag <span style="color: #990000">=</span> self<span style="color: #990000">.</span>driver<span style="color: #990000">.</span><span style="font-weight: bold"><span style="color: #000000">findElementByTagName</span></span><span style="color: #990000">(</span><span style="color: #FF0000">"task-1-title"</span><span style="color: #990000">)</span>
        self<span style="color: #990000">.</span><span style="font-weight: bold"><span style="color: #000000">assertEqual</span></span><span style="color: #990000">(</span>title_tag<span style="color: #990000">.</span>text<span style="color: #990000">,</span> new_brown_title<span style="color: #990000">)</span></tt></pre></div><div class="title">Ejemplo de prueba funcional difícil de escribir</div>
</div>
<div class="paragraph"><p>Aunque aisladamente, este código es relativamente fácil de leer y entender, tiene varios problemas:</p></div>
<div class="ulist"><ul>
<li>
<p>
No es todo lo compacto que podría ser
</p>
</li>
<li>
<p>
Contiene código que sabemos que se duplicará en otras pruebas
</p>
</li>
<li>
<p>
No contiene abstracciones, por lo que cuando haya cambios en la aplicación
  (digamos, el id de "username" o "password" cambia), tendremos que buscar
  dónde nos referimos a éstos para actualizar el código
</p>
</li>
<li>
<p>
No está escrito usando el lenguaje del dominio de la aplicación, sino usando
  el lenguaje de automatización de un navegador, por lo que es más difícil de
  leer y mantener
</p>
</li>
</ul></div>
<div class="paragraph"><p>Una alternativa mucho mejor sería la siguiente:</p></div>
<div class="listingblock">
<div class="content"><!-- Generator: GNU source-highlight 3.1.6
by Lorenzo Bettini
http://www.lorenzobettini.it
http://www.gnu.org/software/src-highlite -->
<pre><tt><span style="font-weight: bold"><span style="color: #0000FF">class</span></span> <span style="font-weight: bold"><span style="color: #000000">TestBrownListDashboard</span></span><span style="color: #990000">(</span>BrownFunctionalTestCase<span style="color: #990000">):</span>

    <span style="font-weight: bold"><span style="color: #0000FF">def</span></span> <span style="font-weight: bold"><span style="color: #000000">testAddBrownSimple</span></span><span style="color: #990000">(</span>self<span style="color: #990000">):</span>
        self<span style="color: #990000">.</span><span style="font-weight: bold"><span style="color: #000000">assertLogin</span></span><span style="color: #990000">(</span><span style="color: #FF0000">"usuario"</span><span style="color: #990000">,</span> <span style="color: #FF0000">"contraseña"</span><span style="color: #990000">)</span>

        new_brown_title <span style="color: #990000">=</span> <span style="color: #FF0000">"My title"</span>
        self<span style="color: #990000">.</span><span style="font-weight: bold"><span style="color: #000000">createBrown</span></span><span style="color: #990000">(</span>new_brown_title<span style="color: #990000">)</span>
        self<span style="color: #990000">.</span><span style="font-weight: bold"><span style="color: #000000">assertBrownExists</span></span><span style="color: #990000">(</span>new_brown_title<span style="color: #990000">)</span></tt></pre></div><div class="title">Ejemplo de prueba funcional más fácil de escribir</div>
</div>
<div class="paragraph"><p>Las mejoras de la segunda versión son las siguientes:</p></div>
<div class="ulist"><ul>
<li>
<p>
<span class="monospaced">TestBrownListDashboard</span> ahora hereda de una nueva clase,
  <span class="monospaced">BrownFunctionalTestCase</span>, que será una clase base para todas nuestras clases
  de prueba. Aquí añadiremos todo el código común a diferentes pruebas de
  nuestra aplicación.
</p>
</li>
<li>
<p>
Como tenemos una clase base, ya no necesitamos escribir el método <span class="monospaced">setUp</span>
  porque ésta ya crea la base de datos e inicializa el navegador de prueba por
  nosotros.
</p>
</li>
<li>
<p>
Para abrir sesión, simplemente llamamos a un nuevo método <span class="monospaced">assertLogin</span>. No
  sólo es mucho más compacto y legible, sino que si alguna vez cambian los
  detalles de cómo iniciamos sesión, podemos simplemente cambiar la
  implementación de este método.
</p>
</li>
<li>
<p>
Crear una nueva tarea es tan fácil como llamar a un nuevo método
  <span class="monospaced">createBrown</span>, y comprobar que se ha creado correctamente se lleva a cabo llamando al método
  <span class="monospaced">assertBrownExists</span>. Dependiendo del caso, podríamos incluso haber creado un
  método <span class="monospaced">assertCreateBrown</span>, pero por ahora parece mejor dejar ambas
  operaciones separadas.
</p>
</li>
</ul></div>
<div class="paragraph"><p>Como se puede ver, una simple reorganización del código (del mismo tipo que
haríamos con el código principal del programa) puede tener un impacto muy
grande en la facilidad de mantenimiento de nuestras pruebas.</p></div>
<div class="paragraph"><p>La necesidad de facilitar la escritura de pruebas se extiende a todas las
tareas relacionadas con probar nuestro código, no sólo mantener el código de
pruebas automáticas. Digamos que escribimos un programa cliente-servidor. Si
cada vez que encontramos un problema no somos capaces de depurarlo, o de
asegurar si está de verdad arreglado o no porque no tenemos una forma fácil de
probar el cliente o el servidor por separado, tenemos un problema. Una de las
varias soluciones posibles es tener un cliente de prueba con el que podamos
enviar al servidor cualquier petición que se nos ocurra, y un servidor de
prueba con el que podamos enviar al cliente cualquier respuesta que se nos
ocurra.  Herramientas para capturar <em>fácilmente</em> el tráfico entre cliente y
servidor también pueden ahorrarnos mucho tiempo a la larga.</p></div>
<div class="paragraph"><p>Al fin y al cabo, estamos hablando de la calidad de nuestro trabajo, no en un
sentido abstracto o teórico, sino en el sentido más pragmático desde el punto
de vista del usuario. Si no podemos comprobar que nuestro programa se comporta
debidamente, nos quedarán muchos fallos por descubrir, y por tanto que
arreglar, que llegarán a los usuarios finales.</p></div>
</div>
<div class="sect2">
<h3 id="_depender_de_muchos_servicios_externos">Depender de muchos servicios externos</h3>
<div class="paragraph"><p>El último consejo es el más avanzado, y es el consejo con el que hay que tener
más cuidado al aplicarlo. La tendencia natural al crear entornos de prueba es
replicar algo lo más parecido posible al entorno real, usando las mismas bases
de datos, los mismos servidores y la misma configuración. Aunque esto tiene
sentido y es <em>necesario</em> en pruebas de aceptación y pruebas de integración
<span class="footnote"><br>[Las pruebas de integración son las más completas que hacemos, que
determinan si el proyecto, como un todo, funciona desde el punto de vista del
usuario.]<br></span>, puede ser bastante contraproducente en pruebas unitarias y
similares, en las que sólo queremos probar componentes relativamente pequeños.</p></div>
<div class="paragraph"><p>Depender de servicios externos como una base de datos, un servidor web, una
cola de tareas, etc. hace que las pruebas sean más frágiles, porque aumentan
las posibilidades de que fallen por una mala configuración, en vez de porque
hemos encontrado un problema en el código. Como en la mayoría de los tipos de
pruebas, como las unitarias, sólo queremos probar que cierto componente
concreto funciona correctamente, no hace falta que lo integremos con el resto
de los componentes. En muchos casos, podemos reemplazar esos componentes con
versiones «de pega» que se comporten como nos haga falta para cada prueba.</p></div>
<div class="paragraph"><p>Un ejemplo claro de las ventajas de usar componentes «de pega» es el desarrollo
y prueba de una aplicación que usa una API, tanto en el caso de que escribimos
sólo el cliente como en el caso de que escribimos tanto el cliente como el
servidor. Aunque para hacer pruebas de integración deberíamos usar el servidor
real, la mayoría de las pruebas tendrán un ámbito más limitado (bien sean
pruebas unitarias, o pruebas funcionales que sólo cubran el comportamiento del
cliente). Para éstas sabemos, al tener la documentación de dicha API:</p></div>
<div class="olist arabic"><ol class="arabic">
<li>
<p>
Qué llamadas debe generar nuestra aplicación en ciertas situaciones.
</p>
</li>
<li>
<p>
Cómo tiene que reaccionar nuestra aplicación ante ciertas respuestas del
servidor.
</p>
</li>
</ol></div>
<div class="paragraph"><p>Armados con este conocimiento, podemos diseñar pruebas que no dependen del
servidor. No depender del servidor tiene varias ventajas, entre otras:</p></div>
<div class="ulist"><ul>
<li>
<p>
Las pruebas se ejecutan más rápido.
</p>
</li>
<li>
<p>
Las pruebas se pueden ejecutar sin tener conexión a internet o acceso al
  servidor (incluyendo que el servidor esté funcionando correctamente).
</p>
</li>
<li>
<p>
Cuando hay fallos, éstos son más fáciles de depurar y corregir.
</p>
</li>
<li>
<p>
Podemos probar muchas situaciones que no podemos reproducir fácilmente en un
  servidor real, como no poder conectar al servidor, que el servidor devuelva
  cualquier tipo de error, que devuelva ciertas combinaciones de datos que son
  difíciles de obtener, condiciones de carrera, etc.
</p>
</li>
</ul></div>
<div class="paragraph"><p>No todo son ventajas, claro. Si el servidor introduce cambios que rompen la
compatibilidad con la documentación que tenemos, esos fallos no se descubrirán
hasta las pruebas de integración. De manera similar, si nuestras pruebas
dependen de un comportamiento concreto, documentado o no, y este comportamiento
cambia, de nuevo no detectaremos estos fallos hasta las pruebas de integración.</p></div>
<div class="paragraph"><p>Veamos un ejemplo más concreto. Digamos que escribimos un programa que utiliza
la API pública de Kiva, una organización que permite, mediante microcréditos,
prestar dinero a personas que lo necesitan. Nuestra aplicación mostrará los
últimos préstamos listados en la web de Kiva (digamos, 50), información que
obtenemos usando la llamada <span class="monospaced">/loans/newest</span>. Sin embargo, hay varios casos que
son muy difíciles de probar con un servidor real:</p></div>
<div class="ulist"><ul>
<li>
<p>
Esa funcionalidad de la API sólo devuelve 20 elementos por llamada, por lo
  que tenemos que hacer varias llamadas para obtener todos los préstamos que
  queremos.
</p>
</li>
<li>
<p>
Si se añaden nuevos préstamos mientras estamos haciendo las llamadas para
  obtener 50 préstamos, tendremos préstamos repetidos, lo que queremos evitar.
</p>
</li>
<li>
<p>
Puede ocurrir que no haya 50 préstamos en un momento dado, así que tendremos
  que conformarnos con los datos que haya (en vez de, por ejemplo, entrar en un
  bucle infinito).
</p>
</li>
<li>
<p>
Puede que el servidor tenga algún problema y no devuelva una respuesta
  correcta, o que simplemente haya problemas de conectividad entre el cliente y
  el servidor. Como mínimo queremos asegurarnos, como en el caso anterior, de
  que el cliente no se queda en un bucle infinito, haciendo peticiones
  ciegamente hasta que hayamos recibido 50 préstamos.
</p>
</li>
</ul></div>
<div class="paragraph"><p>Probar todos esos casos a mano con el servidor real de Kiva es prácticamente
imposible, principalmente porque no podemos hacer que el servidor devuelva las
respuestas necesarias para reproducir cada caso. Si todas nuestras pruebas
dependen del servidor no podremos estar seguros de si el código funciona bien.
Sin embargo, todos estos casos son muy fáciles de probar si evitamos
conectarnos al servidor real. Los casos mencionados arriba se podrían escribir
de la siguiente manera en Javascript, usando Jasmine:</p></div>
<div class="listingblock">
<div class="content"><!-- Generator: GNU source-highlight 3.1.6
by Lorenzo Bettini
http://www.lorenzobettini.it
http://www.gnu.org/software/src-highlite -->
<pre><tt><span style="font-weight: bold"><span style="color: #000000">it</span></span><span style="color: #990000">(</span><span style="color: #FF0000">"should correctly get items from several pages"</span><span style="color: #990000">,</span> <span style="font-weight: bold"><span style="color: #0000FF">function</span></span><span style="color: #990000">()</span> <span style="color: #FF0000">{</span>
  <span style="font-weight: bold"><span style="color: #0000FF">var</span></span> fakeServer <span style="color: #990000">=</span> <span style="font-weight: bold"><span style="color: #0000FF">new</span></span> <span style="font-weight: bold"><span style="color: #000000">FakeServer</span></span><span style="color: #990000">(</span>fixtureWith100Loans<span style="color: #990000">);</span>
  <span style="font-weight: bold"><span style="color: #0000FF">var</span></span> kivaLoanLoader <span style="color: #990000">=</span> <span style="font-weight: bold"><span style="color: #0000FF">new</span></span> <span style="font-weight: bold"><span style="color: #000000">KivaLoanLoader</span></span><span style="color: #990000">(</span>fakeServer<span style="color: #990000">);</span>
  kivaLoanLoader<span style="color: #990000">.</span><span style="font-weight: bold"><span style="color: #000000">fetchLoans</span></span><span style="color: #990000">(</span><span style="color: #993399">50</span><span style="color: #990000">);</span>
  <span style="font-weight: bold"><span style="color: #000000">expect</span></span><span style="color: #990000">(</span>kivaLoanLoader<span style="color: #990000">.</span>loans<span style="color: #990000">.</span>length<span style="color: #990000">).</span><span style="font-weight: bold"><span style="color: #000000">toEqual</span></span><span style="color: #990000">(</span><span style="color: #993399">50</span><span style="color: #990000">);</span>
  <span style="font-weight: bold"><span style="color: #000000">expect</span></span><span style="color: #990000">(</span>kivaLoanLoader<span style="color: #990000">.</span>loans<span style="color: #990000">[</span><span style="color: #993399">0</span><span style="color: #990000">].</span>id<span style="color: #990000">).</span><span style="font-weight: bold"><span style="color: #000000">toEqual</span></span><span style="color: #990000">(</span><span style="color: #FF0000">"loan1"</span><span style="color: #990000">);</span>
  <span style="font-weight: bold"><span style="color: #000000">expect</span></span><span style="color: #990000">(</span>kivaLoanLoader<span style="color: #990000">.</span>loans<span style="color: #990000">[</span><span style="color: #993399">50</span><span style="color: #990000">].</span>id<span style="color: #990000">).</span><span style="font-weight: bold"><span style="color: #000000">toEqual</span></span><span style="color: #990000">(</span><span style="color: #FF0000">"loan50"</span><span style="color: #990000">);</span>
<span style="color: #FF0000">}</span><span style="color: #990000">);</span>

<span style="font-weight: bold"><span style="color: #000000">it</span></span><span style="color: #990000">(</span><span style="color: #FF0000">"should correctly skip items duplicated in different pages"</span><span style="color: #990000">,</span> <span style="font-weight: bold"><span style="color: #0000FF">function</span></span><span style="color: #990000">()</span> <span style="color: #FF0000">{</span>
  <span style="font-weight: bold"><span style="color: #0000FF">var</span></span> fakeServer <span style="color: #990000">=</span> <span style="font-weight: bold"><span style="color: #0000FF">new</span></span> <span style="font-weight: bold"><span style="color: #000000">FakeServer</span></span><span style="color: #990000">(</span>fixtureWith100LoansSomeRepeated<span style="color: #990000">);</span>
  <span style="font-weight: bold"><span style="color: #0000FF">var</span></span> kivaLoanLoader <span style="color: #990000">=</span> <span style="font-weight: bold"><span style="color: #0000FF">new</span></span> <span style="font-weight: bold"><span style="color: #000000">KivaLoanLoader</span></span><span style="color: #990000">(</span>fakeServer<span style="color: #990000">);</span>
  kivaLoanLoader<span style="color: #990000">.</span><span style="font-weight: bold"><span style="color: #000000">fetchLoans</span></span><span style="color: #990000">(</span><span style="color: #993399">25</span><span style="color: #990000">);</span>
  <span style="font-weight: bold"><span style="color: #000000">expect</span></span><span style="color: #990000">(</span>kivaLoanLoader<span style="color: #990000">.</span>loans<span style="color: #990000">.</span>length<span style="color: #990000">).</span><span style="font-weight: bold"><span style="color: #000000">toEqual</span></span><span style="color: #990000">(</span><span style="color: #993399">25</span><span style="color: #990000">);</span>
  <span style="font-weight: bold"><span style="color: #000000">expect</span></span><span style="color: #990000">(</span>kivaLoanLoader<span style="color: #990000">.</span>loans<span style="color: #990000">[</span><span style="color: #993399">19</span><span style="color: #990000">].</span>id<span style="color: #990000">).</span><span style="font-weight: bold"><span style="color: #000000">toEqual</span></span><span style="color: #990000">(</span><span style="color: #FF0000">"loan20"</span><span style="color: #990000">);</span>
  <span style="font-style: italic"><span style="color: #9A1900">// El siguiente caso será loan20 repetido, si el código no funciona bien</span></span>
  <span style="font-weight: bold"><span style="color: #000000">expect</span></span><span style="color: #990000">(</span>kivaLoanLoader<span style="color: #990000">.</span>loans<span style="color: #990000">[</span><span style="color: #993399">20</span><span style="color: #990000">].</span>id<span style="color: #990000">).</span><span style="font-weight: bold"><span style="color: #000000">toEqual</span></span><span style="color: #990000">(</span><span style="color: #FF0000">"loan21"</span><span style="color: #990000">);</span>
  <span style="font-weight: bold"><span style="color: #000000">expect</span></span><span style="color: #990000">(</span>kivaLoanLoader<span style="color: #990000">.</span>loans<span style="color: #990000">[</span><span style="color: #993399">24</span><span style="color: #990000">].</span>id<span style="color: #990000">).</span><span style="font-weight: bold"><span style="color: #000000">toEqual</span></span><span style="color: #990000">(</span><span style="color: #FF0000">"loan25"</span><span style="color: #990000">);</span>
<span style="color: #FF0000">}</span><span style="color: #990000">);</span>

<span style="font-weight: bold"><span style="color: #000000">it</span></span><span style="color: #990000">(</span><span style="color: #FF0000">"should stop when there's no more data"</span><span style="color: #990000">,</span> <span style="font-weight: bold"><span style="color: #0000FF">function</span></span><span style="color: #990000">()</span> <span style="color: #FF0000">{</span>
  <span style="font-weight: bold"><span style="color: #0000FF">var</span></span> fakeServer <span style="color: #990000">=</span> <span style="font-weight: bold"><span style="color: #0000FF">new</span></span> <span style="font-weight: bold"><span style="color: #000000">FakeServer</span></span><span style="color: #990000">(</span>fixtureWith30Loans<span style="color: #990000">);</span>
  <span style="font-weight: bold"><span style="color: #0000FF">var</span></span> kivaLoanLoader <span style="color: #990000">=</span> <span style="font-weight: bold"><span style="color: #0000FF">new</span></span> <span style="font-weight: bold"><span style="color: #000000">KivaLoanLoader</span></span><span style="color: #990000">(</span>fakeServer<span style="color: #990000">);</span>
  <span style="font-style: italic"><span style="color: #9A1900">// La línea siguiente será un bucle infinito si el código no es correcto</span></span>
  kivaLoanLoader<span style="color: #990000">.</span><span style="font-weight: bold"><span style="color: #000000">fetchLoans</span></span><span style="color: #990000">(</span><span style="color: #993399">40</span><span style="color: #990000">);</span>
  <span style="font-weight: bold"><span style="color: #000000">expect</span></span><span style="color: #990000">(</span>kivaLoanLoader<span style="color: #990000">.</span>loans<span style="color: #990000">.</span>length<span style="color: #990000">).</span><span style="font-weight: bold"><span style="color: #000000">toEqual</span></span><span style="color: #990000">(</span><span style="color: #993399">30</span><span style="color: #990000">);</span>
  <span style="font-weight: bold"><span style="color: #000000">expect</span></span><span style="color: #990000">(</span>kivaLoanLoader<span style="color: #990000">.</span>loans<span style="color: #990000">[</span><span style="color: #993399">0</span><span style="color: #990000">].</span>id<span style="color: #990000">).</span><span style="font-weight: bold"><span style="color: #000000">toEqual</span></span><span style="color: #990000">(</span><span style="color: #FF0000">"loan1"</span><span style="color: #990000">);</span>
  <span style="font-weight: bold"><span style="color: #000000">expect</span></span><span style="color: #990000">(</span>kivaLoanLoader<span style="color: #990000">.</span>loans<span style="color: #990000">[</span><span style="color: #993399">29</span><span style="color: #990000">].</span>id<span style="color: #990000">).</span><span style="font-weight: bold"><span style="color: #000000">toEqual</span></span><span style="color: #990000">(</span><span style="color: #FF0000">"loan30"</span><span style="color: #990000">);</span>
<span style="color: #FF0000">}</span><span style="color: #990000">);</span>

<span style="font-weight: bold"><span style="color: #000000">it</span></span><span style="color: #990000">(</span><span style="color: #FF0000">"should stop on server errors"</span><span style="color: #990000">,</span> <span style="font-weight: bold"><span style="color: #0000FF">function</span></span><span style="color: #990000">()</span> <span style="color: #FF0000">{</span>
  <span style="font-weight: bold"><span style="color: #0000FF">var</span></span> fakeServer <span style="color: #990000">=</span> <span style="font-weight: bold"><span style="color: #0000FF">new</span></span> <span style="font-weight: bold"><span style="color: #000000">FakeServer</span></span><span style="color: #990000">(</span>fixtureWithOnlyServerError<span style="color: #990000">);</span>
  <span style="font-weight: bold"><span style="color: #0000FF">var</span></span> kivaLoanLoader <span style="color: #990000">=</span> <span style="font-weight: bold"><span style="color: #0000FF">new</span></span> <span style="font-weight: bold"><span style="color: #000000">KivaLoanLoader</span></span><span style="color: #990000">(</span>fakeServer<span style="color: #990000">);</span>
  <span style="font-style: italic"><span style="color: #9A1900">// La línea siguiente será un bucle infinito si el código no es correcto</span></span>
  kivaLoanLoader<span style="color: #990000">.</span><span style="font-weight: bold"><span style="color: #000000">fetchLoans</span></span><span style="color: #990000">(</span><span style="color: #993399">20</span><span style="color: #990000">);</span>
  <span style="font-weight: bold"><span style="color: #000000">expect</span></span><span style="color: #990000">(</span>kivaLoanLoader<span style="color: #990000">.</span>loans<span style="color: #990000">.</span>length<span style="color: #990000">).</span><span style="font-weight: bold"><span style="color: #000000">toEqual</span></span><span style="color: #990000">(</span><span style="color: #993399">0</span><span style="color: #990000">);</span>
<span style="color: #FF0000">}</span><span style="color: #990000">);</span></tt></pre></div><div class="title">Ejemplo de cómo probar el cliente ficticio de la API de Kiva</div>
</div>
</div>
<div class="sect2">
<h3 id="_conclusión_3">Conclusión</h3>
<div class="paragraph"><p>Probar programas es una tarea importante pero bastante difícil de hacer
correctamente. Sin embargo, si empezamos a hacer pruebas desde el comienzo del
proyecto, las ejecutamos con frecuencia y nos preocupamos de que sean fáciles
de mantener, nuestras probabilidades de producir programas robustos serán mucho
más altas.</p></div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_calidad_en_software">Calidad en software</h2>
<div class="sectionbody">
<div class="paragraph"><p><em>Esteban Manchado Velázquez</em></p></div>
<div class="paragraph"><p>«Calidad» es una palabra muy usada pero un concepto bastante escurridizo, al
menos a la hora de encontrar maneras fiables de mejorarla o simplemente
mantenerla una vez hemos llegado a un nivel aceptable. Este artículo explorará
qué es la calidad y cómo mejorarla en nuestros proyectos.</p></div>
<div class="sect2">
<h3 id="_significado">Significado</h3>
<div class="paragraph"><p>El primer problema de la calidad es definirla. Hay muchas definiciones, pero mi
preferida en el contexto de la ingeniería de software es «adecuación al uso».
Uno de los problemas de la definición es que es muy vaga pero, paradójicamente,
el propio hecho de ser tan vaga es lo que la hace útil. La calidad es un asunto
muy complejo, por lo que simplificarlo, lejos de ayudarnos a entender, sólo nos
dará la ilusión de que lo entendemos. Y la ilusión de entendimiento es muy
peligrosa porque hace que nos resistamos al aprendizaje real.</p></div>
<div class="paragraph"><p>El segundo problema de la calidad es hacer que todos los interesados compartan
lo que entienden por ésta. Este entendimiento compartido nos ayudará a
centrarnos en los objetivos importantes, que son las necesidades del cliente
del proyecto. Esto no significa que sólo sean importantes los aspectos que el
cliente <em>menciona</em>: con frecuencia, los clientes dan por sentadas una serie de
propiedades (eficiencia, fiabilidad, etc), y nuestro trabajo es asegurarnos de
que éstas se cumplen tanto como los requisitos explícitos. Esto es, la calidad
necesita de aspectos técnicos como código rápido o diseño simple, pero éstos
deben estar supeditados a las necesidades y los deseos del cliente, implícitos
y explícitos.</p></div>
</div>
<div class="sect2">
<h3 id="_cómo_mejorar_la_calidad">Cómo mejorar la calidad</h3>
<div class="paragraph"><p>Como ya expone el apartado anterior, es imposible dar una «receta mágica» para
mejorar la calidad. De hecho, intentar mejorar la calidad simplemente siguiendo
una lista de pasos es un camino casi seguro hacia el fracaso. No importa qué
pasos sigamos, qué hayamos oído de ellos o quién los haya recomendado: nuestra
única vía para alcanzar un buen nivel de calidad es usar nuestra experiencia y
conocimiento del contexto para decidir qué es lo que nos ayudará en cada
momento. Tenemos que ser conscientes de lo que hacemos y tomar el control de
nuestras decisiones.</p></div>
<div class="paragraph"><p>Sin embargo, sí se pueden dar <em>guías</em> para mejorar la calidad. Por ejemplo:
mantener siempre el qué, no el cómo, como la guía de todo lo que hacemos;
mantener el escepticismo y cuestionar cómo hacemos las cosas y por qué; estar
preparado para cambiar cómo trabajamos y luchar contra la «programación de
culto al cargo» <span class="footnote"><br>[Hacer las cosas de cierta manera simplemente porque lo
hemos hecho o visto antes, sin entender por qué son así o qué utilidad tienen.
Ver <a href="http://en.wikipedia.org/wiki/Cargo_cult_programming">Cargo Cult Programming</a>
en Wikipedia.]<br></span>; no creer en la tecnología como el centro de lo que hacemos;
darse cuenta de que lo principal no es hacer código bonito o fácil de entender,
sino resolver problemas <span class="footnote"><br>[Los buenos profesionales hacen las dos cosas,
pero es más profesional tener más de lo segundo que más de lo primero.]<br></span>; no
creer que los problemas tengan una solución única o mejor.</p></div>
<div class="paragraph"><p>Esto no quiere decir que las herramientas, técnicas y costumbres no sean
útiles. En absoluto. Lo que sí significa es que éstas nos ayudarán según qué
contextos, según qué proyectos, según qué equipos y según qué clientes, pero
nunca en todos los casos. Los otros artículos de este libro describen algunas
de estas técnicas y herramientas, que son muy útiles y todo buen profesional
debe conocer y dominar, pero uno de los mensajes principales de este artículo
es que conocer y adaptarse al contexto es importante, y que aplicar ciegamente
cualquiera de estas técnicas o herramientas es un error.</p></div>
<div class="paragraph"><p>Para ilustrar las ideas de este artículo, y como inspiración para ayudar a
pensar fuera de cánones más académicos, los siguientes apartados muestran una
serie de ejemplos de situaciones junto con sugerencias de posibles soluciones.
Obviamente no puede haber solución única o «correcta» en estos ejemplos, entre
otras razones porque ninguna descripción literaria puede dar toda la
información necesaria para tomar una buena decisión.</p></div>
</div>
<div class="sect2">
<h3 id="_ejemplo_1_procesos">Ejemplo 1: procesos</h3>
<div class="paragraph"><p>Como regla general, tener procesos y reglas ayuda a los equipos de desarrollo a
trabajar más eficientemente. Por una parte, facilita que nos concentremos en lo
que estamos haciendo y no en el cómo <span class="footnote"><br>[Si siempre hacemos ciertas cosas
de la misma manera y ésta funciona razonablemente bien, no tenemos que gastar
tiempo ni energía decidiendo cómo hacerlas.]<br></span>.  Por otra, facilita la
automatización.</p></div>
<div class="paragraph"><p>Sin embargo, los procesos y las reglas pueden quedarse obsoletos. Por ejemplo,
digamos que uno o dos miembros del equipo causan problemas con la integración
continua: con frecuencia hacen cambios que hacen fallar a la batería de pruebas
y no tienen disciplina para escribir pruebas. Ante esta situación, decidimos
que cada cambio enviado al repositorio debe contener alguna modificación a
algún fichero de pruebas. La medida funciona más o menos bien, esos miembros
del equipo empiezan a tomarse las pruebas más en serio, y así aumentamos la
productividad del equipo con ella.</p></div>
<div class="paragraph"><p>Ahora bien, todas las reglas tienen partes buenas y partes malas, como todo.
Esta medida concreta puede ser molesta cuando simplemente queramos arreglar una
falta de ortografía en un comentario, actualizar la documentación, o
reformatear el código (ya que nuestro cambio no modificaría ningún fichero de
pruebas). Por tanto, si en algún momento esos miembros del equipo se marchan o
llegan al punto de escribir buenas pruebas y no necesitar la anterior medida,
puede que llegue el momento de eliminar esta regla. Mantener y seguir reglas
simplemente porque «siempre han funcionado» es caer en la tentación de seguir
el «culto al cargo».</p></div>
</div>
<div class="sect2">
<h3 id="_ejemplo_2_automatización_de_pruebas">Ejemplo 2: automatización de pruebas</h3>
<div class="paragraph"><p>Una de las constantes en los artículos de este libro es el uso de pruebas
automáticas. Aunque es desde luego una de las prácticas más recomendadas y
útiles, también es verdad que con frecuencia tenemos que trabajar con código
legado (es decir, sin pruebas). En esos casos, ¿qué hacemos?</p></div>
<div class="paragraph"><p>Por ejemplo, digamos que nos unimos a un equipo que no tiene cultura de pruebas
automáticas, y vamos retrasados con la siguiente entrega. Una parte concreta
del código está dando bastantes problemas, y las pruebas manuales (la manera en
la que el equipo prueba el código) no están encontrando suficientes fallos, o
no lo suficientemente pronto. Aunque automatizar las pruebas es probablemente
la mejor idea a largo plazo, no hay ninguna regla exenta de excepciones
<span class="footnote"><br>[Aunque uno podría decir que «no hay ninguna regla exenta de
excepciones» también tiene excepciones&#8230;]<br></span>. Puede que el equipo no tenga
suficiente experiencia en pruebas automáticas como para que introducirlas
mejore la situación <em>antes de la entrega</em>. Puede que las partes críticas del
proyecto en el que trabajamos no sean fáciles de probar de manera fiable con
pruebas automáticas, y empeñarnos en poner énfasis en éstas a toda costa no
ayude al equipo en el contexto de esta entrega. Puede que la tensión de ir
retrasados haga al equipo ser «optimistas» al escribir pruebas, y las pruebas
den un falso sentido de seguridad. Puede que los que toman las decisiones no
estén convencidos, y que a corto plazo no valga la pena gastar tiempo y energía
en convencerlos. Y puede que hayamos convencido a los que toman las decisiones,
pero <em>el equipo</em> no esté convencido, e intentar forzarlos a escribir pruebas
sólo vaya a provocar un bajón de moral y un conjunto de pruebas automáticas de
muy mala calidad.</p></div>
<div class="paragraph"><p>Y si por la razón que sea llegamos a la conclusión de que intentar implantar
pruebas automáticas para la próxima entrega no es una buena idea, ¿qué podemos
hacer? Una de las posibilidades es empezar haciendo más efectivo al equipo sin
cambiar radicalmente su filosofía de trabajo. Por ejemplo, puede que tras
analizar la situación descubramos que esa parte del programa es más difícil de
probar de manera manual porque no da suficiente información.  Quizás añadir una
opción «escondida» que haga esa parte menos opaca puede ser suficiente hasta la
fecha clave. O simplemente mejorar la comunicación entre los miembros del
equipo. Porque, entre otras cosas, siempre es positivo respetar la manera de
trabajar de un equipo («que siempre ha funcionado»): no sólo mejora las
relaciones entre sus miembros, sino que ayuda a ganarse su respeto y atención,
que serán necesarios más tarde para poder implementar cambios grandes como
desarrollo dirigido por pruebas o simplemente escribir pruebas automáticas. Y
mientras tanto, podemos ir enseñando poco a poco al equipo a automatizar las
pruebas para ir cambiando a un modelo (posiblemente) más escalable.</p></div>
</div>
<div class="sect2">
<h3 id="_ejemplo_3_especificaciones">Ejemplo 3: especificaciones</h3>
<div class="paragraph"><p>Cuando se desarrolla software normalmente se tienen especificaciones. Pueden
ser formales (un documento) o informales (el conocimiento compartido del
equipo). El objetivo de las especificaciones es poder concentrarse en la
solución técnica sin tener que estar preguntando continuamente a los clientes
o al resto del equipo sobre el enfoque a la hora de resolver el problema. Pero,
de nuevo, las especificaciones son sólo una herramienta, y cumplir más a
rajatabla con las especificaciones no tiene por qué garantizar una mayor
calidad del proyecto una vez completado.</p></div>
<div class="paragraph"><p>Digamos que estamos desarrollando el software que conduce un coche automático.
Uno de los requisitos del coche es que pare en los pasos de peatones cuando
detecte que una persona está cruzando. Sin embargo, mucha gente no cruza por
los pasos de peatones, así que el coche sería mucho más seguro si no dependiera
de éstos, sino que pudiera detectar por sí mismo si tiene algo delante que
podría llegar a atropellar. Es decir, las especificaciones son una herramienta
muy útil, pero nunca son el objetivo final del desarrollo de software. Las
personas que escriben las especificaciones cometen errores, las condiciones del
proyecto cambian, etc.  Mantener siempre el escepticismo y una visión más
completa de nuestros objetivos, y no dejarnos llevar por el «no es mi trabajo»,
el «no me pagan por esto» o el «yo sólo hago lo que me dicen», es mucho más
importante que cumplir la especificación diligentemente. Dicho de otra manera,
nuestro trabajo no es escribir software que cumple a rajatabla una descripción
textual de un problema. Es hacer software útil y resolver problemas.</p></div>
</div>
<div class="sect2">
<h3 id="_ejemplo_4_diseño_simple">Ejemplo 4: diseño simple</h3>
<div class="paragraph"><p>Una parte importante de la calidad es, por supuesto, tener código mantenible.
El código mantenible normalmente se consigue con código legible y un diseño
simple. Sin embargo, y como muchas otras cosas, estos dos aspectos son sólo una
herramienta para conseguir calidad: un código legible y un diseño simple hacen
que el código contenga, de media, menos errores, y éstos serán más fáciles de
detectar y corregir.</p></div>
<div class="paragraph"><p>Ahora, ¿qué pasa si en algún momento las necesidades del proyecto chocan con
nuestro (por ahora) diseño simple?  La respuesta es obvia: las necesidades del
cliente son el objetivo número uno, y lo demás se tiene que adaptar a éstas.
Intentar adaptar las necesidades del cliente al diseño de la aplicación es, en
la mayoría de los casos, un error. Si para resolver el nuevo problema hacemos
el diseño menos lineal o más complejo, no estamos «haciendo una chapuza porque
el cliente no tiene las ideas claras» o porque «no sabe cómo funciona la
aplicación»: estamos ayudando a resolver un problema real. Si eso implica hacer
una «chapuza» en el código, eso probablemente significa que tenemos que revisar
el diseño de nuestra aplicación. No porque lo hayamos hecho mal desde el
principio, sino porque hemos descubierto nuevos requisitos, o refinado los que
teníamos.</p></div>
</div>
<div class="sect2">
<h3 id="_conclusiones">Conclusiones</h3>
<div class="paragraph"><p>Una conclusión a la que podemos llegar es que la calidad es difícil de
conseguir y de medir, y se necesita experiencia y mucho trabajo para obtenerla.
Pero la conclusión más importante es que <em>es imposible mejorar la calidad de un
proyecto informático aplicando reglas o metodologías</em>.  Da igual cuánta
experiencia o cuánto conocimiento tenga la persona que las haya formulado,
ningún conjunto de reglas o metodologías puede resolver nuestros problemas si
las aplicamos sin entender lo que hacemos y en qué contexto son útiles.</p></div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_integración_continua">Integración continua</h2>
<div class="sectionbody">
<div class="paragraph"><p><em>Yeray Darias Camacho</em></p></div>
<div class="paragraph"><p>Independientemente de si el equipo de desarrollo sigue una metodología
clásica en cascada o algún tipo de metodología ágil hay un momento decisivo
que determina el éxito del proyecto. Este momento es el despliegue de la
aplicación en los sistemas del cliente, lo que conocemos como sistema de
producción.</p></div>
<div class="paragraph"><p>Generalmente este suele ser un momento muy tenso porque es muy raro que todo
funcione a la primera. Si se sigue una metodología en la que predomine el
desarrollo incremental, donde las funcionalidades se van entregando poco a poco,
se minimiza ligeramente el impacto, siempre y cuando al final de cada iteración
se haya desplegado en el sistema de producción real. Pero generalmente sigue
siendo un momento incómodo, se suelen producir errores porque las máquinas
de desarrollo tienen configuraciones diferentes a las máquina de producción, el
rendimiento no es tan bueno porque la base de datos de producción tiene una
cantidad mucho mayor de información, o cualquier otro detalle que no se tuvo en
cuenta durante el desarrollo.</p></div>
<div class="paragraph"><p>Para resolver este problema aparece una nueva «filosofía» o práctica
denominada integración continua. Es un modo de desarrollar un poco diferente al
habitual, y que requiere de una serie de buenas prácticas y la aceptación de las
mismas por el equipo de desarrollo. Se ha de convertir en un hábito que se
realice de forma automática, casi sin darnos cuenta.</p></div>
<div class="sect2">
<h3 id="_la_integración_continua_desde_el_punto_de_vista_del_desarrollador">La integración continua desde el punto de vista del desarrollador</h3>
<div class="paragraph"><p>La siguiente descripción de un día de trabajo, en un equipo que realiza
integración continua, ayudará a ilustrar el proceso y a comprender los elementos
necesarios para llevarla a cabo.</p></div>
<div class="paragraph"><p>Al principio del día lo normal es seleccionar la siguiente tarea más importante
a realizar. En base a la reunión de planificación <span class="footnote"><br>[Reunión de
aproximadamente una hora en la que se decide cuáles serán las tareas a incluir
en la siguiente versión de la aplicación.]<br></span> y a la reunión diaria <span class="footnote"><br>[Breve reunión de
seguimiento, diaria, que realiza todo el equipo, donde expone en qué se trabajó
el día anterior, en qué se trabajará hoy y si existen impedimentos para llevar a
cabo alguna de las tareas en ejecución.]<br></span> siempre existe una lista de tareas
priorizadas a disposición del equipo de desarrollo, por lo que es muy sencillo
saber qué es lo siguiente que debemos hacer. Seleccionamos la tarea en la que
debemos trabajar y volvemos a nuestra mesa de trabajo.</p></div>
<div class="paragraph"><p>El primer paso será actualizar el código fuente del que disponemos con la
versión más nueva que exista en el repositorio central. De igual manera, si
fuese la primera vez que vamos a trabajar en un proyecto, no tenemos más que
descargar una copia limpia del repositorio de código y empezar a hacer nuestro
trabajo. A lo largo del día implementaremos la nueva funcionalidad, que debería
ser bastante pequeña como para terminarla en una jornada de trabajo y debería
incluir una serie de tests que verifiquen que posee el comportamiento deseado.
Se puede leer más sobre los tests en otros capítulos del libro, ahora mismo no
ahondaremos en el tema porque existen libros enteros sobre TDD y tests
unitarios.</p></div>
<div class="paragraph"><p>Cuando la funcionalidad esté terminada, antes de subir ningún cambio al
repositorio, actualizaremos el código fuente con los cambios de nuestros
compañeros y nos aseguraremos de que la aplicación sigue construyéndose
correctamente y que los tests del proyecto están en verde, es decir que pasan
todos sin ningún problema. Si por el contrario aparece algún error lo
arreglaremos inmediatamente. Nunca, bajo ningún concepto, se debe subir código
al repositorio sin revisar que los tests pasan correctamente y la aplicación se
puede construir sin incidencias. Además, es recomendable acceder a la aplicación
y revisar rápidamente que todo sigue funcionando adecuadamente, ya que por lo
general los tests unitarios no tienen una cobertura del 100%, puesto que ciertos
detalles de infraestructura son más sencillos de probar a mano.</p></div>
<div class="paragraph"><p>Una vez hemos realizado todos los pasos anteriores podemos guardar nuestros cambios
en el repositorio de código central, lo que permite que el resto del equipo se
actualice y los tengan disponibles en cuestión de segundos.</p></div>
<div class="paragraph"><p>Aunque el proceso de integración continua comenzó desde el momento en el que
empezamos a trabajar en la nueva funcionalidad, el servidor de integración
continua comienza a trabajar cuando subimos nuestros cambios al repositorio de
código. Dicho sistema se descargará una versión nueva del código fuente con todos los
cambios realizados (los nuestros y los de nuestros compañeros), ejecutará los tests y
tras hacer la construcción del proyecto lo desplegará en una «réplica» de la máquina
de producción. Todo de forma totalmente automatizada. El propio servidor de
integración continua podría pasar algunas pruebas extras, como por ejemplo
análisis estático de código, análisis de cobertura, o cualquier otro detalle que
sería muy tedioso pasar en el proceso de desarrollo porque requiere demasiado
tiempo.</p></div>
<div class="paragraph"><p>También podría haber ocurrido un error. En ese caso el servidor de integración
continua nos avisaría con algún mensaje en la consola del mismo o simplemente
con el envío de un correo electrónico, que es la opción más común. En ese
caso tendremos que inspeccionar cuál ha sido el error y resolverlo para subir
una nueva versión corregida. Como el error se genera a los pocos minutos, y no
han pasado días ni meses, es muy fácil encontrar dónde está el problema.</p></div>
</div>
<div class="sect2">
<h3 id="_ventajas_de_la_integración_continua">Ventajas de la integración continua</h3>
<div class="paragraph"><p>La experiencia demuestra que reduce de manera increíble el número de errores en
el producto final. Esta es probablemente la mayor ventaja que aporta, porque
un producto final con pocos o incluso ningún error es a fin de cuentas el
objetivo que todos deseamos como desarrolladores.</p></div>
<div class="paragraph"><p>Pero no hay que olvidarse de la otra gran ventaja que aporta esta práctica, la
transparencia del proceso. Como todos trabajamos utilizando el mismo repositorio
de código y la información del servidor de integración es pública, para todo el
equipo e incluso a veces para el cliente, se conoce con precisión el estado real
del proyecto. No hay que esperar durante meses para saber cómo van las cosas y
las reuniones de seguimiento pueden ser cortas y precisas.</p></div>
<div class="paragraph"><p>Como ventaja añadida cabe destacar la posibilidad de disponer de un servidor de
demostración en el que siempre se posee la última versión de la aplicación. De
esta manera los clientes pueden probar los últimos cambios día a día y ofrecer
información al equipo de desarrollo sin tener que esperar meses.</p></div>
</div>
<div class="sect2">
<h3 id="_requisitos_de_la_integración_continua">Requisitos de la integración continua</h3>
<div class="paragraph"><p>Ahora ya disponemos de una visión más concreta de lo que es la integración
continua, pero nos vendrá bien repasar cuáles son los elementos indispensables
para hacerlo correctamente.</p></div>
<div class="sect3">
<h4 id="_repositorio_de_código">Repositorio de código</h4>
<div class="paragraph"><p>El repositorio de código es fundamental la herramienta que permite que el equipo
trabaje de forma totalmente sincronizada, pero a la vez sencilla. Cada uno trabaja
en su parte y puede actualizar los cambios sin necesidad de que otros
desarrolladores tengan que esperar por estos y viceversa.</p></div>
<div class="paragraph"><p>Desgraciadamente todavía hay muchas empresas que aún no poseen una herramienta
de este tipo. Para aquellos que aún no utilicen un repositorio de código cabe
destacar que actualmente existen una gran cantidad de soluciones gratuitas de
calidad, como pueden ser Subversion, Git o Mercurial por mencionar algunas. Esta
es una pieza fundamental y será prácticamente imposible realizar integración
continua si no se dispone de ella.</p></div>
<div class="paragraph"><p>Este tipo de herramientas marcan un antes y un después en el trabajo cotidiano
de un equipo de desarrollo de software. Pero además es el pivote fundamental de
la integración continua, que no es posible sin un repositorio de código.</p></div>
</div>
<div class="sect3">
<h4 id="_sistema_de_construcción_automatizado">Sistema de construcción automatizado</h4>
<div class="paragraph"><p>Muchos equipos utilizan complejos entornos de desarrollo para implementar y compilar
los proyectos. Esto en sí mismo no es malo, pero debemos poder construir el proyecto
en cualquier máquina sin necesidad de dichos entornos. No todas las máquinas en las
que vayamos a instalar nuestro proyecto tendrán el entorno de desarrollo con el que
trabajamos, incluso en algunos casos estos pueden tener licencias relativamente
caras, por lo que no sería una opción viable.</p></div>
<div class="paragraph"><p>Hay muchas soluciones de construcción diferentes en función de los lenguajes
de programación, en Java están Ant o Maven, en Ruby está Rake, solo por
mencionar algunas. La condición es que debe ser una herramienta muy sencilla que
se pueda ejecutar en cualquier máquina y que consiga automatizar no solo el
proceso de compilación, sino la ejecución de los tests de nuestra aplicación e
incluso el despliegue en el servidor de aplicaciones llegado el caso.</p></div>
</div>
<div class="sect3">
<h4 id="_commits_diarios">Commits diarios</h4>
<div class="paragraph"><p>No todos los requisitos se basan en tener un determinado tipo de herramienta,
algunos se basan en saber cómo utilizar una determinada herramienta. Una vez que
tenemos un control de versiones hay que recordar que el almacenamiento de los
cambios debe ser diario, idealmente un desarrollador debe hacer incluso varias
subidas al repositorio de código al día.</p></div>
<div class="paragraph"><p>Si tenemos un repositorio de código, pero cada desarrollador sube sus cambios
cada dos semanas seguimos en el mismo problema de antes, la integración del
proyecto se retrasa durante todo ese tiempo, perdiendo toda opción de obtener
información inmediatamente. Además, retrasar la integración tanto tiempo genera más
conflictos entre los ficheros editados por los desarrolladores. Debido a que con cada
actualización del repositorio se hace una integración del proyecto completo, cada
mínimo cambio que no desestabilice el proyecto debe ser subido para que se compruebe
que todo sigue funcionando correctamente.</p></div>
</div>
<div class="sect3">
<h4 id="_pruebas_unitarias">Pruebas unitarias</h4>
<div class="paragraph"><p>Hemos hablado todo el tiempo de comprobar que el proyecto funciona correctamente
y al mismo tiempo de automatizar todo el proceso lo mejor posible. Para poder
comprobar que el proyecto funciona de forma automática necesitamos pruebas
unitarias (muchas veces incluso pruebas de integración).</p></div>
<div class="paragraph"><p>Existen muchas maneras diferentes de incluir tests en el proyecto, personalmente
creo que TDD es la manera más adecuada, pero si el equipo no tiene experiencia y
crea las pruebas después de haber realizado la implementación tampoco es un
método inválido. La premisa fundamental es que toda nueva funcionalidad debe
tener una batería de pruebas que verifique que su comportamiento es correcto.</p></div>
</div>
<div class="sect3">
<h4 id="_servidor_de_integración">Servidor de integración</h4>
<div class="paragraph"><p>Esta es la pieza más polémica, mucha gente cree que no es absolutamente
necesaria para hacer integración continua correctamente, por ejemplo, algunos
equipos hacen la integración de forma manual con cada subida al repositorio de código.
En mi opinión es un paso tan sencillo y barato de automatizar que no merece la pena
ahorrárselo. Montar algún servidor de integración, como por ejemplo Jenkins o Cruise
Control, es gratuito y tan sencillo como desplegar un fichero en un servidor. Por
contra las ventajas son grandísimas. Para empezar el proceso está totalmente
automatizado, lo que evita el error humano. Y por otro lado reduce la cantidad
de trabajo, ya que tenemos una solución prefabricada sin necesidad de tener que
crear nosotros mismos complejas soluciones caseras.</p></div>
</div>
</div>
<div class="sect2">
<h3 id="_un_paso_más_allá">Un paso más allá</h3>
<div class="paragraph"><p>Con los pasos descritos hasta el momento ya tendríamos un proceso bastante
completo y que a buen seguro mejorará enormemente la calidad de nuestro
producto. Pero podemos ir un poco más allá y utilizar el servidor de integración
para que haga ciertas tareas relativamente complejas por nosotros.</p></div>
<div class="paragraph"><p>Por ejemplo, podríamos configurar el servidor para que haga análisis estático de
código, de forma que pueda buscar en todo el código bloques sospechosos,
bloques duplicados o referencias que no se utilizan, entre otras cosas. Existen
gran cantidad de opciones como pueden ser FindBugs o PDM. A simple vista puede
parecer algo irrelevante, pero hay que recordar que la complejidad es lo que más
ralentiza el proceso de desarrollo, por lo que un código con menor número de
líneas y referencias inútiles será más sencillo de leer y entender.</p></div>
<div class="paragraph"><p>También podríamos incluir tareas que permitan desplegar la aplicación en un
servidor, de forma que tendríamos siempre un servidor de demostración con la
última versión de nuestro proyecto. Esto es realmente útil cuando tenemos un
cliente comprometido, dispuesto a probar todos los nuevos cambios y a dar información
al equipo.</p></div>
<div class="paragraph"><p>Otra operación que podemos automatizar, y que el servidor de integración podría
hacer por nosotros, es la realización de pruebas de sistema sobre la aplicación.
Imaginemos que estamos desarrollando una aplicación web, podríamos crear tests
con alguna herramienta de grabación de la navegación, como por ejemplo Selenium,
y lanzarlos con cada construcción que haga el servidor. Es un tipo de prueba que
requiere mucho tiempo y no sería viable que se lancen con cada compilación del
desarrollador, pero para el servidor de integración no habría ningún problema.
Este es solo un ejemplo más de la cantidad de cosas que puede hacer un servidor
de integración continua por nosotros, y que nos ayudará a mantener un producto
estable y testeado de manera totalmente automática.</p></div>
<div class="paragraph"><p>Para acabar me gustaría utilizar algunos comentarios escuchados por Martin
Fowler cuando habla de integración continua con otros desarrolladores. La
primera reacción suele ser algo como «eso no puede funcionar (aquí)» o «hacer
eso no cambiará mucho las cosas», pero muchos equipos se dan cuenta de que es
más fácil de implementar de lo que parece y pasado un tiempo su reacción
cambia a «¿cómo puedes vivir sin eso?». Ahora es tu elección si decides
probarlo o no, pero antes de hacerlo piensa en lo poco que tienes que perder y
lo mucho que puedes ganar.</p></div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_desarrollo_dirigido_por_pruebas">Desarrollo dirigido por pruebas</h2>
<div class="sectionbody">
<div class="paragraph"><p><em>Joaquín Caraballo</em></p></div>
<div class="paragraph"><p>El desarrollo dirigido por pruebas (o TDD por sus siglas en inglés) consiste en escribir la prueba que demuestra una característica del software antes de la característica en sí; paso a paso, se va acrecentando una batería de pruebas con el código para explotación, al ritmo de:</p></div>
<div class="quoteblock">
<div class="content">
<div class="paragraph"><p>rojo - verde - refactorización</p></div>
</div>
<div class="attribution">
</div></div>
<div class="paragraph"><p>Donde en el paso rojo escribimos una prueba que el software no satisface, en el verde modificamos el código de explotación para que la satisfaga y en el de refactorización mejoramos el código sin cambiar funcionalidad, con la confianza de que la batería de pruebas que hemos ido creando hasta el momento nos protege de estropear algo sin darnos cuenta.</p></div>
<div class="sect2">
<h3 id="_ejemplo">Ejemplo</h3>
<div class="paragraph"><p>Probablemente la forma más fácil de explicar TDD es con un ejemplo a nivel unitario. Supongamos que nuestra aplicación necesita convertir millas a kilómetros; empezamos con una prueba:</p></div>
<div class="sect3">
<h4 id="_rojo">Rojo</h4>
<div class="listingblock">
<div class="content"><!-- Generator: GNU source-highlight 3.1.6
by Lorenzo Bettini
http://www.lorenzobettini.it
http://www.gnu.org/software/src-highlite -->
<pre><tt><span style="font-weight: bold"><span style="color: #000000">test</span></span><span style="color: #990000">(</span><span style="color: #FF0000">"Converts miles into kilometers"</span><span style="color: #990000">)</span> <span style="color: #FF0000">{</span>
  <span style="font-weight: bold"><span style="color: #000000">MilesToKilometersConverter.convert</span></span><span style="color: #990000">(</span><span style="color: #993399">1.0</span><span style="color: #990000">)</span> should <span style="font-weight: bold"><span style="color: #000000">be</span></span><span style="color: #990000">(</span><span style="color: #993399">1.609</span><span style="color: #990000">)</span>
<span style="color: #FF0000">}</span></tt></pre></div><div class="title">Primera prueba (<a href="https://github.com/emanchado/camino-mejor-programador-codigo/blob/master/tdd/tdd-examples/src/test/scala/org/casa/translation/example0/MilesToKilometersConverterTest.scala">example0/MilesToKilometersConverterTest.scala</a>)</div>
</div>
<div class="paragraph"><p>A continuación, como estamos usando para los ejemplos Scala, que es un lenguaje compilado, antes  de poder ejecutar las pruebas necesitamos escribir un poco más de código. Nos limitaremos a añadir el mínimo código de explotación necesario para que compile. <span class="footnote"><br>[Si estamos usando un entorno de desarrollo, la función de <em>arreglo</em> hará la mayor parte del trabajo por nosotros. En muchos lenguajes como Scala, el compilador nos obligará a incluir alguna implementación antes de permitirnos ejecutar. Algunos desarrolladores suelen implementar inicialmente los métodos lanzando una excepción como en el ejemplo, lo que ayuda a mantener la separación rojo-verde, ya que no se piensa en la implementación hasta el paso verde. Aunque esto pueda parecer prolijo, resulta bastante rápido de producir si tenemos preparada una plantilla en nuestro entorno que introducimos con un atajo. Otra opción es generar la implementación más sencilla que se nos ocurra &#8212;por ejemplo, devolviendo <span class="monospaced">0</span> o <span class="monospaced">null</span>&#8212;.]<br></span></p></div>
<div class="listingblock">
<div class="content"><!-- Generator: GNU source-highlight 3.1.6
by Lorenzo Bettini
http://www.lorenzobettini.it
http://www.gnu.org/software/src-highlite -->
<pre><tt><span style="font-weight: bold"><span style="color: #0000FF">object</span></span> MilesToKilometersConverter <span style="color: #FF0000">{</span>
  <span style="font-weight: bold"><span style="color: #0000FF">def</span></span> <span style="font-weight: bold"><span style="color: #000000">convert</span></span><span style="color: #990000">(</span>miles<span style="font-weight: bold"><span style="color: #0000FF">:</span></span> <span style="color: #009900">Double</span><span style="color: #990000">)</span><span style="font-weight: bold"><span style="color: #0000FF">:</span></span> <span style="color: #009900">Double</span> <span style="font-weight: bold"><span style="color: #0000FF">=</span></span>
    <span style="font-weight: bold"><span style="color: #0000FF">throw</span></span> <span style="font-weight: bold"><span style="color: #0000FF">new</span></span> <span style="font-weight: bold"><span style="color: #000000">RuntimeException</span></span><span style="color: #990000">(</span><span style="color: #FF0000">"Not yet implemented"</span><span style="color: #990000">)</span>
<span style="color: #FF0000">}</span></tt></pre></div><div class="title">Código necesario para que la primera prueba compile</div>
</div>
<div class="paragraph"><p>Para terminar el paso rojo, ejecutamos la prueba, comprobando que falla (lo que muchos entornos marcan en rojo) lanzando la excepción que esperábamos:</p></div>
<div class="listingblock">
<div class="content monospaced">
<pre>Not yet implemented
java.lang.RuntimeException: Not yet implemented</pre>
</div></div>
<div class="paragraph"><p>Aunque este paso parezca trivial, nos ha obligado a tomar unas cuantas decisiones importantes:</p></div>
<div class="paragraph"><p>Primero, nos ha obligado a definir el contrato de uso del conversor; en este caso, el nombre sugiere que convierte específicamente millas a kilómetros, y no a la inversa; el método de conversión forma parte del objeto (y no de la clase) <span class="monospaced">MilesToKilometersConverter</span>, por lo que no es necesario crear un objeto conversor llamando a <span class="monospaced">new</span>, y sugiere que no tiene estado <span class="footnote"><br>[Para los lectores más familiarizados con Java que con Scala, los objectos creados con <span class="monospaced">object</span> en Scala son semejantes a la parte estática de las clases en Java; los métodos definidos bajo <span class="monospaced">object</span> no están ligados a ningún ejemplar (en inglés <em>instance</em>) de la clase <span class="monospaced">MilesToKilometersConverter</span> &#8212;que de hecho aquí no existe&#8212;. Lo cierto es que estos objetos sí que pueden tener estado (de la misma manera que podemos tener campos estáticos en Java), pero muchos equipos eligen no usar esta característica del lenguaje, a no ser que haya un buen motivo; por eso decimos que definir el método <span class="monospaced">convert</span> en el objeto sugiere que el conversor no tiene estado.]<br></span>; las millas están expresadas con tipo <span class="monospaced">Double</span>; etc.</p></div>
<div class="paragraph"><p>Segundo y más fundamental, la prueba constituye un ejemplo que comienza a definir la funcionalidad de la unidad; que al estar expresado en un lenguaje de programación nos protege de las ambigüedades del lenguaje natural. Por ejemplo, no dudaremos de la definición de milla:</p></div>
<div class="quoteblock">
<div class="content">
<div class="paragraph"><p>Cuando dijimos millas, ¿eran millas internacionales (1,609km)? ¿Millas náuticas (1,852km)? ¿Millas nórdicas (10km)?</p></div>
</div>
<div class="attribution">
</div></div>
<div class="paragraph"><p>Porque la prueba ha dejado claro que el tipo de milla que importa en nuestra aplicación <em>es igual a 1,609 kilómetros.</em></p></div>
<div class="paragraph"><p>Aunque a veces parezca innecesario, merece la pena, antes de progresar al paso verde, completar el rojo llegando a ejecutar una prueba que <em>sabemos</em> que va a fallar; esto nos obliga a pensar en la interfaz que estamos creando, y con frecuencia desvela suposiciones erróneas&#8230; especialmente cuando resulta que la prueba no falla, o que lo hace de una forma distinta de la que esperábamos.</p></div>
</div>
<div class="sect3">
<h4 id="_verde">Verde</h4>
<div class="paragraph"><p>A continuación acrecentamos el código de explotación. Lo más purista es escribir sólo el código imprescindible para superar la prueba:</p></div>
<div class="listingblock">
<div class="content"><!-- Generator: GNU source-highlight 3.1.6
by Lorenzo Bettini
http://www.lorenzobettini.it
http://www.gnu.org/software/src-highlite -->
<pre><tt><span style="font-weight: bold"><span style="color: #0000FF">object</span></span> MilesToKilometersConverter <span style="color: #FF0000">{</span>
  <span style="font-weight: bold"><span style="color: #0000FF">def</span></span> <span style="font-weight: bold"><span style="color: #000000">convert</span></span><span style="color: #990000">(</span>miles<span style="font-weight: bold"><span style="color: #0000FF">:</span></span> <span style="color: #009900">Double</span><span style="color: #990000">)</span><span style="font-weight: bold"><span style="color: #0000FF">:</span></span> <span style="color: #009900">Double</span> <span style="font-weight: bold"><span style="color: #0000FF">=</span></span> <span style="color: #993399">1.609</span>
<span style="color: #FF0000">}</span></tt></pre></div><div class="title">Código mínimo para que la prueba pase</div>
</div>
<div class="paragraph"><p>Y ejecutar la prueba, que nuestra implementación superará con un color verde, si usamos un entorno que lo represente así.</p></div>
</div>
<div class="sect3">
<h4 id="_refactorización">¿Refactorización?</h4>
<div class="paragraph"><p>En esta iteración es pronto para refactorizar. Pasamos al siguiente paso.</p></div>
</div>
<div class="sect3">
<h4 id="_rojo_2">Rojo</h4>
<div class="paragraph"><p>Antes de saltar a la implementación general, merece la pena que consideremos otras condiciones de entrada: ¿aceptamos distancias negativas? Como en este caso sí las aceptamos, lo expresamos con otra prueba.</p></div>
<div class="listingblock">
<div class="content"><!-- Generator: GNU source-highlight 3.1.6
by Lorenzo Bettini
http://www.lorenzobettini.it
http://www.gnu.org/software/src-highlite -->
<pre><tt><span style="font-weight: bold"><span style="color: #000000">test</span></span><span style="color: #990000">(</span><span style="color: #FF0000">"Converts negative miles into kilometers"</span><span style="color: #990000">)</span> <span style="color: #FF0000">{</span>
  <span style="font-weight: bold"><span style="color: #000000">MilesToKilometersConverter.convert</span></span><span style="color: #990000">(-</span><span style="color: #993399">2.0</span><span style="color: #990000">)</span> should <span style="font-weight: bold"><span style="color: #000000">be</span></span><span style="color: #990000">(-</span><span style="color: #993399">3.218</span><span style="color: #990000">)</span>
<span style="color: #FF0000">}</span></tt></pre></div><div class="title">Segunda prueba (<a href="https://github.com/emanchado/camino-mejor-programador-codigo/blob/master/tdd/tdd-examples/src/test/scala/org/casa/translation/example0/MilesToKilometersConverterTest.scala">example0/MilesToKilometersConverterTest.scala</a>)</div>
</div>
<div class="paragraph"><p>Ejecutamos las pruebas para ver como la nueva falla.</p></div>
<div class="listingblock">
<div class="content monospaced">
<pre>1.609 was not equal to -3.218
org.scalatest.TestFailedException: 1.609 was not equal to -3.218</pre>
</div></div>
</div>
<div class="sect3">
<h4 id="_verde_2">Verde</h4>
<div class="paragraph"><p>Ahora que tenemos dos ejemplos de la funcionalidad de <span class="monospaced">convert</span>, es un buen momento para buscar una implementación más general <span class="footnote"><br>[A esta generalización Kent Beck la llama <a href="http://www.informit.com/articles/article.aspx?p=30641"><em>triangulación</em></a>. No estoy seguro de que me guste el término, porque la triangulación geométrica a la que hace analogía permite de forma determinista encontrar una posición a partir de los datos de que se dispone. Aquí, sin embargo, los ejemplos por sí solos no nos permitirían encontrar la solución general, que precisa que además entendamos el problema más allá de los ejemplos.]<br></span> que no sólo satisfaga estas dos pruebas, sino que también nos proporcione la funcionalidad general de la que son ejemplo. Como la siguiente:</p></div>
<div class="listingblock">
<div class="content"><!-- Generator: GNU source-highlight 3.1.6
by Lorenzo Bettini
http://www.lorenzobettini.it
http://www.gnu.org/software/src-highlite -->
<pre><tt><span style="font-weight: bold"><span style="color: #0000FF">object</span></span> MilesToKilometersConverter <span style="color: #FF0000">{</span>
  <span style="font-weight: bold"><span style="color: #0000FF">def</span></span> <span style="font-weight: bold"><span style="color: #000000">convert</span></span><span style="color: #990000">(</span>miles<span style="font-weight: bold"><span style="color: #0000FF">:</span></span> <span style="color: #009900">Double</span><span style="color: #990000">)</span><span style="font-weight: bold"><span style="color: #0000FF">:</span></span> <span style="color: #009900">Double</span> <span style="font-weight: bold"><span style="color: #0000FF">=</span></span> miles <span style="color: #990000">*</span> <span style="color: #993399">1.609</span>
<span style="color: #FF0000">}</span></tt></pre></div><div class="title">Código para la segunda prueba (<a href="https://github.com/emanchado/camino-mejor-programador-codigo/blob/master/tdd/tdd-examples/src/main/scala/org/casa/translation/example0/MilesToKilometersConverter.scala">example0/MilesToKilometersConverter.scala</a>)</div>
</div>
<div class="paragraph"><p>Podríamos haber pasado a la solución general directamente, y a menudo haremos exactamente eso, sin embargo, como vimos en el anterior paso verde, empezar por la solución más simple y dejar la generalización para el siguiente ciclo, nos ayuda a centrarnos primero en definir qué funcionalidad vamos a añadir y cuál va a ser el contrato de la unidad que estamos probando, resolviendo ambigüedades y desvelando suposiciones erróneas. Esto será particularmente útil cuando no tengamos claro lo que queremos hacer y cómo queremos implementarlo.</p></div>
</div>
<div class="sect3">
<h4 id="_refactorización_2">Refactorización</h4>
<div class="paragraph"><p>Tras cada paso verde debemos plantearnos la mejora del código, con la confianza de que las pruebas nos van a proteger de romper algo que funcionaba anteriormente. Las refactorizaciones pueden centrarse en el detalle (¿es mejor expresar <span class="monospaced">miles * 1.609</span> o <span class="monospaced">1.609 * miles</span>? ¿el parámetro debería llamarse <span class="monospaced">miles</span> o <span class="monospaced">distanceInMiles</span>?), pero es fundamental que con frecuencia también reconsideremos el diseño de la aplicación y lo transformemos en lo más apropiado para el estado actual del código, sin ignorar la dirección futura en la que queremos ir pero sin fraguar demasiado lo que puede que nunca necesitemos.</p></div>
</div>
</div>
<div class="sect2">
<h3 id="_por_qué_y_para_qué">Por qué y para qué</h3>
<div class="paragraph"><p>El motivo más importante <span class="footnote"><br>[<em>Para mí</em> el más importante, seguro que otros discreparán.]<br></span> para desarrollar dirigido por pruebas es el énfasis en la función de nuestro código y en su idoneidad para ponerlo a prueba y por lo tanto usarlo. Este énfasis nos obliga a preguntarnos cada vez que vamos a añadir código de explotación: ¿es esto lo que necesito? ¿hace falta <em>ahora</em>?; ayudándonos a escribir exclusivamente lo que necesitamos y a mantener el tamaño y la complejidad del código al mínimo necesario.</p></div>
<div class="paragraph"><p>Si bien TDD no exime de buscar y dirigir el diseño deliberadamente, escribir código que, desde el primer momento, es fácil de probar favorece una cierta simplicidad y, definitivamente, evidencia el acoplamiento, guiándonos hacia el cuidado de la colaboración entre las unidades. En particular, la inyección de dependencias y la separación entre sus interfaces y las implementaciones, emergen de forma natural, dado que facilitan las pruebas automatizadas.</p></div>
<div class="paragraph"><p>Los proyectos que se desarrollan dirigidos por pruebas cuentan en todo momento con una batería de pruebas al día, que documenta la intención de cada unidad del software, de combinaciones de unidades y del software en su totalidad. Además, las pruebas, si bien no la garantizan, dan una buena indicación de la corrección del software; lo que reduce el miedo a romper algo, y lo sustituye por un hábito diligente de refactorizar con frecuencia y mejorar el diseño progresivamente.</p></div>
<div class="sect3">
<h4 id="_ejemplo_de_cómo_las_pruebas_nos_guían_respecto_a_la_cohesión_y_el_acoplamiento">Ejemplo de cómo las pruebas nos guían respecto a la cohesión y el acoplamiento</h4>
<div class="paragraph"><p>En la clase siguiente, el método <span class="monospaced">translate</span> traduce un texto del español a una especie de inglés, mostrando por pantalla el resultado; este código es poco probable que haya sido desarrollado guiado por pruebas, dado que el resultado principal, la traducción, no se pone a disposición del codigo externo de ninguna manera que sea fácil de incluir en una prueba, sino que se manifiesta llamando al método <span class="monospaced">println</span> que da acceso a la consola, es decir, mediante un <em>efecto secundario</em>, lo que dificulta la verificación desde una prueba.</p></div>
<div class="listingblock">
<div class="content"><!-- Generator: GNU source-highlight 3.1.6
by Lorenzo Bettini
http://www.lorenzobettini.it
http://www.gnu.org/software/src-highlite -->
<pre><tt><span style="font-weight: bold"><span style="color: #0000FF">class</span></span> <span style="color: #008080">SpanishIntoEnglishTranslator</span> <span style="color: #FF0000">{</span>
  <span style="font-weight: bold"><span style="color: #0000FF">def</span></span> <span style="font-weight: bold"><span style="color: #000000">translate</span></span><span style="color: #990000">(</span>spanish<span style="font-weight: bold"><span style="color: #0000FF">:</span></span> String<span style="color: #990000">)</span> <span style="color: #FF0000">{</span>
    <span style="font-weight: bold"><span style="color: #000000">println(spanish.split</span></span><span style="color: #990000">(</span><span style="color: #FF0000">' '</span><span style="color: #990000">).</span><span style="font-weight: bold"><span style="color: #000000">map</span></span><span style="color: #990000">(</span><span style="font-weight: bold"><span style="color: #0000FF">_</span></span> <span style="font-weight: bold"><span style="color: #0000FF">match</span></span> <span style="color: #FF0000">{</span>
      <span style="font-weight: bold"><span style="color: #0000FF">case</span></span> <span style="color: #FF0000">"yo"</span> <span style="font-weight: bold"><span style="color: #0000FF">=&gt;</span></span> <span style="color: #FF0000">"I"</span>
      <span style="font-weight: bold"><span style="color: #0000FF">case</span></span> <span style="color: #FF0000">"soy"</span> <span style="font-weight: bold"><span style="color: #0000FF">=&gt;</span></span> <span style="color: #FF0000">"am"</span>
      <span style="font-weight: bold"><span style="color: #0000FF">case</span></span> <span style="font-weight: bold"><span style="color: #0000FF">_</span></span> <span style="font-weight: bold"><span style="color: #0000FF">=&gt;</span></span> <span style="color: #FF0000">"mmmeh"</span>
    <span style="color: #FF0000">}</span><span style="color: #990000">).</span><span style="font-weight: bold"><span style="color: #000000">mkString</span></span><span style="color: #990000">(</span><span style="color: #FF0000">" "</span><span style="color: #990000">))</span>
  <span style="color: #FF0000">}</span>
<span style="color: #FF0000">}</span></tt></pre></div><div class="title">Código díficil de probar (<a href="https://github.com/emanchado/camino-mejor-programador-codigo/blob/master/tdd/tdd-examples/src/main/scala/org/casa/translation/example1coupled/SpanishIntoEnglishTranslator.scala">example1coupled/SpanishIntoEnglishTranslator.scala</a>)</div>
</div>
<div class="paragraph"><p>Si lo desarrollamos con la facilidad de prueba en mente desde el principio, probablemente nos encontraremos con que, para probar el resultado de la traducción, necesitamos que el código que traduce devuelva el resultado; de hecho, ¿acaso no es la traducción en sí la responsabilidad principal de esta clase, y no el mostrar por pantalla? Si pudiéramos obtener el resultado, una prueba de nuestro traductor podría ser algo así:</p></div>
<div class="listingblock">
<div class="content"><!-- Generator: GNU source-highlight 3.1.6
by Lorenzo Bettini
http://www.lorenzobettini.it
http://www.gnu.org/software/src-highlite -->
<pre><tt><span style="font-weight: bold"><span style="color: #0000FF">var</span></span> translator<span style="font-weight: bold"><span style="color: #0000FF">:</span></span> SpanishIntoEnglishTranslator <span style="font-weight: bold"><span style="color: #0000FF">=</span></span> <span style="font-weight: bold"><span style="color: #0000FF">_</span></span>

before <span style="color: #FF0000">{</span>
  translator <span style="font-weight: bold"><span style="color: #0000FF">=</span></span> <span style="font-weight: bold"><span style="color: #0000FF">new</span></span> <span style="font-weight: bold"><span style="color: #000000">SpanishIntoEnglishTranslator</span></span><span style="color: #990000">()</span>
<span style="color: #FF0000">}</span>

<span style="font-weight: bold"><span style="color: #000000">test</span></span><span style="color: #990000">(</span><span style="color: #FF0000">"translates what it can"</span><span style="color: #990000">)</span> <span style="color: #FF0000">{</span>
  <span style="font-weight: bold"><span style="color: #000000">translator.translate</span></span><span style="color: #990000">(</span><span style="color: #FF0000">"yo soy"</span><span style="color: #990000">)</span> should <span style="font-weight: bold"><span style="color: #000000">be</span></span><span style="color: #990000">(</span><span style="color: #FF0000">"I am"</span><span style="color: #990000">)</span>
<span style="color: #FF0000">}</span>

<span style="font-weight: bold"><span style="color: #000000">test</span></span><span style="color: #990000">(</span><span style="color: #FF0000">"mmmehs what it can't"</span><span style="color: #990000">)</span> <span style="color: #FF0000">{</span>
  <span style="font-weight: bold"><span style="color: #000000">translator.translate</span></span><span style="color: #990000">(</span><span style="color: #FF0000">"dame argo"</span><span style="color: #990000">)</span> should <span style="font-weight: bold"><span style="color: #000000">be</span></span><span style="color: #990000">(</span><span style="color: #FF0000">"mmmeh mmmeh"</span><span style="color: #990000">)</span>
<span style="color: #FF0000">}</span></tt></pre></div><div class="title">Primera prueba para el traductor (<a href="https://github.com/emanchado/camino-mejor-programador-codigo/blob/master/tdd/tdd-examples/src/test/scala/org/casa/translation/example2/SpanishIntoEnglishTranslatorTest.scala">example2/SpanishIntoEnglishTranslatorTest.scala</a>)</div>
</div>
<div class="paragraph"><p>Lo que nos llevaría a un traductor menos acoplado a la muestra por pantalla</p></div>
<div class="listingblock">
<div class="content"><!-- Generator: GNU source-highlight 3.1.6
by Lorenzo Bettini
http://www.lorenzobettini.it
http://www.gnu.org/software/src-highlite -->
<pre><tt><span style="font-weight: bold"><span style="color: #0000FF">class</span></span> <span style="color: #008080">SpanishIntoEnglishTranslator</span> <span style="color: #FF0000">{</span>
  <span style="font-weight: bold"><span style="color: #0000FF">def</span></span> <span style="font-weight: bold"><span style="color: #000000">translate</span></span><span style="color: #990000">(</span>spanish<span style="font-weight: bold"><span style="color: #0000FF">:</span></span> String<span style="color: #990000">)</span><span style="font-weight: bold"><span style="color: #0000FF">:</span></span> String <span style="font-weight: bold"><span style="color: #0000FF">=</span></span>
    <span style="font-weight: bold"><span style="color: #000000">spanish.split</span></span><span style="color: #990000">(</span><span style="color: #FF0000">' '</span><span style="color: #990000">).</span><span style="font-weight: bold"><span style="color: #000000">map</span></span><span style="color: #990000">(</span><span style="font-weight: bold"><span style="color: #0000FF">_</span></span> <span style="font-weight: bold"><span style="color: #0000FF">match</span></span> <span style="color: #FF0000">{</span>
      <span style="font-weight: bold"><span style="color: #0000FF">case</span></span> <span style="color: #FF0000">"yo"</span> <span style="font-weight: bold"><span style="color: #0000FF">=&gt;</span></span> <span style="color: #FF0000">"I"</span>
      <span style="font-weight: bold"><span style="color: #0000FF">case</span></span> <span style="color: #FF0000">"soy"</span> <span style="font-weight: bold"><span style="color: #0000FF">=&gt;</span></span> <span style="color: #FF0000">"am"</span>
      <span style="font-weight: bold"><span style="color: #0000FF">case</span></span> <span style="font-weight: bold"><span style="color: #0000FF">_</span></span> <span style="font-weight: bold"><span style="color: #0000FF">=&gt;</span></span> <span style="color: #FF0000">"mmmeh"</span>
    <span style="color: #FF0000">}</span><span style="color: #990000">).</span><span style="font-weight: bold"><span style="color: #000000">mkString</span></span><span style="color: #990000">(</span><span style="color: #FF0000">" "</span><span style="color: #990000">)</span>
<span style="color: #FF0000">}</span></tt></pre></div><div class="title">Un traductor más fácil de probar (<a href="https://github.com/emanchado/camino-mejor-programador-codigo/blob/master/tdd/tdd-examples/src/main/scala/org/casa/translation/example2/SpanishIntoEnglishTranslator.scala">example2/SpanishIntoEnglishTranslator.scala</a>)</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_probar_el_conjunto_de_la_aplicación">Probar el conjunto de la aplicación</h3>
<div class="paragraph"><p>Hasta ahora nos hemos centrado en las pruebas unitarias; no obstante, si somos consecuentes con los principios que hemos visto &#8212;guiarnos manteniendo el enfoque en los objetivos del software, documentar y verificar&#8212;, deberemos considerar fundamental guiar el desarrollo de cada parte de la funcionalidad mediante una prueba que la ejercite en su conjunto; lo ideal será que todas las pruebas funcionales verifiquen el conjunto del software, en un entorno similar al de explotación, o incluso en el entorno de explotación en sí. En la práctica suele haber muchos obstáculos, por ejemplo, puede que sea demasiado costoso llevar a cabo <em>de verdad</em> ciertas acciones destructivas, que no haya suficientes recursos, o que se hayan impuesto decisiones arquitectónicas que dificulten las pruebas; sin embargo, eso no significa que tengamos que claudicar completamente; a menudo, lograremos las mejoras más importantes en el software y en la organización en la que se crea cuestionando las limitaciones.</p></div>
<div class="sect3">
<h4 id="_ejemplo_2">Ejemplo</h4>
<div class="paragraph"><p>Volvamos al ejemplo inicial de conversión de distancias, y supongamos que necesitamos ofrecer a nuestros clientes un servicio de conversión de unidades a través de un servicio web, porque hemos decidido que no hay suficientes conversores en Internet. La <em>primera</em> prueba que vamos a escribir, incluso antes de las que vimos en la introducción, es una prueba que ejercite el conjunto de la aplicación. Nos concentraremos en un cierto mínimo incremento de funcionalidad, visible para los usuarios del sistema, que requiera una implementación reducida y que tenga un alto valor desde un punto de vista comercial o de los objetivos últimos del proyecto. En nuestro caso empezamos con la conversión de millas a kilómetros.</p></div>
<div class="listingblock">
<div class="content"><!-- Generator: GNU source-highlight 3.1.6
by Lorenzo Bettini
http://www.lorenzobettini.it
http://www.gnu.org/software/src-highlite -->
<pre><tt><span style="font-weight: bold"><span style="color: #0000FF">class</span></span> <span style="color: #008080">ConversionTest</span>
    <span style="font-weight: bold"><span style="color: #0000FF">extends</span></span> FunSuite <span style="font-weight: bold"><span style="color: #0000FF">with</span></span> ShouldMatchers <span style="font-weight: bold"><span style="color: #0000FF">with</span></span> BeforeAndAfter <span style="color: #FF0000">{</span>

  <span style="font-weight: bold"><span style="color: #000000">test</span></span><span style="color: #990000">(</span><span style="color: #FF0000">"Converts miles into kilometers"</span><span style="color: #990000">)</span> <span style="color: #FF0000">{</span>
    <span style="font-weight: bold"><span style="color: #000000">get</span></span><span style="color: #990000">(</span><span style="color: #FF0000">"http://localhost:8080/1.0"</span><span style="color: #990000">)</span> should <span style="font-weight: bold"><span style="color: #000000">be</span></span><span style="color: #990000">(</span><span style="color: #FF0000">"1.609"</span><span style="color: #990000">)</span>
  <span style="color: #FF0000">}</span>

  <span style="font-weight: bold"><span style="color: #0000FF">def</span></span> <span style="font-weight: bold"><span style="color: #000000">get</span></span><span style="color: #990000">(</span>url<span style="font-weight: bold"><span style="color: #0000FF">:</span></span> String<span style="color: #990000">)</span><span style="font-weight: bold"><span style="color: #0000FF">:</span></span> String <span style="font-weight: bold"><span style="color: #0000FF">=</span></span> <span style="color: #FF0000">{</span>
    <span style="font-weight: bold"><span style="color: #000000">Request.Get(url).execute().returnContent().asString</span></span><span style="color: #990000">()</span>
  <span style="color: #FF0000">}</span>

  <span style="font-weight: bold"><span style="color: #0000FF">var</span></span> converter<span style="font-weight: bold"><span style="color: #0000FF">:</span></span> Server <span style="font-weight: bold"><span style="color: #0000FF">=</span></span> <span style="font-weight: bold"><span style="color: #0000FF">_</span></span>

  before <span style="color: #FF0000">{</span>
    converter <span style="font-weight: bold"><span style="color: #0000FF">=</span></span> <span style="font-weight: bold"><span style="color: #000000">Converter.start</span></span><span style="color: #990000">(</span><span style="color: #993399">8080</span><span style="color: #990000">)</span>
  <span style="color: #FF0000">}</span>

  after <span style="color: #FF0000">{</span>
    <span style="font-weight: bold"><span style="color: #000000">converter.stop</span></span><span style="color: #990000">()</span>
  <span style="color: #FF0000">}</span>
<span style="color: #FF0000">}</span></tt></pre></div><div class="title">Prueba funcional para el conversor de millas (<a href="https://github.com/emanchado/camino-mejor-programador-codigo/blob/master/tdd/unitconvert/src/test/scala/org/casa/unitconvert/step1/functional/ConversionTest.scala">step1/functional/ConversionTest.scala</a>)</div>
</div>
<div class="paragraph"><p>El método <span class="monospaced">get</span> es aquí un método de ayuda para pruebas, que hace una petición <em>HTTP get</em> y devuelve en contenido del cuerpo del mensaje. Evidentemente, poner esto en funcionamiento requiere un cierto trabajo, pero si nos concentramos en lo fundamental, no será tanto y además nos ayudará a plantearnos cuestiones importantes acerca del sistema, particularmente a nivel de aplicación, por ejemplo: <em>¿cómo nos comunicaremos con el sistema?</em>; y acerca de cómo lo vamos a probar. Así, desde el primer momento la facilidad de prueba es un <em>usuario de pleno derecho</em> de nuestro proyecto.</p></div>
<div class="paragraph"><p>Con esta prueba como guía, nos concentraremos ahora en recorrer todo el sistema, casi a toda velocidad, hasta que la satisfagamos. En el mundo de Java/Scala, la forma típica de resolver esto es con un Servlet. De nuevo comenzamos con una prueba, esta vez a nivel unitario. <span class="footnote"><br>[En este ejemplo hemos usado dobles de prueba para verificar el comportamiento de <span class="monospaced">Converter</span> con sus colaboradores; simplemente estamos comprobando que, cuando llamamos al método <span class="monospaced">doGet()</span> pasando un objeto de tipo <span class="monospaced">HttpServletRequest</span> y otro de tipo <span class="monospaced">HttpServletResponse</span>, el método bajo prueba llama al método <span class="monospaced">getWriter</span> del segundo parámetro y, al devolver <span class="monospaced">getWriter</span> un objeto de tipo <span class="monospaced">PrintWriter</span>, el método bajo prueba llama al método <span class="monospaced">print</span> del <span class="monospaced">PrintWriter</span> con el parámetro <span class="monospaced">"1.609"</span>. Gracias a herramientas como Mockito (<a href="#mockito">[mockito]</a>), que hemos usado en el ejemplo, es más fácil explicar la interacción en código que en español. En <em>Diseño ágil con TDD</em> (<a href="#bleyco-bis">[bleyco-bis]</a>) se explica el uso de dobles y de otros aspectos de la programación dirigida por pruebas.]<br></span></p></div>
<div class="listingblock">
<div class="content"><!-- Generator: GNU source-highlight 3.1.6
by Lorenzo Bettini
http://www.lorenzobettini.it
http://www.gnu.org/software/src-highlite -->
<pre><tt><span style="font-weight: bold"><span style="color: #0000FF">class</span></span> <span style="color: #008080">ConverterTest</span> <span style="font-weight: bold"><span style="color: #0000FF">extends</span></span> FunSuite <span style="color: #FF0000">{</span>
  <span style="font-weight: bold"><span style="color: #000000">test</span></span><span style="color: #990000">(</span><span style="color: #FF0000">"Responds to get requests converting miles into kilometers"</span><span style="color: #990000">)</span> <span style="color: #FF0000">{</span>
    <span style="font-weight: bold"><span style="color: #0000FF">val</span></span> response <span style="font-weight: bold"><span style="color: #0000FF">=</span></span> <span style="font-weight: bold"><span style="color: #000000">mock</span></span><span style="color: #990000">(</span>classOf<span style="color: #990000">[</span>HttpServletResponse<span style="color: #990000">])</span>
    <span style="font-weight: bold"><span style="color: #0000FF">val</span></span> printWriter <span style="font-weight: bold"><span style="color: #0000FF">=</span></span> <span style="font-weight: bold"><span style="color: #000000">mock</span></span><span style="color: #990000">(</span>classOf<span style="color: #990000">[</span>PrintWriter<span style="color: #990000">])</span>
    <span style="font-weight: bold"><span style="color: #000000">when(response.getWriter).thenReturn</span></span><span style="color: #990000">(</span>printWriter<span style="color: #990000">)</span>

    <span style="font-weight: bold"><span style="color: #0000FF">new</span></span> <span style="font-weight: bold"><span style="color: #000000">Converter().doGet(mock</span></span><span style="color: #990000">(</span>classOf<span style="color: #990000">[</span>HttpServletRequest<span style="color: #990000">]),</span> response<span style="color: #990000">)</span>

    <span style="font-weight: bold"><span style="color: #000000">verify(printWriter).print</span></span><span style="color: #990000">(</span><span style="color: #FF0000">"1.609"</span><span style="color: #990000">)</span>
  <span style="color: #FF0000">}</span>
<span style="color: #FF0000">}</span></tt></pre></div><div class="title">Prueba unitaria para el conversor de millas (<a href="https://github.com/emanchado/camino-mejor-programador-codigo/blob/master/tdd/unitconvert/src/test/scala/org/casa/unitconvert/step1/ConverterTest.scala">step1/ConverterTest.scala</a>)</div>
</div>
<div class="paragraph"><p>Un conversor más o menos mínimo usando Jetty viene a ser:</p></div>
<div class="listingblock">
<div class="content"><!-- Generator: GNU source-highlight 3.1.6
by Lorenzo Bettini
http://www.lorenzobettini.it
http://www.gnu.org/software/src-highlite -->
<pre><tt><span style="font-weight: bold"><span style="color: #0000FF">class</span></span> <span style="color: #008080">Converter</span> <span style="font-weight: bold"><span style="color: #0000FF">extends</span></span> HttpServlet <span style="color: #FF0000">{</span>
  <span style="font-weight: bold"><span style="color: #0000FF">override</span></span> <span style="font-weight: bold"><span style="color: #0000FF">def</span></span> <span style="font-weight: bold"><span style="color: #000000">doGet</span></span><span style="color: #990000">(</span>req<span style="font-weight: bold"><span style="color: #0000FF">:</span></span> HttpServletRequest<span style="color: #990000">,</span> resp<span style="font-weight: bold"><span style="color: #0000FF">:</span></span> HttpServletResponse<span style="color: #990000">)</span> <span style="color: #FF0000">{</span>
    <span style="font-weight: bold"><span style="color: #000000">resp.getWriter.print</span></span><span style="color: #990000">(</span><span style="color: #FF0000">"1.609"</span><span style="color: #990000">)</span>
  <span style="color: #FF0000">}</span>
<span style="color: #FF0000">}</span>

<span style="font-weight: bold"><span style="color: #0000FF">object</span></span> Converter <span style="color: #FF0000">{</span>
  <span style="font-weight: bold"><span style="color: #0000FF">def</span></span> <span style="font-weight: bold"><span style="color: #000000">main</span></span><span style="color: #990000">(</span>args<span style="font-weight: bold"><span style="color: #0000FF">:</span></span> Array<span style="color: #990000">[</span>String<span style="color: #990000">])</span><span style="color: #FF0000">{</span>
    <span style="font-weight: bold"><span style="color: #000000">start</span></span><span style="color: #990000">(</span><span style="color: #993399">8080</span><span style="color: #990000">)</span>
  <span style="color: #FF0000">}</span>

  <span style="font-weight: bold"><span style="color: #0000FF">def</span></span> <span style="font-weight: bold"><span style="color: #000000">start</span></span><span style="color: #990000">(</span>port<span style="font-weight: bold"><span style="color: #0000FF">:</span></span> <span style="color: #009900">Int</span><span style="color: #990000">)</span><span style="font-weight: bold"><span style="color: #0000FF">:</span></span> Server <span style="font-weight: bold"><span style="color: #0000FF">=</span></span> <span style="color: #FF0000">{</span>
    <span style="font-weight: bold"><span style="color: #0000FF">val</span></span> context <span style="font-weight: bold"><span style="color: #0000FF">=</span></span> <span style="font-weight: bold"><span style="color: #0000FF">new</span></span> <span style="font-weight: bold"><span style="color: #000000">ServletContextHandler</span></span><span style="color: #990000">()</span>
    <span style="font-weight: bold"><span style="color: #000000">context.setContextPath</span></span><span style="color: #990000">(</span><span style="color: #FF0000">"/"</span><span style="color: #990000">)</span>
    <span style="font-weight: bold"><span style="color: #000000">context.addServlet</span></span><span style="color: #990000">(</span><span style="font-weight: bold"><span style="color: #0000FF">new</span></span> <span style="font-weight: bold"><span style="color: #000000">ServletHolder</span></span><span style="color: #990000">(</span><span style="font-weight: bold"><span style="color: #0000FF">new</span></span> <span style="font-weight: bold"><span style="color: #000000">Converter</span></span><span style="color: #990000">()),</span> <span style="color: #FF0000">"/*"</span><span style="color: #990000">)</span>

    <span style="font-weight: bold"><span style="color: #0000FF">val</span></span> converter <span style="font-weight: bold"><span style="color: #0000FF">=</span></span> <span style="font-weight: bold"><span style="color: #0000FF">new</span></span> <span style="font-weight: bold"><span style="color: #000000">Server</span></span><span style="color: #990000">(</span>port<span style="color: #990000">)</span>
    <span style="font-weight: bold"><span style="color: #000000">converter.setHandler</span></span><span style="color: #990000">(</span>context<span style="color: #990000">)</span>

    <span style="font-weight: bold"><span style="color: #000000">converter.start</span></span><span style="color: #990000">()</span>
    converter
  <span style="color: #FF0000">}</span>
<span style="color: #FF0000">}</span></tt></pre></div><div class="title">Primera implementación del servicio de conversión de millas (<a href="https://github.com/emanchado/camino-mejor-programador-codigo/blob/master/tdd/unitconvert/src/main/scala/org/casa/unitconvert/step1/Converter.scala">step1/Converter.scala</a>)</div>
</div>
<div class="paragraph"><p>Como vemos la funcionalidad que estamos ofreciendo es, como en el ejemplo inicial, trivial. Pero llegar a ella nos ha obligado a definir el esqueleto de todo nuestro sistema, incluyendo código de explotación y de prueba.</p></div>
<div class="paragraph"><p>A continuación progresaremos dependiendo de nuestras prioridades. Por ejemplo, podemos concentrarnos en completar funcionalmente la conversión de millas a kilómetros.</p></div>
<div class="listingblock">
<div class="content"><!-- Generator: GNU source-highlight 3.1.6
by Lorenzo Bettini
http://www.lorenzobettini.it
http://www.gnu.org/software/src-highlite -->
<pre><tt><span style="font-weight: bold"><span style="color: #000000">test</span></span><span style="color: #990000">(</span><span style="color: #FF0000">"Converts negative miles into kilometers"</span><span style="color: #990000">)</span> <span style="color: #FF0000">{</span>
  <span style="font-weight: bold"><span style="color: #000000">get</span></span><span style="color: #990000">(</span><span style="color: #FF0000">"http://localhost:8080/-2.0"</span><span style="color: #990000">)</span> should <span style="font-weight: bold"><span style="color: #000000">be</span></span><span style="color: #990000">(</span><span style="color: #FF0000">"-3.218"</span><span style="color: #990000">)</span>
<span style="color: #FF0000">}</span></tt></pre></div><div class="title">Segunda prueba funcional del conversor de millas (<a href="https://github.com/emanchado/camino-mejor-programador-codigo/blob/master/tdd/unitconvert/src/test/scala/org/casa/unitconvert/step2/functional/ConversionTest.scala">step2/functional/ConversionTest.scala</a>)</div>
</div>
<div class="listingblock">
<div class="content"><!-- Generator: GNU source-highlight 3.1.6
by Lorenzo Bettini
http://www.lorenzobettini.it
http://www.gnu.org/software/src-highlite -->
<pre><tt><span style="font-weight: bold"><span style="color: #0000FF">class</span></span> <span style="color: #008080">Converter</span> <span style="font-weight: bold"><span style="color: #0000FF">extends</span></span> HttpServlet <span style="color: #FF0000">{</span>
  <span style="font-weight: bold"><span style="color: #0000FF">override</span></span> <span style="font-weight: bold"><span style="color: #0000FF">def</span></span> <span style="font-weight: bold"><span style="color: #000000">doGet</span></span><span style="color: #990000">(</span>req<span style="font-weight: bold"><span style="color: #0000FF">:</span></span> HttpServletRequest<span style="color: #990000">,</span> resp<span style="font-weight: bold"><span style="color: #0000FF">:</span></span> HttpServletResponse<span style="color: #990000">)</span> <span style="color: #FF0000">{</span>
    <span style="font-weight: bold"><span style="color: #0000FF">val</span></span> miles <span style="font-weight: bold"><span style="color: #0000FF">=</span></span> <span style="font-weight: bold"><span style="color: #000000">req.getRequestURI.substring</span></span><span style="color: #990000">(</span><span style="color: #993399">1</span><span style="color: #990000">).</span>toDouble
    <span style="font-weight: bold"><span style="color: #000000">resp.getWriter.print</span></span><span style="color: #990000">(</span>miles <span style="color: #990000">*</span> <span style="color: #993399">1.609</span><span style="color: #990000">)</span>
  <span style="color: #FF0000">}</span>
<span style="color: #FF0000">}</span></tt></pre></div><div class="title">Código para la segunda prueba funcional del conversor de millas (<a href="https://github.com/emanchado/camino-mejor-programador-codigo/blob/master/tdd/unitconvert/src/main/scala/org/casa/unitconvert/step2/Converter.scala">step2/Converter.scala</a>)</div>
</div>
<div class="paragraph"><p>A continuación el manejo de los casos de error, como cantidades de millas que no sean numéricas</p></div>
<div class="listingblock">
<div class="content"><!-- Generator: GNU source-highlight 3.1.6
by Lorenzo Bettini
http://www.lorenzobettini.it
http://www.gnu.org/software/src-highlite -->
<pre><tt><span style="font-weight: bold"><span style="color: #000000">test</span></span><span style="color: #990000">(</span><span style="color: #FF0000">"Responds with 400 (Bad Request) and error message to unparseable amounts of miles"</span><span style="color: #990000">)</span> <span style="color: #FF0000">{</span>
  <span style="font-weight: bold"><span style="color: #000000">statusCode</span></span><span style="color: #990000">(</span><span style="color: #FF0000">"http://localhost:8080/blah"</span><span style="color: #990000">)</span> should <span style="font-weight: bold"><span style="color: #000000">be</span></span><span style="color: #990000">(</span><span style="color: #993399">400</span><span style="color: #990000">)</span>
  <span style="font-weight: bold"><span style="color: #000000">get</span></span><span style="color: #990000">(</span><span style="color: #FF0000">"http://localhost:8080/blah"</span><span style="color: #990000">)</span> should <span style="font-weight: bold"><span style="color: #000000">be</span></span><span style="color: #990000">(</span><span style="color: #FF0000">"Miles incorrectly specified: /blah"</span><span style="color: #990000">)</span>
<span style="color: #FF0000">}</span></tt></pre></div><div class="title">Prueba para caso de error del conversor de millas (<a href="https://github.com/emanchado/camino-mejor-programador-codigo/blob/master/tdd/unitconvert/src/test/scala/org/casa/unitconvert/step3/functional/ConversionTest.scala">step3/functional/ConversionTest.scala</a>)</div>
</div>
<div class="listingblock">
<div class="content"><!-- Generator: GNU source-highlight 3.1.6
by Lorenzo Bettini
http://www.lorenzobettini.it
http://www.gnu.org/software/src-highlite -->
<pre><tt><span style="font-weight: bold"><span style="color: #0000FF">class</span></span> <span style="color: #008080">Converter</span> <span style="font-weight: bold"><span style="color: #0000FF">extends</span></span> HttpServlet <span style="color: #FF0000">{</span>
  <span style="font-weight: bold"><span style="color: #0000FF">override</span></span> <span style="font-weight: bold"><span style="color: #0000FF">def</span></span> <span style="font-weight: bold"><span style="color: #000000">doGet</span></span><span style="color: #990000">(</span>req<span style="font-weight: bold"><span style="color: #0000FF">:</span></span> HttpServletRequest<span style="color: #990000">,</span> resp<span style="font-weight: bold"><span style="color: #0000FF">:</span></span> HttpServletResponse<span style="color: #990000">)</span> <span style="color: #FF0000">{</span>
    <span style="font-weight: bold"><span style="color: #0000FF">val</span></span> milesAsString <span style="font-weight: bold"><span style="color: #0000FF">=</span></span> <span style="font-weight: bold"><span style="color: #000000">req.getRequestURI.substring</span></span><span style="color: #990000">(</span><span style="color: #993399">1</span><span style="color: #990000">)</span>
    <span style="font-weight: bold"><span style="color: #0000FF">try</span></span> <span style="color: #FF0000">{</span>
      <span style="font-weight: bold"><span style="color: #0000FF">val</span></span> miles <span style="font-weight: bold"><span style="color: #0000FF">=</span></span> milesAsString<span style="color: #990000">.</span>toDouble
      <span style="font-weight: bold"><span style="color: #000000">resp.getWriter.print</span></span><span style="color: #990000">(</span>miles <span style="color: #990000">*</span> <span style="color: #993399">1.609</span><span style="color: #990000">)</span>
    <span style="color: #FF0000">}</span>
    <span style="font-weight: bold"><span style="color: #0000FF">catch</span></span> <span style="color: #FF0000">{</span>
      <span style="font-weight: bold"><span style="color: #0000FF">case</span></span> <span style="font-weight: bold"><span style="color: #0000FF">_:</span></span> NumberFormatException <span style="font-weight: bold"><span style="color: #0000FF">=&gt;</span></span> <span style="color: #FF0000">{</span>
        <span style="font-weight: bold"><span style="color: #000000">resp.setStatus</span></span><span style="color: #990000">(</span>HttpServletResponse<span style="color: #990000">.</span>SC<span style="font-weight: bold"><span style="color: #0000FF">_</span></span>BAD<span style="font-weight: bold"><span style="color: #0000FF">_</span></span>REQUEST<span style="color: #990000">)</span>
        <span style="font-weight: bold"><span style="color: #000000">resp.getWriter.print</span></span><span style="color: #990000">(</span><span style="color: #FF0000">"Miles incorrectly specified: "</span> <span style="color: #990000">+</span> req<span style="color: #990000">.</span>getRequestURI<span style="color: #990000">)</span>
      <span style="color: #FF0000">}</span>
    <span style="color: #FF0000">}</span>
  <span style="color: #FF0000">}</span>
<span style="color: #FF0000">}</span></tt></pre></div><div class="title">Código de manejo de errores para el conversor de millas (<a href="https://github.com/emanchado/camino-mejor-programador-codigo/blob/master/tdd/unitconvert/src/main/scala/org/casa/unitconvert/step3/Converter.scala">step3/Converter.scala</a>)</div>
</div>
<div class="paragraph"><p>Además de los pasos <em>rojos</em> y <em>verdes</em> que hemos visto en el ejemplo hasta ahora, a medida que la aplicación va creciendo, debemos tanto refactorizar a nivel unitario como ir mejorando el diseño; por ejemplo, si en los próximos pasos la aplicación necesitase responder a distintas rutas con distintas conversiones, probablemente decidiríamos extraer el análisis de las URIs a una unidad independiente e introduciríamos distintos objetos a los que delegar dependiendo del tipo de conversión.</p></div>
</div>
</div>
<div class="sect2">
<h3 id="_probar_una_sola_cosa_a_la_vez">Probar una sola cosa a la vez</h3>
<div class="paragraph"><p>El mantenimiento de la batería de pruebas, que crece con la aplicación, requiere una inversión de esfuerzo constante; hacer que cada prueba verifique únicamente un aspecto de la aplicación nos ayudará a mantener este esfuerzo manejable y además las hará más fáciles de entender, y por lo tanto más eficientes. Idealmente, el cambio de un detalle del funcionamiento de nuestra aplicación debería afectar exclusivamente a una prueba que sólo verifica ese detalle, o, dicho de otra manera:</p></div>
<div class="ulist"><ul>
<li>
<p>
si es relativamente fácil cambiar un cierto aspecto del funcionamiento sin que falle ninguna prueba, tenemos una laguna en la cobertura de la batería; <span class="footnote"><br>[El tipo de pruebas con las que guiamos el desarrollo en este artículo documentan el comportamiento con buenos ejemplos, pero generalmente no lo garantizan para todas las posibles entradas, ni aspiran a hacerlo; por lo tanto, normalmente es muy fácil cambiar el comportamiento de forma intencionada sin que las pruebas dejen de satisfacerse &#8212;por ejemplo, con algo como <span class="monospaced">if(input==15) throw new EasterEgg</span>&#8212;; una buena cobertura en TDD está en el punto de equilibrio en el que sea poco probable cambiar la funcionalidad accidentalmente sin que fallen las pruebas.]<br></span>
</p>
</li>
<li>
<p>
si falla más de una, la batería tiene código redundante, incrementando el coste de mantenimiento;
</p>
</li>
<li>
<p>
si la prueba que falla incluye la verificación de elementos que no están directamente relacionados con nuestro cambio, probablemente sea demasiado compleja, dado que introducir el cambio en el sistema requiere tener en cuenta aspectos independientes de la aplicación.
</p>
</li>
</ul></div>
<div class="sect3">
<h4 id="_ejemplo_de_pruebas_centradas">Ejemplo de pruebas centradas</h4>
<div class="paragraph"><p>Volvamos a donde dejamos el ejemplo del traductor y supongamos que lo siguiente que queremos hacer es separar las palabras del texto original no sólo mediante espacios, sino también mediante cambios de línea. Como estamos guiando los cambios con pruebas, añadimos a <span class="monospaced">SpanishIntoEnglishTranslatorTest</span> una prueba que verifique el nuevo funcionamiento.</p></div>
<div class="listingblock">
<div class="content"><!-- Generator: GNU source-highlight 3.1.6
by Lorenzo Bettini
http://www.lorenzobettini.it
http://www.gnu.org/software/src-highlite -->
<pre><tt><span style="font-weight: bold"><span style="color: #000000">test</span></span><span style="color: #990000">(</span><span style="color: #FF0000">"splits by change of line"</span><span style="color: #990000">)</span> <span style="color: #FF0000">{</span>
  <span style="font-weight: bold"><span style="color: #000000">translator.translate</span></span><span style="color: #990000">(</span><span style="color: #FF0000">"yo</span><span style="color: #CC33CC">\n</span><span style="color: #FF0000">soy"</span><span style="color: #990000">)</span> should <span style="font-weight: bold"><span style="color: #000000">be</span></span><span style="color: #990000">(</span><span style="color: #FF0000">"I am"</span><span style="color: #990000">)</span>
<span style="color: #FF0000">}</span></tt></pre></div><div class="title">Ejemplo de prueba no centrada</div>
</div>
<div class="paragraph"><p>El problema que tiene esto es que la prueba mezcla la separación del texto original y la traducción de las palabras; la idea que queremos transmitir con este ejemplo estaría más clara si pudiéramos expresar la entrada como <span class="monospaced">"xxx\nxx"</span> y la condición a cumplir como <span class="monospaced">should be(Seq("xxx", "xx"))</span>; sin embargo, la forma actual del sistema no lo permite, porque la traducción es parte del método que estamos probando.</p></div>
<div class="paragraph"><p>Supongamos además que el siguiente incremento funcional afectase a la traducción de palabras en sí, por ejemplo, cambiando el idioma origen al francés o a otra variante del español; este cambio afectaría a cada una de las pruebas de <span class="monospaced">SpanishIntoEnglishTranslatorTest</span>, pero, ¿por qué debería verse afectada una prueba como <span class="monospaced">test("splits by change of line")</span>, cuyo propósito es probar la separación en palabras?</p></div>
<div class="paragraph"><p>Podemos ver estas deficiencias de nuestra batería como el resultado de una granularidad inapropiada, dado que la misma prueba está verificando varias cosas: separación, traducción y reunión de palabras. La solución consistiría en refactorizar antes de aplicar el cambio: ¿Quizá la clase que se encarga de descomponer y componer debería ser distinta de la que traduzca palabra por palabra?</p></div>
<div class="paragraph"><p>Extraemos la división de palabras a su propia unidad, con lo que podemos expresar, con una prueba más centrada, la división del texto a traducir por saltos de línea:</p></div>
<div class="listingblock">
<div class="content"><!-- Generator: GNU source-highlight 3.1.6
by Lorenzo Bettini
http://www.lorenzobettini.it
http://www.gnu.org/software/src-highlite -->
<pre><tt><span style="font-weight: bold"><span style="color: #0000FF">class</span></span> <span style="color: #008080">SplitterTest</span> <span style="font-weight: bold"><span style="color: #0000FF">extends</span></span> FunSuite <span style="font-weight: bold"><span style="color: #0000FF">with</span></span> ShouldMatchers <span style="color: #FF0000">{</span>
  <span style="font-weight: bold"><span style="color: #000000">test</span></span><span style="color: #990000">(</span><span style="color: #FF0000">"splits by space"</span><span style="color: #990000">)</span> <span style="color: #FF0000">{</span>
    <span style="font-weight: bold"><span style="color: #000000">Splitter</span></span><span style="color: #990000">(</span><span style="color: #FF0000">"xxx xx"</span><span style="color: #990000">)</span> should <span style="font-weight: bold"><span style="color: #000000">be(Seq</span></span><span style="color: #990000">(</span><span style="color: #FF0000">"xxx"</span><span style="color: #990000">,</span> <span style="color: #FF0000">"xx"</span><span style="color: #990000">))</span>
  <span style="color: #FF0000">}</span>

  <span style="font-weight: bold"><span style="color: #000000">test</span></span><span style="color: #990000">(</span><span style="color: #FF0000">"splits by change of line"</span><span style="color: #990000">)</span> <span style="color: #FF0000">{</span>
    <span style="font-weight: bold"><span style="color: #000000">Splitter</span></span><span style="color: #990000">(</span><span style="color: #FF0000">"xxx</span><span style="color: #CC33CC">\n</span><span style="color: #FF0000">xx"</span><span style="color: #990000">)</span> should <span style="font-weight: bold"><span style="color: #000000">be(Seq</span></span><span style="color: #990000">(</span><span style="color: #FF0000">"xxx"</span><span style="color: #990000">,</span> <span style="color: #FF0000">"xx"</span><span style="color: #990000">))</span>
  <span style="color: #FF0000">}</span>
<span style="color: #FF0000">}</span></tt></pre></div><div class="title">Prueba del divisor de palabras (<a href="https://github.com/emanchado/camino-mejor-programador-codigo/blob/master/tdd/tdd-examples/src/test/scala/org/casa/translation/example3/SplitterTest.scala">example3/SplitterTest.scala</a>)</div>
</div>
<div class="listingblock">
<div class="content"><!-- Generator: GNU source-highlight 3.1.6
by Lorenzo Bettini
http://www.lorenzobettini.it
http://www.gnu.org/software/src-highlite -->
<pre><tt><span style="font-weight: bold"><span style="color: #0000FF">object</span></span> Splitter <span style="font-weight: bold"><span style="color: #0000FF">extends</span></span> <span style="color: #990000">((</span>String<span style="color: #990000">)</span> <span style="font-weight: bold"><span style="color: #0000FF">=&gt;</span></span> Seq<span style="color: #990000">[</span>String<span style="color: #990000">])</span> <span style="color: #FF0000">{</span>
  <span style="font-weight: bold"><span style="color: #0000FF">def</span></span> <span style="font-weight: bold"><span style="color: #000000">apply</span></span><span style="color: #990000">(</span>s<span style="font-weight: bold"><span style="color: #0000FF">:</span></span> String<span style="color: #990000">)</span><span style="font-weight: bold"><span style="color: #0000FF">:</span></span> Seq<span style="color: #990000">[</span>String<span style="color: #990000">]</span> <span style="font-weight: bold"><span style="color: #0000FF">=</span></span> s split <span style="color: #FF0000">"""[ </span><span style="color: #CC33CC">\n</span><span style="color: #FF0000">]"""</span>
<span style="color: #FF0000">}</span></tt></pre></div><div class="title">Código para el divisor de palabras (<a href="https://github.com/emanchado/camino-mejor-programador-codigo/blob/master/tdd/tdd-examples/src/main/scala/org/casa/translation/example3/Splitter.scala">example3/Splitter.scala</a>)</div>
</div>
<div class="paragraph"><p>El traductor lo recibe como una dependencia inyectada mediante el constructor. <span class="footnote"><br>[En este ejemplo nos hemos quedado con pruebas que ejercitan las unidades unidades independientemente; perdiendo la cobertura de la combinación de ambas unidades. Sin embargo, en la práctica, este código formaría parte de un proyecto mayor que contaría con baterías de pruebas de mayor ámbito, que incluirían la verificación del comportamiento conjunto.]<br></span></p></div>
<div class="listingblock">
<div class="content"><!-- Generator: GNU source-highlight 3.1.6
by Lorenzo Bettini
http://www.lorenzobettini.it
http://www.gnu.org/software/src-highlite -->
<pre><tt><span style="font-weight: bold"><span style="color: #0000FF">class</span></span> <span style="color: #008080">SpanishIntoEnglishTranslatorTest</span>
    <span style="font-weight: bold"><span style="color: #0000FF">extends</span></span> FunSuite <span style="font-weight: bold"><span style="color: #0000FF">with</span></span> ShouldMatchers <span style="font-weight: bold"><span style="color: #0000FF">with</span></span> BeforeAndAfter <span style="color: #FF0000">{</span>

  <span style="font-weight: bold"><span style="color: #0000FF">var</span></span> translator<span style="font-weight: bold"><span style="color: #0000FF">:</span></span> SpanishIntoEnglishTranslator <span style="font-weight: bold"><span style="color: #0000FF">=</span></span> <span style="font-weight: bold"><span style="color: #0000FF">_</span></span>

  before <span style="color: #FF0000">{</span>
    translator <span style="font-weight: bold"><span style="color: #0000FF">=</span></span> <span style="font-weight: bold"><span style="color: #0000FF">new</span></span> <span style="font-weight: bold"><span style="color: #000000">SpanishIntoEnglishTranslator</span></span><span style="color: #990000">(</span><span style="font-weight: bold"><span style="color: #0000FF">_</span></span> split <span style="color: #FF0000">' '</span><span style="color: #990000">)</span>
  <span style="color: #FF0000">}</span>

  <span style="font-weight: bold"><span style="color: #000000">test</span></span><span style="color: #990000">(</span><span style="color: #FF0000">"translates what it can"</span><span style="color: #990000">)</span> <span style="color: #FF0000">{</span>
    <span style="font-weight: bold"><span style="color: #000000">translator.translate</span></span><span style="color: #990000">(</span><span style="color: #FF0000">"yo soy"</span><span style="color: #990000">)</span> should <span style="font-weight: bold"><span style="color: #000000">be</span></span><span style="color: #990000">(</span><span style="color: #FF0000">"I am"</span><span style="color: #990000">)</span>
  <span style="color: #FF0000">}</span>

  <span style="font-weight: bold"><span style="color: #000000">test</span></span><span style="color: #990000">(</span><span style="color: #FF0000">"mmmehs what it can't"</span><span style="color: #990000">)</span> <span style="color: #FF0000">{</span>
    <span style="font-weight: bold"><span style="color: #000000">translator.translate</span></span><span style="color: #990000">(</span><span style="color: #FF0000">"dame argo"</span><span style="color: #990000">)</span> should <span style="font-weight: bold"><span style="color: #000000">be</span></span><span style="color: #990000">(</span><span style="color: #FF0000">"mmmeh mmmeh"</span><span style="color: #990000">)</span>
  <span style="color: #FF0000">}</span>
<span style="color: #FF0000">}</span></tt></pre></div><div class="title">Pruebas para un traductor desacoplado del divisor de palabras (<a href="https://github.com/emanchado/camino-mejor-programador-codigo/blob/master/tdd/tdd-examples/src/test/scala/org/casa/translation/example3/SpanishIntoEnglishTranslatorTest.scala">example3/SpanishIntoEnglishTranslatorTest.scala</a>)</div>
</div>
<div class="listingblock">
<div class="content"><!-- Generator: GNU source-highlight 3.1.6
by Lorenzo Bettini
http://www.lorenzobettini.it
http://www.gnu.org/software/src-highlite -->
<pre><tt><span style="font-weight: bold"><span style="color: #0000FF">class</span></span> <span style="color: #008080">SpanishIntoEnglishTranslator</span><span style="color: #990000">(</span><span style="font-weight: bold"><span style="color: #0000FF">val</span></span> <span style="font-weight: bold"><span style="color: #000000">splitter:</span></span> <span style="color: #990000">(</span>String<span style="color: #990000">)</span> <span style="font-weight: bold"><span style="color: #0000FF">=&gt;</span></span> Seq<span style="color: #990000">[</span>String<span style="color: #990000">])</span> <span style="color: #FF0000">{</span>
  <span style="font-weight: bold"><span style="color: #0000FF">def</span></span> <span style="font-weight: bold"><span style="color: #000000">translate</span></span><span style="color: #990000">(</span>spanish<span style="font-weight: bold"><span style="color: #0000FF">:</span></span> String<span style="color: #990000">)</span><span style="font-weight: bold"><span style="color: #0000FF">:</span></span> String <span style="font-weight: bold"><span style="color: #0000FF">=</span></span> <span style="color: #FF0000">{</span>
    <span style="font-weight: bold"><span style="color: #0000FF">val</span></span> split <span style="font-weight: bold"><span style="color: #0000FF">=</span></span> <span style="font-weight: bold"><span style="color: #000000">splitter</span></span><span style="color: #990000">(</span>spanish<span style="color: #990000">)</span>
    <span style="font-weight: bold"><span style="color: #000000">split.map</span></span><span style="color: #990000">(</span><span style="font-weight: bold"><span style="color: #0000FF">_</span></span> <span style="font-weight: bold"><span style="color: #0000FF">match</span></span> <span style="color: #FF0000">{</span>
      <span style="font-weight: bold"><span style="color: #0000FF">case</span></span> <span style="color: #FF0000">"yo"</span> <span style="font-weight: bold"><span style="color: #0000FF">=&gt;</span></span> <span style="color: #FF0000">"I"</span>
      <span style="font-weight: bold"><span style="color: #0000FF">case</span></span> <span style="color: #FF0000">"soy"</span> <span style="font-weight: bold"><span style="color: #0000FF">=&gt;</span></span> <span style="color: #FF0000">"am"</span>
      <span style="font-weight: bold"><span style="color: #0000FF">case</span></span> <span style="font-weight: bold"><span style="color: #0000FF">_</span></span> <span style="font-weight: bold"><span style="color: #0000FF">=&gt;</span></span> <span style="color: #FF0000">"mmmeh"</span>
    <span style="color: #FF0000">}</span><span style="color: #990000">).</span><span style="font-weight: bold"><span style="color: #000000">mkString</span></span><span style="color: #990000">(</span><span style="color: #FF0000">" "</span><span style="color: #990000">)</span>
  <span style="color: #FF0000">}</span>
<span style="color: #FF0000">}</span></tt></pre></div><div class="title">Código del traductor desacoplado del divisor de palabras (<a href="https://github.com/emanchado/camino-mejor-programador-codigo/blob/master/tdd/tdd-examples/src/main/scala/org/casa/translation/example3/SpanishIntoEnglishTranslator.scala">example3/SpanishIntoEnglishTranslator.scala</a>)</div>
</div>
<div class="paragraph"><p>El aumento de la granularidad nos ha permitido que la introducción de funcionalidad nueva no afecte a multitud de pruebas. Sin embargo, esto no ha sido gratis; hemos aumentado la complejidad del código. Al final, todas estas decisiones hay que valorarlas una a una y decidir qué es lo más apropiado en cada caso, teniendo en cuenta aspectos como la complejidad, el tiempo de ejecución y la dirección en la que esperamos y queremos que vaya el proyecto.</p></div>
</div>
</div>
<div class="sect2">
<h3 id="_mantener_verde_la_batería">Mantener verde la batería</h3>
<div class="paragraph"><p>La batería de pruebas es la documentación de la funcionalidad de nuestro código. Una documentación que se mantiene al día, porque va creciendo con cada cambio y es ejercitada, es decir, ejecutamos las pruebas, al menos con cada envío de los cambios al repositorio.</p></div>
<div class="paragraph"><p>Trabajar dirigido por pruebas significa mantener siempre el correcto funcionamiento del sistema; idealmente la última versión en el repositorio común deberá estar en todo momento lista para ponerla en explotación, y las pruebas satisfechas en todo momento <span class="footnote"><br>[De hecho, algunos equipos hacen exactamente eso, ponen cada versión que satisface la batería completa automáticamente en explotación.]<br></span>, con lo que la documentación proporcionada por las pruebas estará siempre al día. Para lograrlo, deberemos comprobar la satisfacción de las pruebas antes de enviar cualquier cambio al repositorio común; además, muchos equipos se ayudan de un sistema de integración continua que verifica automáticamente la batería cada vez que se detecta un cambio en el repositorio.</p></div>
<div class="paragraph"><p>A medida que crece la aplicación, el tiempo que requiere la batería completa tiende a aumentar, lo que incrementa el coste del desarrollo y motiva a los desarrolladores a no siempre satisfacer la batería completa o a espaciar los envíos de cambios al repositorio común; ambos efectos muy perniciosos. Para mantener viable la programación dirigida por pruebas, debemos esforzarnos en mantener reducido este tiempo; la manera de lograrlo va más allá de un artículo introductorio, pero incluye la selección y el ajuste de la tecnología empleada para los distintos elementos de la batería, la ejecución en paralelo e incluso la partición de la aplicación en sí o cualquier ajuste que la haga más rápida.<span class="footnote"><br>[Otra forma de reducir el tiempo es transigiendo en alguna medida, es decir, no cumpliendo en ocasiones todo lo que describimos en este artículo.]<br></span></p></div>
<div class="paragraph"><p>Otro problema relacionado con el coste de la batería son los fallos intermitentes, que necesitarán un esfuerzo importante de mantenimiento; hemos de invertir el esfuerzo necesario para entender la raíz de cada fallo y resolverlo. Las fuentes típicas de fallos intermitentes son los aspectos no deterministas del software; por ejemplo, cuando lo que verificamos es de naturaleza asíncrona, necesitamos controlar el estado de la aplicación mediante puntos de sincronización. Algunas condiciones son imposibles de verificar per se, como la ausencia de comportamiento; en estos casos a menudo la solución pasa por alterar la aplicación desvelando su estado lo suficiente como para que las pruebas puedan sincronizarse con la aplicación y sepan cuándo debería haber tenido lugar el evento que estemos verificando. También suelen causar fallos intermitentes las dependencias de elementos fuera del control de la prueba, como el reloj del sistema; y su solución pasa normalmente por la inclusión y el control de dicho elemento desde la prueba, por ejemplo, alterando la percepción del tiempo de la aplicación mediante un <em>proxy</em> controlable desde las pruebas.</p></div>
</div>
<div class="sect2">
<h3 id="_críticas">Críticas</h3>
<div class="sect3">
<h4 id="_diseño_prematuro">Diseño prematuro</h4>
<div class="paragraph"><p>El ejemplo de pruebas centradas ilustra también una de las principales críticas contra el desarrollo dirigido por pruebas: para poder probar la clase de traducción satisfactoriamente, la hemos descompuesto en un diccionario y un desensamblador/ensamblador de palabras; sin embargo, si de verdad fuéramos a diseñar un sistema de traducción automatizada esta abstracción no sería apropiada, ya que el diccionario necesita el contexto, la disposición de palabras en el texto resultante depende de la función gramatical, etc. ¿Significa esto que el TDD nos ha guiado en la dirección incorrecta?</p></div>
<div class="paragraph"><p>Como dijimos antes, desarrollar dirigidos por pruebas significa considerar las pruebas como usuarios de pleno derecho de nuestro código, añadiendo, así, un coste en cantidad de código y en la complejidad del diseño que elegimos pagar para beneficiarnos de la guía de las pruebas; optar por el TDD es considerar que este coste vale la pena. Sería menos costoso desarrollar sin la guía de las pruebas si supiésemos exactamente cuáles son los requisitos e incluso qué código escribir desde el principio. El TDD se opone a esta visión considerando el desarrollo como un proceso progresivo en el que el equipo va descubriendo <em>qué</em> y <em>cómo</em> desarrollar, a medida que crea la aplicación y la va poco a poco transformando, enriqueciendo y simplificando, pasando siempre de un sistema que funciona a un otro sistema que funciona, y que hace quizá un poco más que el anterior.</p></div>
<div class="paragraph"><p>Volviendo a la prematuridad del diseño, si bien es cierto que las pruebas a veces adelantan la necesidad de descomponer el código, estas decisiones se vuelven más baratas dado que los cambios en el diseños son menos costosos gracias a la protección que nos da nuestra batería. Y, además, esto se ve también compensado por las innumerables ocasiones en las que no añadiremos complejidad al código de explotación porque esa complejidad no es necesaria para satisfacer las pruebas, probablemente porque no lo es en absoluto para lo que requerimos de nuestra aplicación en ese momento.</p></div>
</div>
<div class="sect3">
<h4 id="_guiar_sólo_mediante_pruebas_funcionales">Guiar sólo mediante pruebas funcionales</h4>
<div class="paragraph"><p>Algunos equipos experimentados deciden utilizar las pruebas para guiar el desarrollo a nivel funcional, pero no a nivel unitario, sólo escribiendo pruebas unitarias cuando no resulta práctico cubrir con pruebas funcionales ciertas partes del código. Esto lo hacen porque ven las pruebas unitarias más como un lastre que como una guía útil en el diseño interno de la aplicación, quizá porque consideran que su criterio es suficiente para lograr un buen diseño interno. Nuestra recomendación es comenzar guiando todas las unidades por pruebas y progresar hacia un equilibrio en el que no probemos a nivel unitario el código que sea obvio, pero donde reconozcamos que el código que no merece la pena guiar mediante pruebas por ser obvio probablemente es poco útil <span class="footnote"><br>[En algunos casos, debido a una convención sospechosa o a las limitaciones de nuestro lenguaje de programación &#8212;por ejemplo, los métodos <em>set</em> y <em>get</em> en Java&#8212;.]<br></span>, y que el que es difícil de probar probablemente peca de acoplado. La recomendación es, en definitiva, aplicar el sentido común pero no renunciar a la guía que nos proporcionan las pruebas en el desarrollo de los niveles inferiores de la aplicación.</p></div>
</div>
</div>
<div class="sect2">
<h3 id="_conclusión_4">Conclusión</h3>
<div class="paragraph"><p>El desarrollo dirigido por pruebas nos ayuda a construir aplicaciones donde aquello que nos motiva a escribir el software guía cada línea de código, evitando a cada nivel desperdiciar nuestros esfuerzos en desarrollar funcionalidad que no sea exactamente la que necesitamos, o que sea simplemente innecesaria. La guía de las pruebas, combinada con el diseño continuo, hace posible un estilo de desarrollo orgánico, en el que el equipo evoluciona la aplicación, a medida que mejora su conocimiento de los requisitos del dominio y de la implementación ideal para resolverlos. Además, la utilización de pruebas desde el primer momento, desvela el acoplamiento y nos incita a descomponer el código en unidades cohesivas con depencias claramente identificadas.</p></div>
<div class="paragraph"><p>Si bien no hay un concenso absoluto en la idoneidad del desarrollo guiado por pruebas, muchos equipos lo usan, particularmente para aplicaciones comerciales y en lenguajes orientados a objetos. Nuestra opinión es que, además de dar sentido y ritmo a cada actividad del desarrollo, lo hace más divertido, porque da al desarrollador más libertad para mejorar y acrecentar el software.</p></div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_bibliografía">Bibliografía</h2>
<div class="sectionbody">
<div class="ulist bibliography"><div class="title">Lecciones de aprender un lenguaje funcional</div><ul>
<li>
<p>
<a id="onlisp"></a>[onlisp] Paul Graham. «On Lisp». Prentice Hall. ISBN 0130305529.
  <a href="http://www.paulgraham.com/onlisp.html">http://www.paulgraham.com/onlisp.html</a>
</p>
</li>
<li>
<p>
<a id="landoflisp"></a>[landoflisp] Conrad Barski. «Land of Lisp». No Starch Press. ISBN
  978-1-59327-281-4. <a href="http://landoflisp.com/">http://landoflisp.com/</a>
</p>
</li>
<li>
<p>
<a id="learnhaskell"></a>[learnhaskell] Miran Lipovača. «Learn You a Haskell for Great Good!». No
  Starch Press. ISBN 978-1-59327-283-8. <a href="http://learnyouahaskell.com/">http://learnyouahaskell.com/</a>
</p>
</li>
<li>
<p>
<a id="progscala"></a>[progscala] Dean Wampler y Alex Payne. «Programming Scala». O&#8217;Reilly
  Media.  ISBN 978-0-596-15595-7. <a href="http://ofps.oreilly.com/titles/9780596155957/">http://ofps.oreilly.com/titles/9780596155957/</a>
</p>
</li>
<li>
<p>
<a id="proginscala"></a>[proginscala] Martin Odersky, Lex Spoon, y Bill Venners. «Programming in
  Scala». Artima.  ISBN 9780981531601.  <a href="http://www.artima.com/pins1ed/">http://www.artima.com/pins1ed/</a>
</p>
</li>
<li>
<p>
<a id="jsfuncional"></a>[jsfuncional] Dmitry A. Soshnikov. «JavaScript array "extras" in detail».
  <a href="http://dev.opera.com/articles/view/javascript-array-extras-in-detail/">http://dev.opera.com/articles/view/javascript-array-extras-in-detail/</a>
</p>
</li>
</ul></div>
<div class="ulist bibliography"><div class="title">Documentación activa</div><ul>
<li>
<p>
<a id="goos"></a>[goos] Steve Freeman y Nat Price. «Growing Object-Oriented Software
  Guided by Tests». Addison-Wesley Professional. ISBN 978-0321503626.
  <a href="http://www.growing-object-oriented-software.com/">http://www.growing-object-oriented-software.com/</a>
</p>
</li>
<li>
<p>
<a id="concordion"></a>[concordion] David Peterson. «Concordion». <a href="http://concordion.org/">http://concordion.org/</a>
</p>
</li>
<li>
<p>
<a id="xcordion"></a>[xcordion] Robert Pelkey. «XCordion» (clon de Concordion). <a href="http://code.google.com/p/xcordion/">http://code.google.com/p/xcordion/</a>
</p>
</li>
<li>
<p>
<a id="bridging"></a>[bridging] Gojko Adzic. «Bridging the Communication Gap». Neuri Limited. 978-0955683619. <a href="http://www.acceptancetesting.info/the-book/">http://www.acceptancetesting.info/the-book/</a>
</p>
</li>
</ul></div>
<div class="ulist bibliography"><div class="title">Siete problemas al probar programas</div><ul>
<li>
<p>
<a id="pseudocode"></a>[pseudocode] Esteban Manchado Velázquez. «From pseudo-code to code».
  <a href="http://hcoder.org/2010/08/10/from-pseudo-code-to-code/">http://hcoder.org/2010/08/10/from-pseudo-code-to-code/</a>
</p>
</li>
<li>
<p>
<a id="testing123"></a>[testing123] Esteban Manchado Velázquez. «Software automated testing 123».
  <a href="http://www.demiurgo.org/charlas/testing-123/">http://www.demiurgo.org/charlas/testing-123/</a>
</p>
</li>
<li>
<p>
<a id="fowlerci"></a>[fowlerci] Martin Fowler. «Continuous Integration».
  <a href="http://www.martinfowler.com/articles/continuousIntegration.html">http://www.martinfowler.com/articles/continuousIntegration.html</a>
</p>
</li>
<li>
<p>
<a id="kivaapi"></a>[kivaapi] API pública de Kiva. <a href="http://build.kiva.org/docs/">http://build.kiva.org/docs/</a>
</p>
</li>
<li>
<p>
<a id="loanmeter"></a>[loanmeter] Esteban Manchado Velázquez. «World Loanmeter».
  <a href="https://github.com/emanchado/world-loanmeter">https://github.com/emanchado/world-loanmeter</a>
</p>
</li>
<li>
<p>
<a id="jasmine"></a>[jasmine] Página web de Jasmine, un módulo de pruebas para Javascript.
  <a href="http://pivotal.github.com/jasmine/">http://pivotal.github.com/jasmine/</a>
</p>
</li>
<li>
<p>
<a id="pydoubles"></a>[pydoubles] PyDoubles Test doubles framework. <a href="http://www.pydoubles.org/">http://www.pydoubles.org/</a>
</p>
</li>
</ul></div>
<div class="ulist bibliography"><div class="title">Calidad en software</div><ul>
<li>
<p>
<a id="technopoly"></a>[technopoly] Neil Postman. «Technopoly». Random House USA Inc.  ISBN
  9780679745402.
</p>
</li>
<li>
<p>
<a id="theletter"></a>[theletter] Uncle Bob. «The Letter».
  <a href="http://blog.8thlight.com/uncle-bob/2012/01/12/The-Letter.html">http://blog.8thlight.com/uncle-bob/2012/01/12/The-Letter.html</a>
</p>
</li>
<li>
<p>
<a id="obliquestrategies"></a>[obliquestrategies] Brian Eno y Peter Schmidt. «Oblique Strategies».
  <a href="http://en.wikipedia.org/wiki/Oblique_Strategies">http://en.wikipedia.org/wiki/Oblique_Strategies</a>
</p>
</li>
<li>
<p>
<a id="broken"></a>[broken] Seth Godin. «This is broken» (TED Talk).
  <a href="http://www.ted.com/talks/seth_godin_this_is_broken_1.html">http://www.ted.com/talks/seth_godin_this_is_broken_1.html</a>
</p>
</li>
<li>
<p>
<a id="livingcomplexity"></a>[livingcomplexity] Donald A. Norman. «Living with Complexity». The MIT
  Press. ISBN 9780262014861.
</p>
</li>
</ul></div>
<div class="ulist bibliography"><div class="title">Integración continua</div><ul>
<li>
<p>
<a id="continuosintegration"></a>[continuosintegration] Paul M Duvall. «Continuos Integration: Improving
  Software Quality and Reducing Risk». Addison-Wesley Professional. ISBN 978-0321336385
</p>
</li>
<li>
<p>
<a id="continuosdelivery"></a>[continuosdelivery] Jez Humble y David Farley. «Continuos Delivery».
  Addison-Wesley Professional. ISBN 978-0321601919
</p>
</li>
<li>
<p>
<a id="fowlerci-bis"></a>[fowlerci-bis] Martin Fowler. «Continuous Integration».
  <a href="http://www.martinfowler.com/articles/continuousIntegration.html">http://www.martinfowler.com/articles/continuousIntegration.html</a>
</p>
</li>
<li>
<p>
<a id="xpexplained"></a>[xpexplained] Kent Beck y Cynthia Andres. «Extreme Programming Explained:
  Embrace Change». Addison-Wesley Professional. ISBN 978-0321278654
</p>
</li>
<li>
<p>
<a id="bleyco"></a>[bleyco] Carlos Blé Jurado. «Diseño ágil con TDD». ISBN 978-1445264714. <a href="http://dirigidoportests.com/el-libro">http://dirigidoportests.com/el-libro</a>
</p>
</li>
<li>
<p>
<a id="xunit"></a>[xunit] Wikipedia. «Frameworks xUnit». <a href="http://en.wikipedia.org/wiki/XUnit">http://en.wikipedia.org/wiki/XUnit</a>
</p>
</li>
</ul></div>
<div class="ulist bibliography"><div class="title">Desarrollo dirigido por pruebas</div><ul>
<li>
<p>
<a id="tddbyexample"></a>[tddbyexample] Kent Beck. «Test Driven Development: By example». Addison Wesley. ISBN 978-0321146533.
</p>
</li>
<li>
<p>
<a id="tddequality"></a>[tddequality] Kent Beck. «Test Driven Development: Equality for All». InformIT. <a href="http://www.informit.com/articles/article.aspx?p=30641">http://www.informit.com/articles/article.aspx?p=30641</a>
</p>
</li>
<li>
<p>
<a id="goos-bis"></a>[goos-bis] Steve Freeman y Nat Pryce. «Growing Object-Oriented Software Guided by Tests». Addison-Wesley Professional. ISBN 978-0321503626.
</p>
</li>
<li>
<p>
<a id="mockito"></a>[mockito] Szczepan Faber and friends. «Mockito: simpler &amp; better mocking» (sitio del proyecto). <a href="http://code.google.com/p/mockito/">http://code.google.com/p/mockito/</a>
</p>
</li>
<li>
<p>
<a id="bleyco-bis"></a>[bleyco-bis] Carlos Blé Jurado. «Diseño ágil con TDD». ISBN 978-1445264714. <a href="http://dirigidoportests.com/el-libro">http://dirigidoportests.com/el-libro</a>
</p>
</li>
</ul></div>
</div>
</div>
</div>
<div id="footnotes"><hr></div>
<div id="footer">
<div id="footer-text">
<a href="https://www.assembla.com/code/proyecto-libro/git/changesets/0688b6e5a14acb4deb1b0d977b7e086097ab8304">Versión 2013-01-19 16:57:46 +0100 0688b6e</a>
</div>
</div>
</body>
</html>
